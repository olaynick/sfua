
background.js:
--------------------------------------------------
// background.js

// –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–∏—Å–∫–∞ (–¥–ª—è –æ–±—ã—á–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞)
let searchParams = {
    eventType: 0,
    key: '%',
    value: '–æ–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ'
};

// –°–ª—É—à–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É –≤–∫–ª–∞–¥–∫–∏ AppMetrica
chrome.tabs.onUpdated.addListener(async (tabId, changeInfo, tab) => {
    if (changeInfo.status === 'complete' && tab.url?.includes('appmetrica.yandex.ru')) {
        console.log(`[Background] –°—Ç—Ä–∞–Ω–∏—Ü–∞ AppMetrica –∑–∞–≥—Ä—É–∂–µ–Ω–∞: ${tab.url}`);

        // === –û–ß–ò–°–¢–ö–ê –°–û–°–¢–û–Ø–ù–ò–Ø POPUP –ò –ü–û–ò–°–ö–ê –û–®–ò–ë–û–ö ===
        const popupStateKey = `sfua_popup_state_tab_${tabId}`;
        const errorSearchDoneKey = `sfua_error_search_done_tab_${tabId}`;
        const searchInProgressKey = `sfua_search_in_progress_tab_${tabId}`;

        chrome.storage.local.remove([popupStateKey, errorSearchDoneKey, searchInProgressKey], () => {
            if (chrome.runtime.lastError) {
                console.warn(`[Background] –û—à–∏–±–∫–∞ –æ—á–∏—Å—Ç–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è:`, chrome.runtime.lastError);
            } else {
                console.log(`[Background] –û—á–∏—â–µ–Ω–æ —Å–æ—Å—Ç–æ—è–Ω–∏–µ: ${popupStateKey}, ${errorSearchDoneKey}, ${searchInProgressKey}`);
            }
        });

        // –ò–Ω–∂–µ–∫—Ç–∏—Ä—É–µ–º –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã
        loadHelperScripts(tabId).catch(err => {
            console.warn(`[Background] –ù–µ —É–¥–∞–ª–æ—Å—å –∏–Ω–∂–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ö–µ–ª–ø–µ—Ä—ã —Å—Ä–∞–∑—É:`, err);
        });
    }
});

// –°–ª–µ–¥–∏–º –∑–∞ –∞–∫—Ç–∏–≤–∞—Ü–∏–µ–π –≤–∫–ª–∞–¥–æ–∫ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
chrome.tabs.onActivated.addListener(async (activeInfo) => {
    try {
        const tab = await chrome.tabs.get(activeInfo.tabId);
        if (tab.url?.includes('appmetrica.yandex.ru')) {
            await loadHelperScripts(activeInfo.tabId);
        }
    } catch (e) {
        console.warn('–ù–µ —É–¥–∞–ª–æ—Å—å –æ–±–Ω–æ–≤–∏—Ç—å –≤–∫–ª–∞–¥–∫—É –ø—Ä–∏ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏:', e);
    }
});

// –û—Å–Ω–æ–≤–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–æ–±—â–µ–Ω–∏–π
chrome.runtime.onMessage.addListener((request, sender, sendResponse) => {
    console.log("[Background] –ü–æ–ª—É—á–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ:", request);

    // === –û–±—Ä–∞–±–æ—Ç–∫–∞ updateId ‚Äî –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ profileId ===
    if (request.action === "updateId") {
        updateProfileId(sender.tab.id, request.newId);
        sendResponse({ success: true });
        return true;
    }

    // === –°–±—Ä–æ—Å —Ñ–ª–∞–≥–æ–≤ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (–¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞) ===
    if (request.action === "resetParamCheckFlags") {
        const targetTabId = request.tabId || sender.tab?.id;
        if (!targetTabId) {
            sendResponse({ success: false, error: "–ù–µ —É–∫–∞–∑–∞–Ω tabId" });
            return true;
        }

        try {
            chrome.scripting.executeScript({
                target: { tabId: targetTabId },
                func: () => {
                    const iframe = document.querySelector('iframe.iframe-integration__iframe');
                    if (!iframe || !iframe.contentDocument) {
                        console.warn('SFUA: iframe –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω –ø—Ä–∏ —Å–±—Ä–æ—Å–µ —Ñ–ª–∞–≥–æ–≤');
                        return;
                    }

                    const doc = iframe.contentDocument;
                    doc.querySelectorAll('.check_has_already_been_performed')
                        .forEach(el => el.classList.remove('check_has_already_been_performed'));

                    console.log('SFUA: –°–±—Ä–æ—à–µ–Ω—ã —Ñ–ª–∞–≥–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤–Ω—É—Ç—Ä–∏ iframe');
                }
            });

            console.log(`[Background] –û—Ç–ø—Ä–∞–≤–ª–µ–Ω —Å–±—Ä–æ—Å —Ñ–ª–∞–≥–æ–≤ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤ –≤–∫–ª–∞–¥–∫—É ${targetTabId}`);
            sendResponse({ success: true });
        } catch (err) {
            console.error(`[Background] –û—à–∏–±–∫–∞ —Å–±—Ä–æ—Å–∞ —Ñ–ª–∞–≥–æ–≤:`, err);
            sendResponse({ success: false, error: err.message });
        }
        return true;
    }

    // === –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –ø–æ–∏—Å–∫–∞ ‚Äî —Å–±—Ä–æ—Å —Ñ–ª–∞–≥–∞ ===
    if (request.action === "searchCompleted") {
        const tabId = sender.tab?.id;
        if (tabId) {
            const searchInProgressKey = `sfua_search_in_progress_tab_${tabId}`;
            chrome.storage.local.remove(searchInProgressKey, () => {
                if (chrome.runtime.lastError) {
                    console.warn(`[Background] –û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è —Ñ–ª–∞–≥–∞ –ø–æ–∏—Å–∫–∞:`, chrome.runtime.lastError);
                } else {
                    console.log(`[Background] –°–±—Ä–æ—à–µ–Ω —Ñ–ª–∞–≥ –ø–æ–∏—Å–∫–∞: ${searchInProgressKey}`);
                }
            });
        }
        return true;
    }

    // === –û–±—Ä–∞–±–æ—Ç–∫–∞ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞: –ø–æ–∫–∞–∑–∞—Ç—å ===
    if (request.action === "showErrorModal") {
        chrome.tabs.query({ active: true, currentWindow: true }, async (tabs) => {
            const tab = tabs[0];
            if (tab && tab.url.includes('appmetrica.yandex.ru')) {
                try {
                    await chrome.scripting.executeScript({
                        target: { tabId: tab.id },
                        func: (text, id) => {
                            window.sfuaErrorModal?.show?.(text, id);
                        },
                        args: [request.text, request.id]
                    });
                } catch (err) {
                    console.error("[Background] –û—à–∏–±–∫–∞ –ø–æ–∫–∞–∑–∞ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞:", err);
                }
            }
        });
        return true;
    }

    // === –û–±—Ä–∞–±–æ—Ç–∫–∞ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞: —Å–∫—Ä—ã—Ç—å ===
    if (request.action === "hideErrorModal") {
        chrome.tabs.query({ active: true, currentWindow: true }, async (tabs) => {
            const tab = tabs[0];
            if (tab && tab.url.includes('appmetrica.yandex.ru')) {
                try {
                    await chrome.scripting.executeScript({
                        target: { tabId: tab.id },
                        func: () => {
                            window.sfuaErrorModal?.hide?.();
                        }
                    });
                } catch (err) {
                    console.error("[Background] –û—à–∏–±–∫–∞ —Å–∫—Ä—ã—Ç–∏—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞:", err);
                }
            }
        });
        return true;
    }

    // === –ü–æ–∫–∞–∑–∞—Ç—å FAQ / –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ ===
    if (request.action === "showHowToUse") {
        chrome.tabs.query({
            active: true,
            currentWindow: true,
            url: '*://appmetrica.yandex.ru/*'
        }, async (tabs) => {
            const tab = tabs.find(t => t.url.includes('appmetrica.yandex.ru'));
            if (!tab) {
                console.warn('SFUA: AppMetrica –Ω–µ –æ—Ç–∫—Ä—ã—Ç–∞');
                return;
            }

            try {
                await chrome.scripting.executeScript({
                    target: { tabId: tab.id },
                    files: ['how_to_use.js']
                });
                console.log('‚úÖ how_to_use.js –∏–Ω–∂–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω –≤ —Å—Ç—Ä–∞–Ω–∏—Ü—É');
            } catch (err) {
                console.error('SFUA: –û—à–∏–±–∫–∞ –∏–Ω—ä–µ–∫—Ü–∏–∏ how_to_use.js:', err);
            }
        });
        sendResponse({ success: true });
        return true;
    }

    // –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–π –≤–∫–ª–∞–¥–∫–∏
    let targetTabId;

    if (request.tabId) {
        targetTabId = request.tabId;
    } else if (sender.tab?.id) {
        targetTabId = sender.tab.id;
    } else {
        chrome.tabs.query({ active: true, currentWindow: true }, async (tabs) => {
            const currentTab = tabs[0];
            if (!currentTab || !currentTab.url?.includes('appmetrica.yandex.ru')) {
                sendResponse({ success: false, error: "AppMetrica –Ω–µ –æ—Ç–∫—Ä—ã—Ç–∞" });
                return;
            }
            await handleAction(request, currentTab.id, sendResponse);
        });
        return true;
    }

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –≤–∫–ª–∞–¥–∫–∏
    chrome.tabs.get(targetTabId, async (tab) => {
        if (chrome.runtime.lastError || !tab || !tab.url.includes('appmetrica.yandex.ru')) {
            console.error(`[Background] –í–∫–ª–∞–¥–∫–∞ ${targetTabId} –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏–ª–∏ –Ω–µ AppMetrica`);
            sendResponse({ success: false, error: "–í–∫–ª–∞–¥–∫–∞ AppMetrica –∑–∞–∫—Ä—ã—Ç–∞ –∏–ª–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞" });
            return;
        }

        await handleAction(request, targetTabId, sendResponse);
    });

    return true;
});

// –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ iframe
async function waitForIframeReady(tabId) {
    for (let i = 0; i < 40; i++) {
        try {
            const result = await chrome.scripting.executeScript({
                target: { tabId: tabId },
                func: () => {
                    const iframe = document.querySelector('iframe.iframe-integration__iframe');
                    return !!iframe && !!iframe.contentDocument?.body;
                }
            });

            if (Array.isArray(result) && result[0]?.result) {
                console.log("[Background] iframe –≥–æ—Ç–æ–≤");
                return true;
            }
        } catch (e) {
            console.log("[Background] iframe –µ—â—ë –Ω–µ –≥–æ—Ç–æ–≤, –ø–æ–ø—ã—Ç–∫–∞:", i + 1, e.message || '');
        }
        await new Promise(resolve => setTimeout(resolve, 300));
    }
    console.warn("[Background] iframe –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª—Å—è –∑–∞ –æ—Ç–≤–µ–¥—ë–Ω–Ω–æ–µ –≤—Ä–µ–º—è");
    return false;
}

// –ó–∞–≥—Ä—É–∑–∫–∞ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤
async function loadHelperScripts(tabId) {
    const scripts = [
        'background/userinfo.js',
        'background/updateId.js'
    ];

    for (const file of scripts) {
        try {
            await chrome.scripting.executeScript({
                target: { tabId: tabId },
                files: [file]
            });
            console.log(`[Background] –ò–Ω–∂–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω: ${file}`);
        } catch (err) {
            console.error(`[Background] –û—à–∏–±–∫–∞ –∏–Ω—ä–µ–∫—Ü–∏–∏ ${file}:`, err);
        }
    }
}

// –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–µ–π—Å—Ç–≤–∏–π
async function handleAction(request, targetTabId, sendResponse) {
    try {
        if (request.action === "getSearchParams") {
            sendResponse(searchParams);
            return;
        }

        // === –ó–∞–ø—É—Å–∫ –æ–±—ã—á–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞ ===
        if (request.action === "startSearch") {
            searchParams = {
                eventType: request.eventType ?? 0,
                key: request.key ?? '%',
                value: request.value ?? '–æ–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ'
            };
            console.log("[Background] –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–∏—Å–∫–∞:", searchParams);

            const ready = await waitForIframeReady(targetTabId);
            if (!ready) {
                throw new Error("iframe –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª—Å—è");
            }

            await injectScript(targetTabId, 'progress.js');
            await injectScript(targetTabId, 'actions/showmoresession.js');
            sendResponse({ success: true });
        }

        // === –ó–∞–ø—É—Å–∫ –ø–æ–∏—Å–∫–∞ –æ—à–∏–±–æ–∫ (–Ω–∞—á–∞–ª–æ —Ü–µ–ø–æ—á–∫–∏) ===
        if (request.action === "executeStartErrorSearch") {
            console.log("[Background] –ó–∞–ø—É—Å–∫ –ø–æ—Ç–æ–∫–∞ –ø–æ–∏—Å–∫–∞ –æ—à–∏–±–æ–∫...");

            const ready = await waitForIframeReady(targetTabId);
            if (!ready) {
                throw new Error("iframe –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª—Å—è");
            }

            // ‚úÖ –°–Ω–∞—á–∞–ª–∞ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
            await injectScript(targetTabId, 'modal_error.js');

            // ‚úÖ –ü–æ—Ç–æ–º –ø—Ä–æ–≥—Ä–µ—Å—Å
            await injectScript(targetTabId, 'progress_error.js');
            await injectScript(targetTabId, 'actions/showmoresession_error.js');
            sendResponse({ success: true });
            return;
        }

        // === –û—Å—Ç–∞–ª—å–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã ===
        const scriptMap = {
            "executeLoadAllEvents": "actions/loadallevents.js",
            "executeClickPlusElement": "actions/clickpluselements.js",
            "executeClickEventElements": "actions/clickeventelements.js",
            "executeLoadAllEventsError": "actions/loadallevents_error.js",
            "executeFoundError": "actions/found_error.js"
        };

        if (scriptMap[request.action]) {
            const ready = await waitForIframeReady(targetTabId);
            if (!ready) {
                sendResponse({ success: false, error: "iframe –Ω–µ –≥–æ—Ç–æ–≤" });
                return;
            }

            await chrome.scripting.executeScript({
                target: { tabId: targetTabId },
                files: [scriptMap[request.action]]
            });
            sendResponse({ success: true });
        } else {
            console.warn("[Background] –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ:", request.action);
            sendResponse({ success: false, error: "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ" });
        }
    } catch (err) {
        console.error("[Background] –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –¥–µ–π—Å—Ç–≤–∏—è:", err);
        if (!sendResponse.sent) {
            sendResponse({ success: false, error: err.message });
        }
    }
}

// === –¶–µ–ø–æ—á–∫–∞ –æ–±—ã—á–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞ ===
async function startSearchFlow(tabId) {
    console.log("[Background] –ó–∞–ø—É—Å–∫ –ø–æ—Ç–æ–∫–∞ –æ–±—ã—á–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞...");

    const iframeReady = await waitForIframeReady(tabId);
    if (!iframeReady) {
        throw new Error("iframe –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª—Å—è");
    }

    await injectScript(tabId, 'progress.js');
    await injectScript(tabId, 'actions/showmoresession.js');
}

// === –¶–µ–ø–æ—á–∫–∞ –ø–æ–∏—Å–∫–∞ –æ—à–∏–±–æ–∫ ===
async function startErrorSearchFlow(tabId) {
    console.log("[Background] –ó–∞–ø—É—Å–∫ –ø–æ—Ç–æ–∫–∞ –ø–æ–∏—Å–∫–∞ –æ—à–∏–±–æ–∫...");

    const iframeReady = await waitForIframeReady(tabId);
    if (!iframeReady) {
        throw new Error("iframe –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª—Å—è");
    }

    await injectScript(tabId, 'modal_error.js');
    await injectScript(tabId, 'progress_error.js');
    await injectScript(tabId, 'actions/showmoresession_error.js');
}

// === –ò–Ω–∂–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–∞ ===
async function injectScript(tabId, file) {
    try {
        await chrome.scripting.executeScript({
            target: { tabId: tabId },
            files: [file]
        });
        console.log(`[Background] –ò–Ω–∂–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω: ${file}`);
    } catch (err) {
        console.error(`[Background] –û—à–∏–±–∫–∞ –∏–Ω—ä–µ–∫—Ü–∏–∏ ${file}:`, err);
        throw new Error(`–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å ${file}`);
    }
}

// === –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ ID ===
function updateProfileId(tabId, newId) {
    chrome.scripting.executeScript({
        target: { tabId: tabId },
        func: (id) => {
            const iframes = document.querySelectorAll('iframe.iframe-integration__iframe');
            iframes.forEach(iframe => {
                try {
                    const src = iframe.src;
                    const newSrc = src.replace(/profileId=\d+/, `profileId=${id}`)
                                    .replace(/deviceId=\d+/, `deviceId=${id}`);
                    iframe.src = newSrc;
                } catch (e) {
                    console.error('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è iframe:', e);
                }
            });
            setTimeout(() => location.reload(), 1000);
        },
        args: [newId]
    });
}


how_to_use.js:
--------------------------------------------------
// how_to_use.js ‚Äî –±–µ–∑ –∞–Ω–∏–º–∞—Ü–∏–∏ –≤—ã—Å–æ—Ç—ã, —Å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –≤—ã—Å–æ—Ç–æ–π

(function () {
    console.log("SFUA: how_to_use.js ‚Äî –∑–∞–ø—É—â–µ–Ω");

    if (document.querySelector('.sfua_howto_modal')) {
        console.log("SFUA: –ú–æ–¥–∞–ª–∫–∞ —É–∂–µ –æ—Ç–∫—Ä—ã—Ç–∞");
        return;
    }

    const cssUrl = chrome.runtime.getURL('how_to_use.css');
    const htmlUrl = chrome.runtime.getURL('how_to_use.html');

    fetch(cssUrl)
        .then(response => {
            if (!response.ok) throw new Error(`CSS: ${response.status} ${response.statusText}`);
            return response.text();
        })
        .then(css => {
            const style = document.createElement('style');
            style.textContent = css;
            document.head.appendChild(style);

            return fetch(htmlUrl);
        })
        .then(response => {
            if (!response.ok) throw new Error(`HTML: ${response.status} ${response.statusText}`);
            return response.text();
        })
        .then(html => {
            const template = document.createElement('div');
            template.innerHTML = html.trim();

            const modal = template.querySelector('.sfua_howto_modal');
            const body = modal.querySelector('.sfua_howto_body');
            const tabs = modal.querySelectorAll('.sfua_howto_tab');
            const panels = modal.querySelectorAll('.sfua_howto_panel');

            document.body.appendChild(modal);

            // === –õ–æ–≥–∏–∫–∞ –≤–∫–ª–∞–¥–æ–∫ ===
            function activateTab(tabId) {
                tabs.forEach(t => t.classList.remove('active'));
                panels.forEach(p => p.classList.remove('active'));

                const tab = modal.querySelector(`[data-tab="${tabId}"]`);
                const panel = modal.querySelector(`#${tabId}`);
                if (tab && panel) {
                    tab.classList.add('active');
                    panel.classList.add('active');
                }
            }

            tabs.forEach(tab => {
                tab.addEventListener('click', () => activateTab(tab.dataset.tab));
            });

            // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –ø–µ—Ä–≤—É—é –≤–∫–ª–∞–¥–∫—É
            activateTab('basics');

            // === –ö–Ω–æ–ø–∫–∏ –∑–∞–∫—Ä—ã—Ç–∏—è ===
            const closeBtn = modal.querySelector('.sfua_howto_close');
            const okBtn = modal.querySelector('.sfua_howto_ok');

            function closeModal() {
                modal.style.opacity = '0';
                setTimeout(() => modal.remove(), 300);
            }

            closeBtn?.addEventListener('click', closeModal);
            okBtn?.addEventListener('click', closeModal);
            modal.addEventListener('click', (e) => {
                if (e.target === modal) closeModal();
            });

            // === Escape ===
            function handleKeydown(e) {
                if (e.key === 'Escape') {
                    closeModal();
                    document.removeEventListener('keydown', handleKeydown);
                }
            }
            document.addEventListener('keydown', handleKeydown);

            // === –ü–æ–∫–∞–∑—ã–≤–∞–µ–º ===
            setTimeout(() => {
                modal.style.opacity = '1';
                modal.querySelector('.sfua_howto_content').style.transform = 'scale(1)';
            }, 10);
        })
        .catch(err => {
            console.error("SFUA: –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ä–µ—Å—É—Ä—Å–æ–≤:", err);
        });
})();


progress.js:
--------------------------------------------------
// progress.js

(function () {
    console.log("Progress UI: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è (–≤ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ)");

    // === –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã ===
    const existingErrorContainer = document.querySelector('.sfua_error_container');
    if (existingErrorContainer) {
        existingErrorContainer.style.transform = 'scale(0)';
        existingErrorContainer.style.opacity = '0';
        setTimeout(() => existingErrorContainer.remove(), 300);
    }

    const existingContainer = document.querySelector('.sfua_result_container');
    if (existingContainer) {
        existingContainer.style.transform = 'scale(0)';
        existingContainer.style.opacity = '0';
        setTimeout(() => existingContainer.remove(), 300);
    }

    // === –ó–∞–≥—Ä—É–∂–∞–µ–º —Å—Ç–∏–ª–∏ ===
    const style = document.createElement('link');
    style.rel = 'stylesheet';
    style.href = chrome.runtime.getURL('progress.css');
    document.head.appendChild(style);

    // === –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä ===
    const targetContainer = document.querySelector('.screen__header');
    if (!targetContainer) {
        console.warn("‚ö†Ô∏è .screen__header –Ω–µ –Ω–∞–π–¥–µ–Ω");
        return;
    }

    const container = document.createElement('div');
    container.className = 'sfua_result_container';
    container.style.cssText = `
        transform: scale(0);
        opacity: 0;
        transform-origin: top center;
        transition: transform 0.3s ease, opacity 0.3s ease;
    `;

    targetContainer.parentNode.insertBefore(container, targetContainer.nextSibling);

    // === –ö–Ω–æ–ø–∫–∞ "—Å–ª–µ–¥–∏—Ç—å" ‚Äî —Å—Ç—Ä–µ–ª–∫–∞ –≤–Ω–∏–∑ ===
    const followBtn = document.createElement('div');
    followBtn.style.cssText = `
        position: absolute;
        top: 8px;
        left: 8px;
        width: 26px;
        height: 26px;
        cursor: pointer;
        opacity: 0.7;
        transition: color 0.2s ease, opacity 0.2s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 10001;
    `;

    const arrowSvg = `
        <svg xmlns="http://www.w3.org/2000/svg" width="21" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <line x1="12" y1="5" x2="12" y2="19"></line>
            <polyline points="19 12 12 19 5 12"></polyline>
        </svg>
    `;
    followBtn.innerHTML = arrowSvg;

    let isFollowing = false;

    function updateFollowBtn(follow) {
        followBtn.style.color = follow ? '#4299e1' : '#a0aec0';
        followBtn.style.opacity = follow ? '1' : '0.7';
        isFollowing = follow;
        if (follow) {
            container.classList.add('following');
        } else {
            container.classList.remove('following');
        }
    }

    followBtn.addEventListener('click', async (e) => {
        e.stopPropagation();
        e.preventDefault();
        const newFollow = !isFollowing;
        console.log(`[Progress] Follow mode: ${newFollow}`);
        updateFollowBtn(newFollow);
        await chrome.storage.local.set({ sfua_followMode: newFollow });
    });

    container.appendChild(followBtn);

    // === –ö—Ä–µ—Å—Ç–∏–∫ ‚Äî —Å–ø—Ä–∞–≤–∞ ===
    const closeBtn = document.createElement('button');
    closeBtn.innerHTML = '&times;';
    closeBtn.style.cssText = `
        position: absolute;
        top: 6px;
        right: 8px;
        width: 26px;
        height: 26px;
        background: none;
        border: none;
        font-size: 26px;
        cursor: not-allowed;
        color: #718096;
        opacity: 0.4;
        z-index: 10001;
    `;
    closeBtn.setAttribute('title', '–ó–∞–∫—Ä—ã—Ç—å –º–æ–∂–Ω–æ —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø–æ–∏—Å–∫–∞');

    closeBtn.addEventListener('click', (e) => {
        if (closeBtn.style.cursor === 'not-allowed') {
            e.stopPropagation();
            e.preventDefault();
        }
    });

    container.appendChild(closeBtn);

    // === –í–µ—Ä—Ö–Ω—è—è —á–∞—Å—Ç—å: –∫—Ä—É–≥–∏, —Ç–µ–∫—Å—Ç ===
    const header = document.createElement('div');
    header.className = 'progress_header';

    const circlesContainer = document.createElement('div');
    circlesContainer.className = 'progress_circles';

    for (let i = 0; i < 4; i++) {
        const wrapper = document.createElement('div');
        wrapper.className = 'circle_wrapper';
        const circle = document.createElement('div');
        circle.className = 'progress_circle';
        wrapper.appendChild(circle);
        circlesContainer.appendChild(wrapper);
    }

    const operationText = document.createElement('span');
    operationText.className = 'current_operation';
    operationText.textContent = '–ó–∞–≥—Ä—É–∂–∞—é —Å–µ—Å—Å–∏–∏';

    header.appendChild(circlesContainer);
    header.appendChild(operationText);
    container.appendChild(header);

    // === –†–µ–∑—É–ª—å—Ç–∞—Ç—ã ===
    const resultsContainer = document.createElement('div');
    resultsContainer.className = 'results_container';
    container.appendChild(resultsContainer);

    // === –ü–ª–∞–≤–Ω–æ–µ –ø–æ—è–≤–ª–µ–Ω–∏–µ ===
    setTimeout(() => {
        container.style.transform = 'scale(1)';
        container.style.opacity = '1';
    }, 100);

    // === –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è followMode ===
    chrome.storage.local.get(['sfua_followMode'], (result) => {
        const follow = !!result.sfua_followMode;
        console.log(`[Progress] –ó–∞–≥—Ä—É–∂–µ–Ω–æ —Å–æ—Å—Ç–æ—è–Ω–∏–µ followMode: ${follow}`);
        updateFollowBtn(follow);
    });

    // === –õ–æ–≥–∏–∫–∞ –ø—Ä–æ–∫—Ä—É—Ç–∫–∏ ===
    function handleScroll() {
        const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
        if (isFollowing && scrollTop >= 150) {
            container.classList.add('pinned');
        } else {
            container.classList.remove('pinned');
        }
    }

    window.addEventListener('scroll', handleScroll);
    handleScroll();

    // === SVG –∏–∫–æ–Ω–∫–∞ –≥–ª–∞–∑–∞ (–≥–æ–ª—É–±–æ–π) ===
    const EYE_ICON = `
        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="#3182ce" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
            <circle cx="12" cy="12" r="3"></circle>
        </svg>
    `;

    // === –ì–ª–æ–±–∞–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å ===
    window.sfuaProgress = {
        container,
        circles: container.querySelectorAll('.progress_circle'),
        operationText,
        resultsContainer,

        setStep(step, text) {
            this.circles.forEach((c, i) => {
                c.style.width = '20px';
                c.style.height = '20px';
                c.style.backgroundColor = '#edf2f7';
            });
            for (let i = 0; i < step - 1; i++) {
                this.circles[i].style.backgroundColor = '#4299e1';
            }
            if (step >= 1 && step <= 4) {
                const c = this.circles[step - 1];
                c.style.width = '10px';
                c.style.height = '10px';
                c.style.backgroundColor = '#4299e1';
            }
            if (text) this.operationText.textContent = text;
        },

        startProgress(baseText, total) {
            this.operationText.textContent = baseText;
            const progressText = document.createElement('span');
            progressText.style.cssText = `
                display: inline;
                margin-left: 6px;
                opacity: 0;
                transition: opacity 0.3s ease;
            `;
            this.operationText.appendChild(progressText);

            setTimeout(() => {
                progressText.textContent = `1 –∏–∑ ${total}`;
                progressText.style.opacity = '1';
            }, 300);

            return (current) => {
                if (progressText.parentNode) {
                    progressText.textContent = `${current} –∏–∑ ${total}`;
                }
            };
        },

        updateProgress(updateFn) {
            if (typeof updateFn === 'function') {
                updateFn();
            }
        },

        addResult(result) {
            const link = document.createElement('div');
            link.className = 'sfua_result_item';
            link.style.cssText = `
                padding: 5px 10px;
                background-color: #edf2f7;
                border-radius: 6px;
                font-size: 11px;
                font-weight: 500;
                color: #4a5568;
                cursor: pointer;
                white-space: nowrap;
                opacity: 0;
                transform: translateY(4px);
                display: flex;
                align-items: center;
                gap: 6px;
                transition: all 0.2s ease;
                user-select: none;
            `;

            link.textContent = `${result.shortDateText} ${result.timeText}`;

            // === –ò–∫–æ–Ω–∫–∞ "–≥–ª–∞–∑" ‚Äî –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ —Å–∫—Ä—ã—Ç–∞ ===
            const eyeIcon = document.createElement('span');
            eyeIcon.className = 'eye-icon';
            eyeIcon.style.cssText = `
                display: inline-flex;
                align-items: center;
                opacity: 0;
                width: 0;
                height: 0;
                overflow: hidden;
                transition: width 0.2s ease, height 0.2s ease, opacity 0.2s ease;
            `;
            eyeIcon.setAttribute('title', '–ü—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–æ');
            eyeIcon.innerHTML = EYE_ICON;
            link.appendChild(eyeIcon);

            let isViewed = false;
            let clickTimer = null;

            link.addEventListener('click', (e) => {
                e.stopPropagation();

                // –î–≤–æ–π–Ω–æ–π –∫–ª–∏–∫ ‚Äî —Å–±—Ä–∞—Å—ã–≤–∞–µ–º
                if (e.detail === 2) {
                    if (clickTimer) {
                        clearTimeout(clickTimer);
                        clickTimer = null;
                    }

                    eyeIcon.style.width = '0';
                    eyeIcon.style.height = '0';
                    eyeIcon.style.opacity = '0';
                    isViewed = false;
                    return;
                }

                // –û–¥–∏–Ω–∞—Ä–Ω—ã–π –∫–ª–∏–∫
                if (clickTimer) {
                    clearTimeout(clickTimer);
                    clickTimer = null;
                    return;
                }

                clickTimer = setTimeout(() => {
                    if (!isViewed) {
                        eyeIcon.style.width = '14px';
                        eyeIcon.style.height = '14px';
                        eyeIcon.style.opacity = '0.7';
                        isViewed = true;
                    }

                    // –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ –∫ —Å–æ–±—ã—Ç–∏—é
                    const iframe = document.querySelector('iframe.iframe-integration__iframe');
                    if (!iframe) return;

                    let iframeDoc;
                    try {
                        iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
                    } catch (e) {
                        return;
                    }

                    if (!iframeDoc) return;

                    const target = iframeDoc.getElementById(result.id);
                    if (!target) return;

                    requestAnimationFrame(() => {
                        try {
                            target.scrollIntoView({
                                behavior: 'smooth',
                                block: 'center'
                            });
                        } catch (e) {}
                    });

                    clickTimer = null;
                }, 300);
            });

            this.resultsContainer.appendChild(link);

            setTimeout(() => {
                link.style.opacity = '1';
                link.style.transform = 'translateY(0)';
            }, 10);
        },

        searchComplete() {
            this.circles.forEach(c => {
                c.style.width = '10px';
                c.style.height = '10px';
                c.style.backgroundColor = '#4299e1';
            });

            const resultCount = this.resultsContainer.children.length;
            this.operationText.textContent = resultCount > 0
                ? `–ü–æ–∏—Å–∫ –∑–∞–≤–µ—Ä—à—ë–Ω. –ù–∞–π–¥–µ–Ω–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π: ${resultCount}`
                : "–ü–æ–∏—Å–∫ –∑–∞–≤–µ—Ä—à—ë–Ω. –ò—Å–∫–æ–º—ã–µ —Å–æ–±—ã—Ç–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω—ã";

            closeBtn.style.cursor = 'pointer';
            closeBtn.style.opacity = '0.7';
            closeBtn.removeAttribute('title');
            closeBtn.title = '–ó–∞–∫—Ä—ã—Ç—å';

            closeBtn.addEventListener('click', () => {
                console.log('[Progress] –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –∑–∞–∫—Ä—ã—Ç');
                container.style.transform = 'scale(0)';
                container.style.opacity = '0';
                setTimeout(() => container.remove(), 300);
            });

            try {
                chrome.runtime.sendMessage({ action: "searchCompleted" });
            } catch (e) {
                console.warn("SFUA: –ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å searchCompleted", e);
            }
        }
    };

    window.sfuaProgress.setStep(1, "–ó–∞–≥—Ä—É–∂–∞—é —Å–µ—Å—Å–∏–∏");

    console.log("Progress UI: –ì–æ—Ç–æ–≤ (–≤ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ)");
})();


progress_error.css:
--------------------------------------------------
/* progress_error.css */

/* === –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä === */
.sfua_error_container {
    width: 100%;
    background: white;
    border: 1px solid #e2e8f0;
    border-radius: 8px;
    box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
    overflow: hidden;
    z-index: 10000;
    font-family: 'Segoe UI', sans-serif;
    font-size: 12px;
    color: #4a5568;
    position: relative;
    margin: 10px auto 8px;
    box-sizing: border-box;
}

.sfua_error_container.pinned {
    position: fixed;
    top: -40px;
    left: 25%;
    transform: translateX(-50%);
    width: 1200px;
    margin: 0 !important;
    z-index: 10001;
    animation: slideDown 0.3s forwards;
}

@keyframes slideDown {
    from { top: -40px; }
    to { top: 10px; }
}

.sfua_error_container.pinned:not(.following) {
    position: static;
    margin: 10px auto 8px;
}

/* –ö—Ä—É–≥–∏ */
.sfua_error_container .circle_wrapper {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 20px;
    height: 20px;
}

.sfua_error_container .progress_circle {
    width: 20px;
    height: 20px;
    background-color: #edf2f7;
    border-radius: 50%;
    transition: all 0.2s ease;
}

/* –ó–∞–≥–æ–ª–æ–≤–æ–∫ */
.sfua_error_container .progress_header {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 8px 0;
    width: 100%;
}

.sfua_error_container .progress_circles {
    display: flex;
    gap: 10px;
    justify-content: center;
    margin-bottom: 6px;
    width: 100%;
    max-width: 180px;
}

.sfua_error_container .current_operation {
    text-align: center;
    font-weight: 500;
    font-size: 13px;
}

/* –†–µ–∑—É–ª—å—Ç–∞—Ç—ã */
.sfua_error_container .results_container {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
    padding: 0 12px 8px;
    max-height: 100px;
    overflow-y: auto;
    justify-content: center;
}

/* –ö–Ω–æ–ø–∫–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ */
.sfua_error_container .results_container .sfua_error_result_item {
    padding: 5px 10px;
    background-color: #f7fafc;
    border-radius: 6px;
    font-size: 11px;
    font-weight: 500;
    color: #4a5568;
    cursor: pointer;
    white-space: nowrap;
    opacity: 0;
    transform: translateY(4px);
    transition: 
        opacity 0.2s ease,
        transform 0.2s ease;
}

/* –ü–æ—è–≤–ª–µ–Ω–∏–µ */
.sfua_error_container .results_container .sfua_error_result_item {
    opacity: 0;
    transform: translateY(4px);
}

/* –û–±—ã—á–Ω—ã–π hover */
.sfua_error_container .results_container .sfua_error_result_item:hover {
    background-color: rgb(203, 212, 221) !important;
    transform: translateY(0);
    box-shadow: 0 1px 3px rgba(255, 68, 62, 0.15);
    transition: 
        background-color 0.2s ease,
        color 0.2s ease,
        transform 0.1s ease,
        box-shadow 0.2s ease,
        border 0.2s ease;
}

/* hover –¥–ª—è –∫—Ä—ç—à–µ–π */
.sfua_error_container .results_container .sfua_error_result_item[is-crash]:hover {
    background-color: #feb2b2 !important;
    color: #9b2c2c !important;
    font-weight: 600;
    box-shadow: 0 2px 4px rgba(255, 68, 62, 0.2);
    transform: translateY(-1px);
}

/* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ */
.sfua_error_tooltip {
    position: fixed;
    top: 400px;
    left: 50%;
    transform: translateX(-50%) scale(0);
    max-width: 700px;
    background: white;
    border: 1px solid #e2e8f0;
    border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    padding: 12px 16px;
    font-size: 13px;
    color: #4a5568;
    z-index: 20000;
    white-space: pre-wrap;
    word-break: break-word;
    line-height: 1.4;
    transform-origin: center;
    transition: transform 0.3s ease, opacity 0.3s ease;
    opacity: 0;
    display: flex;
    align-items: flex-start;
    gap: 12px;
}

.sfua_error_tooltip_text {
    flex: 1;
}

.sfua_error_tooltip_buttons {
    display: flex;
    flex-direction: column;
    gap: 8px;
    align-items: center;
}

.sfua_error_tooltip_btn {
    width: 40px;
    height: 40px;
    border-radius: 20%;
    background-color: rgb(237, 242, 247);
    color: rgb(74, 85, 104);
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: background-color 0.2s ease, transform 0.1s ease;
}

.sfua_error_tooltip_btn:hover {
    transform: scale(1.05);
}


modal_error.js:
--------------------------------------------------
// modal_error.js

(function () {
    console.log("üîß modal_error.js: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è");

    let modal = null;
    let currentId = null;
    let hasScrolledFromModal = false;

    function getContainerBottom() {
        const container = document.querySelector('.sfua_error_container');
        if (!container) return 400;
        const rect = container.getBoundingClientRect();
        return rect.bottom;
    }

    function updateModalPosition() {
        if (!modal) return;
        const left = window.innerWidth * 0.25;
        modal.style.top = `${getContainerBottom() + 30}px`;
        modal.style.left = `${left}px`;
    }

    function createModal() {
        if (modal) return;

        modal = document.createElement('div');
        modal.className = 'sfua_error_modal';
        modal.style.cssText = `
            position: fixed;
            top: 0;
            left: 25%;
            transform: scale(0);
            max-width: 700px;
            min-width: 200px;
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            padding: 16px;
            font-size: 14px;
            color: #4a5568;
            z-index: 2147483647;
            white-space: pre-wrap;
            word-break: break-word;
            line-height: 1.5;
            transform-origin: top;
            transition: 
                transform 0.3s ease,
                top 0.3s ease,
                left 0.3s ease,
                opacity 0.3s ease;
            opacity: 0;
            display: flex;
            align-items: flex-start;
            gap: 16px;
        `;

        const textEl = document.createElement('div');
        textEl.style.flex = '1';
        modal.appendChild(textEl);

        const buttonsContainer = document.createElement('div');
        buttonsContainer.style.cssText = `
            display: flex;
            flex-direction: column;
            gap: 10px;
            align-items: center;
        `;
        modal.appendChild(buttonsContainer);

        // === –ö–Ω–æ–ø–∫–∞ "–°–∫—Ä–æ–ª–ª –∫ –æ—à–∏–±–∫–µ" ===
        const scrollBtn = document.createElement('div');
        scrollBtn.style.cssText = `
            width: 40px;
            height: 40px;
            border-radius: 20%;
            background-color: rgb(237, 242, 247);
            color: rgb(74, 85, 104);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: background-color 0.2s ease;
        `;
        scrollBtn.innerHTML = `
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <line x1="12" y1="5" x2="12" y2="19"></line>
                <polyline points="19 12 12 19 5 12"></polyline>
            </svg>
        `;
        scrollBtn.addEventListener('click', () => {
            const iframe = document.querySelector('iframe.iframe-integration__iframe');
            if (!iframe) return;

            let iframeDoc;
            try {
                iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
            } catch (e) {
                return;
            }

            if (!iframeDoc) return;

            const target = iframeDoc.getElementById(currentId);
            if (!target) return;

            target.style.transition = 'background-color 0.3s ease';
            target.style.backgroundColor = '#fff4f4';
            setTimeout(() => {
                target.style.backgroundColor = '';
            }, 5000);

            requestAnimationFrame(() => {
                try {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'center'
                    });
                } catch (e) {}
            });

            hasScrolledFromModal = true;
            // –£–≤–µ–¥–æ–º–ª—è–µ–º progress, —á—Ç–æ –±—ã–ª —Å–∫—Ä–æ–ª–ª
            window.sfuaErrorProgress?.onScrollFromModal?.(currentId);
            hideModal();
        });
        buttonsContainer.appendChild(scrollBtn);

        // === –ö–Ω–æ–ø–∫–∞ "–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å" ===
        const copyBtn = document.createElement('div');
        copyBtn.style.cssText = `
            width: 40px;
            height: 40px;
            border-radius: 20%;
            background-color: rgb(237, 242, 247);
            color: rgb(74, 85, 104);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: background-color 0.2s ease;
        `;
        copyBtn.innerHTML = `
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
            </svg>
        `;
        copyBtn.addEventListener('click', async () => {
            const text = modal.querySelector('div').textContent;
            try {
                await navigator.clipboard.writeText(text);
                copyBtn.style.backgroundColor = '#48bb78';
                copyBtn.style.color = 'white';
                setTimeout(() => {
                    copyBtn.style.backgroundColor = 'rgb(237, 242, 247)';
                    copyBtn.style.color = 'rgb(74, 85, 104)';
                }, 1000);
            } catch (err) {
                console.error('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å', err);
            }
        });
        buttonsContainer.appendChild(copyBtn);

        document.body.appendChild(modal);
        updateModalPosition();
    }

    function showModal(text, id) {
        if (currentId === id) return;

        if (modal && currentId !== id) {
            // –ê–Ω–∏–º–∞—Ü–∏—è –≤—Å–ø—ã—à–∫–∏ –ø—Ä–∏ —Å–º–µ–Ω–µ —Ç–µ–∫—Å—Ç–∞
            const textEl = modal.querySelector('div');
            textEl.style.opacity = '0.3';
            setTimeout(() => {
                textEl.textContent = text;
                textEl.style.opacity = '1';
            }, 50);
            currentId = id;
            hasScrolledFromModal = false;
            updateModalPosition();
            return;
        }

        hideModal();
        currentId = id;
        hasScrolledFromModal = false;

        setTimeout(() => {
            createModal();
            const textEl = modal.querySelector('div');
            textEl.textContent = text;
            updateModalPosition();
            modal.style.opacity = '1';
            modal.style.transform = 'scale(1)';
        }, 10);
    }

    function hideModal() {
        currentId = null;
        hasScrolledFromModal = false;

        if (modal) {
            modal.style.transform = 'scale(0)';
            modal.style.opacity = '0';

            setTimeout(() => {
                if (modal) {
                    modal.remove();
                    modal = null;
                }
            }, 300);
        }
    }

    // === –°–ª—É—à–∞—Ç–µ–ª–∏ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ–∑–∏—Ü–∏–∏ ===
    function onScrollOrResize() {
        if (modal) {
            updateModalPosition();
        }
    }

    function setupListeners() {
        window.addEventListener('scroll', onScrollOrResize, { passive: true });
        window.addEventListener('resize', onScrollOrResize, { passive: true });

        const container = document.querySelector('.sfua_error_container');
        if (container) {
            const resizeObserver = new ResizeObserver(onScrollOrResize);
            resizeObserver.observe(container);
        }
    }

    // === –ö–ª–∏–∫ –≤–Ω–µ ‚Äî –∑–∞–∫—Ä—ã—Ç—å, –∫—Ä–æ–º–µ –∫–Ω–æ–ø–æ–∫ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ ===
    document.addEventListener('click', (e) => {
        if (!modal) return;

        const progressButton = e.target.closest('.sfua_error_result_item');
        if (progressButton) {
            // –ö–ª–∏–∫ –ø–æ –∫–Ω–æ–ø–∫–µ ‚Üí –æ–±–Ω–æ–≤–ª—è–µ–º, –Ω–µ –∑–∞–∫—Ä—ã–≤–∞–µ–º
            const fullText = progressButton.textContent.replace(/üëÅÔ∏è.*$/, '').trim();
            const eyeIcon = progressButton.querySelector('.eye-icon');
            const id = eyeIcon?.getAttribute('data-id');
            if (id) {
                showModal(fullText, id);
            }
            return;
        }

        if (!modal.contains(e.target)) {
            hideModal();
        }
    });

    // === –ù–∞–∂–∞—Ç–∏–µ Esc ‚Äî –∑–∞–∫—Ä—ã—Ç—å –º–æ–¥–∞–ª–∫—É ===
    document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') {
            hideModal();
        }
    });

    // === –ì–ª–æ–±–∞–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å ===
    window.sfuaErrorModal = {
        showModal,
        hideModal,
        onButtonEnter() {
            if (modal) {
                updateModalPosition();
            }
        },
        onButtonLeave() {
            // –Ω–µ –∑–∞–∫—Ä—ã–≤–∞–µ–º
        },
        hasScrolled() {
            return hasScrolledFromModal;
        }
    };

    setupListeners();
    console.log("‚úÖ modal_error.js: –ì–æ—Ç–æ–≤");
})();


path.py:
--------------------------------------------------
import os
import stat

def get_permissions(path):
    file_stat = os.stat(path)
    permissions = stat.filemode(file_stat.st_mode)
    return permissions

def print_directory_structure(root_dir, level=0, is_last=True):
    items = os.listdir(root_dir)
    items_count = len(items)

    for index, item in enumerate(items):
        item_path = os.path.join(root_dir, item)

        # –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –ø–∞–ø–∫—É node_modules
        if item == 'node_modules':
            continue
        
        # –û–ø—Ä–µ–¥–µ–ª—è–µ–º, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —Ç–µ–∫—É—â–∏–π —ç–ª–µ–º–µ–Ω—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–º –≤ —É—Ä–æ–≤–Ω–µ
        is_last_item = index == items_count - 1
        connector = '‚îî‚îÄ ' if is_last_item else '‚îú‚îÄ '

        permissions = get_permissions(item_path)
        print(' ' * (level * 4) + connector + f'{item} ({permissions})')

        if os.path.isdir(item_path):
            # –†–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π –≤—ã–∑–æ–≤ –¥–ª—è –ø–æ–¥–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π, –ø–µ—Ä–µ–¥–∞–µ–º is_last_item
            print_directory_structure(item_path, level + 1, is_last_item)


root_directory = '/home/olaynick/–†–∞–±–æ—á–∏–π —Å—Ç–æ–ª/sfua fe'
print_directory_structure(root_directory)


128.png:
--------------------------------------------------
PNG

   
IHDR         >a   	pHYs  .#  .#x?v  
iTXtXML:com.adobe.xmp     <?xpacket begin="Ôªø" id="W5M0MpCehiHzreSzNTczkc9d"?> <x:xmpmeta xmlns:x="adobe:ns:meta/" x:xmptk="Adobe XMP Core 6.0-c003 116.ddc7bc4, 2021/08/17-13:18:37        "> <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"> <rdf:Description rdf:about="" xmlns:xmp="http://ns.adobe.com/xap/1.0/" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xmpMM="http://ns.adobe.com/xap/1.0/mm/" xmlns:stEvt="http://ns.adobe.com/xap/1.0/sType/ResourceEvent#" xmlns:stRef="http://ns.adobe.com/xap/1.0/sType/ResourceRef#" xmlns:photoshop="http://ns.adobe.com/photoshop/1.0/" xmlns:tiff="http://ns.adobe.com/tiff/1.0/" xmlns:exif="http://ns.adobe.com/exif/1.0/" xmp:CreatorTool="Adobe Photoshop 21.2 (Windows)" xmp:CreateDate="2025-05-27T20:00:26+04:00" xmp:MetadataDate="2025-05-29T08:47:51+04:00" xmp:ModifyDate="2025-05-29T08:47:51+04:00" dc:format="image/png" xmpMM:InstanceID="xmp.iid:5197223e-f544-dc48-ab82-a8d81efe79f7" xmpMM:DocumentID="adobe:docid:photoshop:264f81c3-0cb1-594d-80c9-c677b4505719" xmpMM:OriginalDocumentID="xmp.did:a90bc5b9-7cea-af49-a9ed-f1346aff474b" photoshop:ColorMode="3" photoshop:ICCProfile="sRGB IEC61966-2.1" tiff:Orientation="1" tiff:XResolution="3000000/10000" tiff:YResolution="3000000/10000" tiff:ResolutionUnit="2" exif:ColorSpace="65535" exif:PixelXDimension="231" exif:PixelYDimension="231"> <xmpMM:History> <rdf:Seq> <rdf:li stEvt:action="created" stEvt:instanceID="xmp.iid:a90bc5b9-7cea-af49-a9ed-f1346aff474b" stEvt:when="2025-05-27T20:00:26+04:00" stEvt:softwareAgent="Adobe Photoshop 21.2 (Windows)"/> <rdf:li stEvt:action="saved" stEvt:instanceID="xmp.iid:ccc09a5f-f29a-3744-a216-64cd058a4f66" stEvt:when="2025-05-29T08:47:26+04:00" stEvt:softwareAgent="Adobe Photoshop 21.2 (Windows)" stEvt:changed="/"/> <rdf:li stEvt:action="saved" stEvt:instanceID="xmp.iid:5584399b-1f72-904e-9b2e-9cf512790cf2" stEvt:when="2025-05-29T08:47:51+04:00" stEvt:softwareAgent="Adobe Photoshop 21.2 (Windows)" stEvt:changed="/"/> <rdf:li stEvt:action="converted" stEvt:parameters="from application/vnd.adobe.photoshop to image/png"/> <rdf:li stEvt:action="derived" stEvt:parameters="converted from application/vnd.adobe.photoshop to image/png"/> <rdf:li stEvt:action="saved" stEvt:instanceID="xmp.iid:5197223e-f544-dc48-ab82-a8d81efe79f7" stEvt:when="2025-05-29T08:47:51+04:00" stEvt:softwareAgent="Adobe Photoshop 21.2 (Windows)" stEvt:changed="/"/> </rdf:Seq> </xmpMM:History> <xmpMM:DerivedFrom stRef:instanceID="xmp.iid:5584399b-1f72-904e-9b2e-9cf512790cf2" stRef:documentID="xmp.did:a90bc5b9-7cea-af49-a9ed-f1346aff474b" stRef:originalDocumentID="xmp.did:a90bc5b9-7cea-af49-a9ed-f1346aff474b"/> </rdf:Description> </rdf:RDF> </x:xmpmeta> <?xpacket end="r"?>„±ú  IDATxy\U?-$M:i4IH::tX(l	rDuaPT@1&^I;]NUv[’ùNIWwI}ŒπY_{}.%9u1 .n^'|w$O $108q”∑ |M8q
K#IWXz!Rxh!Xe.@6Bf–íP(»à^w3}
B.4
](;<)}œótCQR7+H2h,>iu#@#$}
OE
i&	-L«ê!+&Iha-&} GPDq
Q
-A"=|yÔôá J 4)UrNËºøcAŸ§AN1H	Rn4!
  rI4o0A*5I;I !H@])Z{Z2H#44y}\WgW2xF

_%$N '8&<D A 
!&/s<œªfB0L’óC	iaeZ p0–§#/U!CJ$W	''tvVR	‘π}B78Ly
2Ix	?CKj9v(KV‰ä¢#5<Uu2Z√∫F
t:xYuRb$h"e.w}tZG}?R.RWB(*xB«ëA)YmVŒïUx√ã)Fnt]POrBu\s≈£“ïv'[:lBWuuS_ <g¬ó`#j
V\c”≥m_md
P@"py	?]z!u<)p(p$z+H^^;FovDP»†`1p|-÷ø5a]54K]u+"
q^  &r5–ûA:ÿòR'/W
lL:Z\7$0U 0w65h'Won#SG:mXm∆æ’†Ew6"AHnrc"t[j*|>UR`1~J#Œë{.sZd/:zd1P)IT?^C*S#	i„ïê3AC-WÎöäGjh`Y»ΩQNNE3o$1pjc≈•AOO
t÷∫ﬁóa/!R ã›∏<aW&qJ3EJHJ”ØXL<Zn9h, AB,F44lC/F%rC»¢wIS/v67Qn+nd\/v&A6[	 )
EUGVv~6q@j—è‘ãC HJD^i]kNY«ë_3XiD?j	 mY8_$Nÿ∫L<Y!`1z|Hxh“õy
 w
C7|*}xYn+n-_7—ê :√è	‹èZn<D`_sbO$sO $Zf%PL$VT*.;?R#d}i'N åAÃ† 5hÀ°-1XtJ
8–æ'LtSNÃó<JhÂÉåqCGG;`0;WUfVË∫éytlT> ÄzCvww388H(,?B!bS?zCt_NLbY
@;^})uflH)	DQ€è%af+	@h`o31\q‰Øá&[i⁄äG01\A2[◊û()!X
WKf:x<N Ue2CJI8&Df>p+0~YÕ∂J	NgwDd ri8ﬁΩ{O|pÀ≥;0q}KZ N≈∂@=Dﬂø ⁄∑WnW~<V!- <hj#+ggkÎØø0K?::JGG?` Pi¬§ K= ZÙåååM(T!KM4{?78+T‘ÅTA <AFŒ°25qLs~;X^:	z9!—Ö t~+q^<1MD"1œÜWb+$c”ãxn5COO<H~e$3“≥	'BZ BL
~79hiiAJQ,)%Pa76~PvX!- #<U9^]]]nahy?`t_305,X]`e%okkcbb %gnﬂ±Bu}PaV<U/	‹êmZ[[,w7=$}O&"ÿ°2lCU0 $xËçç
\’ªK_lw`ﬁΩxW@:dŸØaxﬂïS A{fhH≈ÖVKRcx*^ M4vbX9 <p*i"6#"0vﬁã~qhmmEu($N„¥µ"Q>(@eT.rkNeiF29€¨yl vh
V-@eT``TjE%6~ -!kbb(/9h4Za ,l11d5Q{:0	9A{{;ÏöÇth+s/	}?+T@“Çad@5(,5Zo;z{{#r0hiiqrÎöë4 :7&8‘êq(&0u6tn8b1NVu}5@0\&\:::FD@
ÿ∑ou}∆∂ rJ ‹¨<NPJI  f6;7÷§|5 H67iaÃº/ﬂ§|`O4‘ò{u›ì. L<xu}$‘¨L7		X7x'0u;)P4Wgg'h2Btvv2>>^hSH<8*Quiii9)“Å6g:)m	]/ xjD#}yÊæïcH L."+R[s[?"nvHyb_%xjo?\OÊìùOSJ
 {`,O0])u/7%&
QR2~^\~y#brupqShd?{g(mSu5l
8",S4df!~<d
;*lÿ±s$j"oﬁò'0%2C[,Vt:F~t#7}6x 
hV/_5Ô°°[jtÿ∫ygb]L	!]◊º=UU,C ,JkHDOS8P@CN!bull(Jm=;CqÈÖí 5k?
Xj◊´u-AO3M 6{;f[7mcLSa1
|,Q„πºQlm1&6sf^:NoyK*6mW6Z1p*5wcM5v:]4Tww!bt|>mbJ&
j◊≥cÕÑ0
k$7–Ü/%s	0b`
d'xl&(  <|+^rDrLpR C@`V}4g@hGVW]%√§`0CG{x`4'Z@x0Q J@
wB@]cD"5pfO◊ñ  9Dn5MOn=[n
z'y)(P6!|f…≤?]+ Q_c6dE=|<…ë^Œõ9Y@ÿ∫i+4X7]ƒÆÒÉ•í;Q>XYcK:"~eÊÅ¶k8+Yx#lp∆≠;Ÿë?8 ~C3ŒºW,Dvs:P{#ﬂåJHx6d!$4}Zio11G-KI÷ñat?⁄êqI	wn
%'J~i”ô_,c#Hf[6
gk]+iP>=ME{EwY"Z◊ºdLx”£8^$
(%m'Bc[y9fu2	œºf_Oq	 Ÿ∂&Drzw4›ÉL$=—∞~RAp)';H ))~_q~4g?qDU.u.P…¶n?'~Y3'7z6 PuedP>\m6zT2^"
3n`u‚ãï€∞7^^"
zf#`|)w/Ri'R“Ü!Q(u}aweWw?jpi!4=_’êLB_@c[z&O4}^w"P>;!RXr
<\PFt*(ÕådLkRhK`{6M5_N?z;*Z%_L_pz2L  g‹Ω,LLwj]_-hJ&&=(ÕöL3E@3Cn7rZB94hDRY7Wfs	q_B%JH#+qgsU”ç`*Y>i`z«πR3  π>^^a~|≈†/ ;w√π'3Ne@,{/BrOVFÔ≠∫ﬁ•,u}G
\:g&uk*y'
aE‘ù5oŒücjZY	 Wv_g+gn`Z=RuÁµ®7WY8O/YŒøuE;gt<DP\ŒöœêŸî=QuB€æ|2S‹ÑY#/)ÂÅ£z‘Ω*~.FstS1‘Ω|8'eN`_8#Vf\<uJ!I]{\ [=[w:)_V7PW91cA?b{1
L?	5v>‘µnU S*p~ 0zFd--3B]Ÿ®k-"4E=wQ3u-QVTr tBkQs
/5sqkQr<@7◊ú/	\ gEUH(ÃíbL(!\dS/**Lr %U rÊõÅ@5ÀÅ,9z^	gR8aNe`%P";Ud0S_DPv ,9qe*t;    IENDB`


progress_error.js:
--------------------------------------------------
// progress_error.js

(function () {
    console.log("Progress Error: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è");

    // === –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã ===
    const existingResultContainer = document.querySelector('.sfua_result_container');
    if (existingResultContainer) {
        existingResultContainer.style.transform = 'scale(0)';
        existingResultContainer.style.opacity = '0';
        setTimeout(() => existingResultContainer.remove(), 300);
    }

    const existingContainer = document.querySelector('.sfua_error_container');
    if (existingContainer) {
        existingContainer.style.transform = 'scale(0)';
        existingContainer.style.opacity = '0';
        setTimeout(() => existingContainer.remove(), 300);
    }

    // === –ó–∞–≥—Ä—É–∂–∞–µ–º —Å—Ç–∏–ª–∏ ===
    const linkStyle = document.createElement('link');
    linkStyle.rel = 'stylesheet';
    linkStyle.href = chrome.runtime.getURL('progress_error.css');
    document.head.appendChild(linkStyle);

    const targetContainer = document.querySelector('.screen__header');
    if (!targetContainer) {
        console.warn("‚ö†Ô∏è .screen__header –Ω–µ –Ω–∞–π–¥–µ–Ω");
        return;
    }

    const container = document.createElement('div');
    container.className = 'sfua_error_container';
    container.style.cssText = `
        transform: scale(0);
        opacity: 0;
        transform-origin: top center;
        transition: transform 0.3s ease, opacity 0.3s ease;
    `;

    targetContainer.parentNode.insertBefore(container, targetContainer.nextSibling);

    // === –ö–Ω–æ–ø–∫–∞ "—Å–ª–µ–¥–∏—Ç—å" ‚Äî —Å—Ç—Ä–µ–ª–∫–∞ –≤–Ω–∏–∑ ===
    const followBtn = document.createElement('div');
    followBtn.style.cssText = `
        position: absolute;
        top: 8px;
        left: 8px;
        width: 26px;
        height: 26px;
        cursor: pointer;
        opacity: 0.7;
        transition: color 0.2s ease, opacity 0.2s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 10001;
    `;

    const arrowSvg = `
        <svg xmlns="http://www.w3.org/2000/svg" width="21" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <line x1="12" y1="5" x2="12" y2="19"></line>
            <polyline points="19 12 12 19 5 12"></polyline>
        </svg>
    `;
    followBtn.innerHTML = arrowSvg;

    let isFollowing = false;

    function updateFollowBtn(follow) {
        followBtn.style.color = follow ? '#AB4E52' : '#a0aec0';
        followBtn.style.opacity = follow ? '1' : '0.7';
        isFollowing = follow;
        if (follow) {
            container.classList.add('following');
        } else {
            container.classList.remove('following');
        }
    }

    followBtn.addEventListener('click', async (e) => {
        e.stopPropagation();
        e.preventDefault();
        const newFollow = !isFollowing;
        console.log(`[Progress Error] Follow mode: ${newFollow}`);
        updateFollowBtn(newFollow);
        await chrome.storage.local.set({ sfua_error_followMode: newFollow });
    });

    container.appendChild(followBtn);

    // === –ö—Ä–µ—Å—Ç–∏–∫ ‚Äî —Å–ø—Ä–∞–≤–∞ ===
    const closeBtn = document.createElement('button');
    closeBtn.innerHTML = '&times;';
    closeBtn.style.cssText = `
        position: absolute;
        top: 6px;
        right: 8px;
        width: 26px;
        height: 26px;
        background: none;
        border: none;
        font-size: 26px;
        cursor: not-allowed;
        color: #718096;
        opacity: 0.4;
        z-index: 10001;
    `;
    closeBtn.setAttribute('title', '–ó–∞–∫—Ä—ã—Ç—å –º–æ–∂–Ω–æ —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø–æ–∏—Å–∫–∞');

    closeBtn.addEventListener('click', (e) => {
        if (closeBtn.style.cursor === 'not-allowed') {
            e.stopPropagation();
            e.preventDefault();
        }
    });

    container.appendChild(closeBtn);

    // === –í–µ—Ä—Ö–Ω—è—è —á–∞—Å—Ç—å: –∫—Ä—É–≥–∏, —Ç–µ–∫—Å—Ç ===
    const header = document.createElement('div');
    header.className = 'progress_header';

    const circlesContainer = document.createElement('div');
    circlesContainer.className = 'progress_circles';

    for (let i = 0; i < 3; i++) {
        const wrapper = document.createElement('div');
        wrapper.className = 'circle_wrapper';
        const circle = document.createElement('div');
        circle.className = 'progress_circle';
        wrapper.appendChild(circle);
        circlesContainer.appendChild(wrapper);
    }

    const operationText = document.createElement('span');
    operationText.className = 'current_operation';
    operationText.textContent = '–ó–∞–≥—Ä—É–∂–∞—é —Å–µ—Å—Å–∏–∏';

    header.appendChild(circlesContainer);
    header.appendChild(operationText);
    container.appendChild(header);

    // === –†–µ–∑—É–ª—å—Ç–∞—Ç—ã ===
    const resultsContainer = document.createElement('div');
    resultsContainer.className = 'results_container';
    container.appendChild(resultsContainer);

    // === –ü–ª–∞–≤–Ω–æ–µ –ø–æ—è–≤–ª–µ–Ω–∏–µ ===
    setTimeout(() => {
        container.style.transform = 'scale(1)';
        container.style.opacity = '1';
    }, 100);

    // === –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è followMode ===
    chrome.storage.local.get(['sfua_error_followMode'], (result) => {
        const follow = !!result.sfua_error_followMode;
        console.log(`[Progress Error] –ó–∞–≥—Ä—É–∂–µ–Ω–æ —Å–æ—Å—Ç–æ—è–Ω–∏–µ followMode: ${follow}`);
        updateFollowBtn(follow);
    });

    // === –õ–æ–≥–∏–∫–∞ –ø—Ä–æ–∫—Ä—É—Ç–∫–∏ ===
    function handleScroll() {
        const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
        if (isFollowing && scrollTop >= 150) {
            container.classList.add('pinned');
        } else {
            container.classList.remove('pinned');
        }
    }

    window.addEventListener('scroll', handleScroll);
    handleScroll();

    // === –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ modal_error.js ===
    function injectScriptAgain() {
        return new Promise((resolve) => {
            const script = document.createElement('script');
            script.src = chrome.runtime.getURL('modal_error.js');
            script.onload = () => {
                console.log('‚úÖ modal_error.js –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–µ–Ω');
                resolve();
            };
            script.onerror = (err) => {
                console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ modal_error.js', err);
                resolve();
            };
            document.head.appendChild(script);
        });
    }

    // === SVG –∏–∫–æ–Ω–∫–∏ –≥–ª–∞–∑ ===
    const EYE_ICON_GRAY = `
        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
            <circle cx="12" cy="12" r="3"></circle>
        </svg>
    `;

    const EYE_ICON_BLUE = `
        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="#3182ce" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
            <circle cx="12" cy="12" r="3"></circle>
        </svg>
    `;

    const EYE_ICON_RED = `
        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="#AB4E52" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
            <circle cx="12" cy="12" r="3"></circle>
        </svg>
    `;

    // === –ì–ª–æ–±–∞–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å ===
    window.sfuaErrorProgress = {
        container,
        circles: container.querySelectorAll('.progress_circle'),
        text: operationText,
        resultsContainer,

        setStep(step, text) {
            this.circles.forEach((c, i) => {
                c.style.width = '20px';
                c.style.height = '20px';
                c.style.backgroundColor = '#edf2f7';
            });
            for (let i = 0; i < step - 1; i++) {
                this.circles[i].style.backgroundColor = '#AB4E52';
            }
            if (step >= 1 && step <= 3) {
                const c = this.circles[step - 1];
                c.style.width = '10px';
                c.style.height = '10px';
                c.style.backgroundColor = '#AB4E52';
            }
            if (text) this.text.textContent = text;
        },

        // –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –∏–∑ modal_error.js –ø—Ä–∏ —Å–∫—Ä–æ–ª–ª–µ
        onScrollFromModal(id) {
            const buttons = this.resultsContainer.querySelectorAll('.sfua_error_result_item');
            for (const btn of buttons) {
                const eyeIcon = btn.querySelector('.eye-icon');
                if (eyeIcon && eyeIcon.getAttribute('data-id') === id) {
                    eyeIcon.innerHTML = EYE_ICON_BLUE;
                    break;
                }
            }
        },

addResult(result) {
    const link = document.createElement('div');
    link.className = 'sfua_error_result_item';
    link.style.cssText = `
        padding: 5px 10px;
        background-color: #f7fafc;
        border-radius: 6px;
        font-size: 11px;
        font-weight: 500;
        color: #4a5568;
        cursor: pointer;
        white-space: nowrap;
        opacity: 0;
        transform: translateY(4px);
        display: flex;
        align-items: center;
        gap: 6px;
        transition: all 0.2s ease;
        user-select: none;
    `;

    link.textContent = result.shortText;

    if (result.isCrash) {
        link.style.color = '#AB4E52';
        link.style.fontWeight = '600';
        link.setAttribute('is-crash', 'true');
    }

    // === –ò–∫–æ–Ω–∫–∞ "–≥–ª–∞–∑" ===
    const eyeIcon = document.createElement('span');
    eyeIcon.className = 'eye-icon';
    eyeIcon.style.cssText = `
        display: inline-flex;
        align-items: center;
        opacity: 0;
        width: 0;
        height: 0;
        overflow: hidden;
        transition: width 0.2s ease, height 0.2s ease, opacity 0.2s ease;
    `;
    eyeIcon.setAttribute('title', '–ü—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–æ');
    eyeIcon.innerHTML = EYE_ICON_GRAY;
    eyeIcon.setAttribute('data-id', result.id);
    link.appendChild(eyeIcon);

    let clickTimer = null;
    let isViewed = false;

    link.addEventListener('click', (e) => {
        e.stopPropagation();

        // ‚ùå –ï—Å–ª–∏ —ç—Ç–æ –¥–≤–æ–π–Ω–æ–π –∫–ª–∏–∫ ‚Äî —Å–±—Ä–∞—Å—ã–≤–∞–µ–º –∏ –≤—ã—Ö–æ–¥–∏–º
        if (e.detail === 2) {
            if (clickTimer) {
                clearTimeout(clickTimer);
                clickTimer = null;
            }

            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ
            eyeIcon.style.width = '0';
            eyeIcon.style.height = '0';
            eyeIcon.style.opacity = '0';
            eyeIcon.innerHTML = '';
            isViewed = false;

            return; // –ù–µ –∑–∞–ø—É—Å–∫–∞–µ–º –æ–¥–∏–Ω–∞—Ä–Ω—ã–π –∫–ª–∏–∫
        }

        // ‚úÖ –û–¥–∏–Ω–∞—Ä–Ω—ã–π –∫–ª–∏–∫ ‚Äî –∑–∞–ø—É—Å–∫–∞–µ–º —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π
        if (!clickTimer) {
            clickTimer = setTimeout(() => {
                // –¢–æ–ª—å–∫–æ –µ—Å–ª–∏ –Ω–µ –±—ã–ª–æ –¥–≤–æ–π–Ω–æ–≥–æ –∫–ª–∏–∫–∞
                if (!isViewed) {
                    eyeIcon.style.width = '14px';
                    eyeIcon.style.height = '14px';
                    eyeIcon.style.opacity = '0.7';
                    isViewed = true;
                }

                if (result.isCrash) {
                    // –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ –∫ –∫—Ä—ç—à—É
                    const iframe = document.querySelector('iframe.iframe-integration__iframe');
                    if (!iframe) return;

                    let iframeDoc;
                    try {
                        iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
                    } catch (e) {
                        return;
                    }

                    if (!iframeDoc) return;

                    const target = iframeDoc.getElementById(result.id);
                    if (!target) return;

                    target.style.transition = 'background-color 0.3s ease';
                    target.style.backgroundColor = '#fff4f4';
                    setTimeout(() => {
                        target.style.backgroundColor = '';
                    }, 5000);

                    requestAnimationFrame(() => {
                        try {
                            target.scrollIntoView({
                                behavior: 'smooth',
                                block: 'center'
                            });
                        } catch (e) {}
                    });

                    eyeIcon.innerHTML = EYE_ICON_RED;
                } else {
                    // –û—Ç–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª–∫—É
                    window.sfuaErrorModal.showModal(result.fullText, result.id);
                    eyeIcon.innerHTML = EYE_ICON_GRAY;
                }

                clickTimer = null;
            }, 300);
        }
    });

    this.resultsContainer.appendChild(link);

    setTimeout(() => {
        link.style.opacity = '1';
        link.style.transform = 'translateY(0)';
    }, 10);
},

        searchComplete(total = 0, crashCount = 0) {
            this.circles.forEach(c => {
                c.style.width = '10px';
                c.style.height = '10px';
                c.style.backgroundColor = '#AB4E52';
            });

            const results = this.resultsContainer.children.length;
            if (results === 0) {
                this.text.textContent = "–ü–æ–∏—Å–∫ –∑–∞–≤–µ—Ä—à—ë–Ω. –û—à–∏–±–æ–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ";
            } else {
                this.text.textContent = '';
                this.text.appendChild(document.createTextNode(`–ü–æ–∏—Å–∫ –∑–∞–≤–µ—Ä—à—ë–Ω. –ù–∞–π–¥–µ–Ω–æ –æ—à–∏–±–æ–∫: ${results}`));

                if (crashCount > 0) {
                    this.text.appendChild(document.createTextNode(' –∏–∑ –Ω–∏—Ö '));

                    const crashSpan = document.createElement('span');
                    crashSpan.textContent = crashCount;
                    crashSpan.style.color = '#AB4E52';
                    crashSpan.style.fontWeight = '600';

                    this.text.appendChild(crashSpan);
                    this.text.appendChild(document.createTextNode(' Crash'));
                }
            }

            // === –†–∞–∑–±–ª–æ–∫–∏—Ä—É–µ–º –∫—Ä–µ—Å—Ç–∏–∫ ===
            closeBtn.style.cursor = 'pointer';
            closeBtn.style.opacity = '0.7';
            closeBtn.removeAttribute('title');
            closeBtn.title = '–ó–∞–∫—Ä—ã—Ç—å';

            closeBtn.onclick = null;
            closeBtn.addEventListener('click', () => {
                console.log('[Progress Error] –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –∑–∞–∫—Ä—ã—Ç');
                container.style.transform = 'scale(0)';
                container.style.opacity = '0';
                setTimeout(() => container.remove(), 300);
            });

            try {
                chrome.runtime.sendMessage({ action: "searchCompleted" });
            } catch (e) {
                console.warn("SFUA: –ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å searchCompleted", e);
            }
        }
    };

    window.sfuaErrorProgress.setStep(1, "–ó–∞–≥—Ä—É–∂–∞—é —Å–µ—Å—Å–∏–∏");

    // –ò–Ω–∂–µ–∫—Ç–∏—Ä—É–µ–º modal_error.js –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
    injectScriptAgain().catch(err => console.error('–û—à–∏–±–∫–∞ –ø–µ—Ä–≤–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ modal_error.js', err));
})();


styles.css:
--------------------------------------------------
/* ===== –ë–∞–∑–æ–≤—ã–µ —Å—Ç–∏–ª–∏ ===== */
body {
    width: 360px;
    min-width: 340px;
    max-width: 340px;
    padding: 15px;
    margin: 0;
    font-family: 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
    font-size: 13px;
    color: #2d3748;
    background-color: #f7fafc;
    box-sizing: border-box;
  }
  
  * {
    box-sizing: border-box;
  }
  
  /* ===== –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä ===== */
  .sfua_container {
    display: flex;
    flex-direction: column;
    gap: 12px;
    width: 100%;
  }
  
  /* ===== –°–µ–∫—Ü–∏–∏ ===== */
  .section {
    background: white;
    border-radius: 8px;
    padding: 12px 14px;
    box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
    border: 1px solid #e2e8f0;
  }
  
  .section h3 {
    margin: 0 0 8px 0;
    font-size: 13px;
    font-weight: 600;
    color: #4a5568;
  }
  
  
  /* ===== –¢–∏–ø—ã —Å–æ–±—ã—Ç–∏–π ===== */
  .event_types {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
    margin-top: 6px;
  }
  
  .event_type {
    padding: 5px 10px;
    background-color: #edf2f7;
    border-radius: 6px;
    font-size: 11px;
    font-weight: 500;
    color: #4a5568;
    cursor: pointer;
    transition: all 0.15s ease;
    user-select: none;
    white-space: nowrap;
  }
  
  .event_type:hover {
    background-color: #e2e8f0;
  }
  
  .event_type.active {
    background-color: #4299e1;
    color: white;
  }
  
  /* ===== –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–∏—Å–∫–∞ ===== */
  .params_row {
    display: flex;
    align-items: center;
    gap: 8px;
    width: 100%;
  }
  
  .param_key, .param_value {
    flex: 1;
    padding: 7px 10px;
    border: 1px solid #e2e8f0;
    border-radius: 6px;
    font-size: 12px;
    color: #2d3748;
    transition: all 0.2s ease;
    width: 50px;
  }
  
  .param_key:focus, .param_value:focus {
    outline: none;
    border-color: #4299e1;
    box-shadow: 0 0 0 3px rgba(66, 153, 225, 0.2);
  }
  
  .equals {
    color: #718096;
    font-size: 14px;
    font-weight: 500;
    user-select: none;
  }
  
  /* ===== –ö–Ω–æ–ø–∫–∞ –ø–æ–∏—Å–∫–∞ ===== */
  .search_button {
    width: 100%;
    padding: 10px;
    background-color: #4299e1;
    color: white;
    border: none;
    border-radius: 6px;
    font-size: 14px;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.2s ease;
    margin-top: 4px;
    text-align: center;
  }
  
  .search_button:hover {
    background-color: #3182ce;
  }
  
  .search_button:active {
    background-color: #2b6cb0;
  }
  
  .search_button:focus {
    outline: none;
    box-shadow: 0 0 0 3px rgba(66, 153, 225, 0.3);
  }
  
  /* ===== –í–∏–∑—É–∞–ª—å–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å ===== */
  .success_border {
    border-color: #48bb78 !important;
    box-shadow: 0 0 0 3px rgba(72, 187, 120, 0.2) !important;
  }
  
  .error_border {
    border-color: #f56565 !important;
    box-shadow: 0 0 0 3px rgba(245, 101, 101, 0.2) !important;
  }
  
  /* ===== –ê–Ω–∏–º–∞—Ü–∏–∏ ===== */
  @keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
  }
  
  .sfua_container {
    animation: fadeIn 0.2s ease-out;
  }
  
  /* ===== –ö–∞—Å—Ç–æ–º–Ω—ã–µ —Å–∫—Ä–æ–ª–ª–±–∞—Ä—ã ===== */
  ::-webkit-scrollbar {
    width: 6px;
    height: 6px;
  }
  
  ::-webkit-scrollbar-track {
    background: #f1f1f1;
    border-radius: 3px;
  }
  
  ::-webkit-scrollbar-thumb {
    background: #cbd5e0;
    border-radius: 3px;
  }
  
  ::-webkit-scrollbar-thumb:hover {
    background: #a0aec0;
  }
  
  /* ===== –ê–¥–∞–ø—Ç–∞—Ü–∏—è –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ä–∞–∑–º–µ—Ä–æ–≤ ===== */
  @media (max-width: 400px) {
    body {
      width: 320px;
      padding: 12px;
    }
    
    .section {
      padding: 10px 12px;
    }
    
    .event_type {
      padding: 4px 8px;
      font-size: 10px;
    }
  }
  
  /* ===== –°–∫—Ä—ã—Ç–∏–µ —Å—Ç—Ä–µ–ª–æ–∫ —É —á–∏—Å–ª–æ–≤–æ–≥–æ –≤–≤–æ–¥–∞ ===== */
  input[type="number"]::-webkit-outer-spin-button,
  input[type="number"]::-webkit-inner-spin-button {
    -webkit-appearance: none;
    margin: 0;
  }
  
/* ===== –ö–Ω–æ–ø–∫–∏: —Å—Ç—Ä–æ–∫–∞ –∏ —Ä–∞–∑–º–µ—Ä—ã ===== */
.buttons_row {
  display: flex;
  gap: 10px;
  width: 100%;
  margin-top: 4px;
}

/* ===== –û–±—â–∏–µ —Å—Ç–∏–ª–∏ –∫–Ω–æ–ø–æ–∫ ===== */
.buttons_row button {
  height: 40px;
  border: none;
  border-radius: 6px;
  font-size: 14px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s ease;
  display: flex;
  align-items: center;
  justify-content: center;
  text-align: center;
  box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
  padding: 0;
  margin: 0;
  line-height: 1;
}

/* ===== –ö–Ω–æ–ø–∫–∞ "–ù–∞—á–∞—Ç—å –ø–æ–∏—Å–∫" ‚Äî 70% ===== */
.search_button {
  width: 70%;
  background-color: #4299e1;
  color: white;
}

.search_button:hover {
  background-color: #3182ce;
}

.search_button:active {
  background-color: #2b6cb0;
}

.search_button:focus {
  outline: none;
  box-shadow: 0 0 0 3px rgba(66, 153, 225, 0.3);
}

/* ===== –ö–Ω–æ–ø–∫–∞ "–û—à–∏–±–∫–∞" ‚Äî 30% ===== */
.error_search_button {
  width: 30%;
  background-color: #AB4E52;
  color: white;
  gap: 6px;
  padding: 0 8px;
  box-sizing: border-box;
}

.error_search_button .error_icon {
  display: inline-block;
  width: 16px;
  height: 16px;
  background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='white' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Ccircle cx='12' cy='12' r='10'%3E%3C/circle%3E%3Cline x1='12' y1='8' x2='12' y2='12'%3E%3C/line%3E%3Cline x1='12' y1='16' x2='12.01' y2='16'%3E%3C/line%3E%3C/svg%3E") no-repeat center;
  background-size: 16px;
  flex-shrink: 0;
}

.error_search_button .error_text {
  font-size: 12px;
  font-weight: 500;
  line-height: 1;
}

.error_search_button:hover {
  background-color: #9a3d41;
}

.error_search_button:active {
  background-color: #8a3438;
}

.error_search_button:focus {
  outline: none;
  box-shadow: 0 0 0 3px rgba(171, 78, 82, 0.3);
}

/* ===== –°—Ç–∏–ª–∏ –¥–ª—è disabled-—Å–æ—Å—Ç–æ—è–Ω–∏—è ===== */
.search_button:disabled {
  opacity: 0.7;
  cursor: not-allowed;
  background-color: #718096;
}

/* ===== –ö–Ω–æ–ø–∫–∞ FAQ ===== */
.faq_row {
  margin-top: 8px;
}

.faq_button {
  width: 100%;
  padding: 10px;
  background-color: #f7fafc;
  color: #4a5568;
  border: 1px solid #e2e8f0;
  border-radius: 6px;
  font-size: 13px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s ease;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
}

.faq_button:hover {
  background-color: #edf2f7;
  border-color: #cbd5e0;
}

.faq_button:active {
  background-color: #e2e8f0;
}

.faq_button:focus {
  outline: none;
  box-shadow: 0 0 0 3px rgba(136, 187, 215, 0.2);
}


how_to_use.html:
--------------------------------------------------
<!-- how_to_use.html -->
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ SFUA</title>
    <link rel="stylesheet" href="how_to_use.css" />
</head>
<body>
    <div class="sfua_howto_modal">
        <div class="sfua_howto_content">
            <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
            <div class="sfua_howto_header">
                <span>–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ SFUA</span>
                <button class="sfua_howto_close">&times;</button>
            </div>

            <!-- –í–∫–ª–∞–¥–∫–∏ -->
            <div class="sfua_howto_tabs">
                <button data-tab="basics" class="sfua_howto_tab active">–û—Å–Ω–æ–≤—ã</button>
                <button data-tab="search" class="sfua_howto_tab">–ü–æ–∏—Å–∫ —Å–æ–±—ã—Ç–∏–π</button>
                <button data-tab="errors" class="sfua_howto_tab">–ü–æ–∏—Å–∫ –æ—à–∏–±–æ–∫</button>
                <button data-tab="progress" class="sfua_howto_tab">–ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä—ã</button>
                <button data-tab="showcurrent" class="sfua_howto_tab">–†–∞–∑–≤–µ—Ä–Ω—É—Ç—å —Å–æ–±—ã—Ç–∏—è</button>
                <button data-tab="update" class="sfua_howto_tab">–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ ID</button>
                <button data-tab="timezone" class="sfua_howto_tab">–í—Ä–µ–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</button>
            </div>

            <!-- –ö–æ–Ω—Ç–µ–Ω—Ç -->
            <div class="sfua_howto_body">
                <!-- –û—Å–Ω–æ–≤—ã -->
                <div id="basics" class="sfua_howto_panel active">
                    <h3>–ß—Ç–æ —Ç–∞–∫–æ–µ SFUA?</h3>
                    <p>SFUA (Search For Users Actions) ‚Äî —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Å–µ—Å—Å–∏–π –≤ –Ø–Ω–¥–µ–∫—Å AppMetrica.</p>
                    <p>–û–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä—É–µ—Ç —Ä—É—Ç–∏–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏:</p>
                    <ul>
                        <li>–ü–æ–∏—Å–∫ —Å–æ–±—ã—Ç–∏–π –ø–æ –∫–ª—é—á—É –∏ –∑–Ω–∞—á–µ–Ω–∏—é</li>
                        <li>–ü–æ–∏—Å–∫ –æ—à–∏–±–æ–∫ –∏ –∫—Ä—ç—à–µ–π (–∫—Ä–∞—Å–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π)</li>
                        <li>–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å–∫—Ä—ã—Ç–∏–µ —Å–æ–±—ã—Ç–∏–π –≤ —Ä–∞–º–∫–∞—Ö –æ–¥–Ω–æ–π —Å–µ—Å—Å–∏–∏</li>
                    </ul>
                </div>

                <!-- –ü–æ–∏—Å–∫ —Å–æ–±—ã—Ç–∏–π -->
                <div id="search" class="sfua_howto_panel">
                    <h3>–ü–æ–∏—Å–∫ —Å–æ–±—ã—Ç–∏–π</h3>
                    <p>–ù–∞—Ö–æ–¥–∏—Ç —Å–æ–±—ã—Ç–∏—è, —Å–æ–¥–µ—Ä–∂–∞—â–∏–µ —É–∫–∞–∑–∞–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã.</p>

                    <h4>–ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:</h4>
                    <ol>
                        <li>–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø —Å–æ–±—ã—Ç–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, <code>tap</code>)</li>
                        <li>–í–≤–µ–¥–∏—Ç–µ –∫–ª—é—á –∏/–∏–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, <code>–ª–æ–∫–∞–ª—å–Ω–∞—è –æ—Ç—Ä–∞–±–æ—Ç–∫–∞ –±–∏–æ–º–µ—Ç—Ä–∏–∏ = —É—Å–ø–µ—Ö</code>)</li>
                        <li>–ù–∞–∂–º–∏—Ç–µ <strong>¬´–ù–∞—á–∞—Ç—å –ø–æ–∏—Å–∫¬ª</strong></li>
                    </ol>

                    <h4>–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:</h4>
                    <ul>
                        <li>–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–∞—Å–∫–∏ <code>%</code>: <code>%–±–∏–æ–º–µ—Ç—Ä–∏—è%</code> –Ω–∞–π–¥—ë—Ç –≤—Å–µ –≤—Ö–æ–∂–¥–µ–Ω–∏—è</li>
                        <li>–ú–æ–∂–Ω–æ –∏—Å–∫–∞—Ç—å —Ç–æ–ª—å–∫–æ –ø–æ –∫–ª—é—á—É –∏–ª–∏ —Ç–æ–ª—å–∫–æ –ø–æ –∑–Ω–∞—á–µ–Ω–∏—é</li>
                        <li>–ì–æ—Ä—è—á–∞—è –∫–ª–∞–≤–∏—à–∞ –Ω–∞—á–∞–ª–∞ –ø–æ–∏—Å–∫–∞: <code>Ctrl+Enter</code></li>
                    </ul>

                    <h4>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞:</h4>
                    <ul>
                        <li>–ö–∞–∂–¥–∞—è –Ω–∞–π–¥–µ–Ω–Ω–∞—è —Å–µ—Å—Å–∏—è –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ –≤–∏–¥–µ –∫–Ω–æ–ø–∫–∏</li>
                        <li>–ü—Ä–∏ <strong>–∫–ª–∏–∫–µ</strong> –Ω–∞ –∫–Ω–æ–ø–∫—É ‚Äî –ø–æ—è–≤–ª—è–µ—Ç—Å—è <strong>–≥–æ–ª—É–±–æ–π –≥–ª–∞–∑</strong> –∏ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–æ–∫—Ä—É—Ç–∫–∞ –∫ —Å–æ–±—ã—Ç–∏—é</li>
                        <li>–ü—Ä–∏ <strong>–¥–≤–æ–π–Ω–æ–º –∫–ª–∏–∫–µ</strong> ‚Äî –æ—Ç–º–µ—Ç–∫–∞ "–ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–æ" —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è, –≥–ª–∞–∑ –∏—Å—á–µ–∑–∞–µ—Ç</li>
                    </ul>
                </div>

                <!-- –ü–æ–∏—Å–∫ –æ—à–∏–±–æ–∫ -->
                <div id="errors" class="sfua_howto_panel">
                    <h3>–ü–æ–∏—Å–∫ –æ—à–∏–±–æ–∫</h3>
                    <p>–ù–∞—Ö–æ–¥–∏—Ç –≤—Å–µ –∫—Ä–∞—Å–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è (–æ—à–∏–±–∫–∏ –∏ –∫—Ä—ç—à–∏) –≤ —Å–µ—Å—Å–∏—è—Ö –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–º –∏–Ω—Ç–µ—Ä–≤–∞–ª–µ –¥–∞—Ç.</p>

                    <h4>–ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:</h4>
                    <ol>
                        <li>–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É <strong>¬´–û—à–∏–±–∫–∏¬ª</strong></li>
                        <li>–î–æ–∂–¥–∏—Ç–µ—Å—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø–æ–∏—Å–∫–∞</li>
                        <li>–ö–ª–∏–∫–Ω–∏—Ç–µ –ø–æ –∫–Ω–æ–ø–∫–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ ‚Äî –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –º–æ–¥–∞–ª–∫–∞ —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –æ—à–∏–±–∫–∏</li>
                    </ol>

                    <h4>–ü–æ–≤–µ–¥–µ–Ω–∏–µ –∫–Ω–æ–ø–æ–∫:</h4>
                    <ul>
                        <li><strong>–û–±—ã—á–Ω–∞—è –æ—à–∏–±–∫–∞</strong>: –∫–ª–∏–∫ ‚Äî –æ—Ç–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª–∫–∏</li>
                        <li><strong>–ö—Ä—ç—à</strong>: –∫–ª–∏–∫ ‚Äî –ø—Ä–æ–∫—Ä—É—Ç–∫–∞ –∫ —Å–æ–±—ã—Ç–∏—é</li>
                        <li>–ü—Ä–∏ –∫–ª–∏–∫–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è <strong>–∏–∫–æ–Ω–∫–∞ –≥–ª–∞–∑–∞</strong></li>
                        <li>–ü—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ –Ω–∞ –≥–ª–∞–∑ ‚Äî –ø–æ–¥—Å–∫–∞–∑–∫–∞ <em>¬´–ü—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–æ¬ª</em></li>
                        <li>–ü—Ä–∏ –¥–≤–æ–π–Ω–æ–º –∫–ª–∏–∫–µ ‚Äî –æ—Ç–º–µ—Ç–∫–∞ —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è</li>
                        <li>–¢–µ–∫—Å—Ç –≤–Ω—É—Ç—Ä–∏ –∫–Ω–æ–ø–∫–∏ –Ω–µ–ª—å–∑—è –≤—ã–¥–µ–ª–∏—Ç—å</li>
                    </ul>

                    <h4>–§—É–Ω–∫—Ü–∏–∏ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞:</h4>
                    <ul>
                        <li><strong>–°–∫—Ä–æ–ª–ª –∫ —Å–æ–±—ã—Ç–∏—é</strong> ‚Äî –∫–ª–∏–∫ –ø–æ —Å—Ç—Ä–µ–ª–∫–µ –≤–Ω–∏–∑</li>
                        <li><strong>–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç</strong> ‚Äî –∫–ª–∏–∫ –ø–æ –∏–∫–æ–Ω–∫–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è</li>
                        <li>–ú–æ–¥–∞–ª–∫–∞ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è:
                            <ul>
                                <li>–ü—Ä–∏ –∫–ª–∏–∫–µ <strong>–≤–Ω–µ –æ–∫–Ω–∞</strong></li>
                                <li>–ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ <strong>Esc</strong></li>
                            </ul>
                        </li>
                        <li>–ü—Ä–∏ –∫–ª–∏–∫–µ –ø–æ –¥—Ä—É–≥–æ–π –∫–Ω–æ–ø–∫–µ ‚Äî —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –º–æ–¥–∞–ª–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –±–µ–∑ –∑–∞–∫—Ä—ã—Ç–∏—è</li>
                        <li>–ü—Ä–∏ –ø—Ä–æ–∫—Ä—É—Ç–∫–µ –∏–∑ –º–æ–¥–∞–ª–∫–∏ ‚Äî –≥–ª–∞–∑ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è <strong>–≥–æ–ª—É–±—ã–º</strong></li>
                    </ul>

                    <h4>–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:</h4>
                    <ul>
                        <li><strong>–ö—Ä—ç—à–∏</strong> –≤—ã–¥–µ–ª–µ–Ω—ã –∂–∏—Ä–Ω—ã–º –∫—Ä–∞—Å–Ω—ã–º —Ü–≤–µ—Ç–æ–º</li>
                        <li>–ò–∫–æ–Ω–∫–∞ –≥–ª–∞–∑–∞ –ø–æ—è–≤–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –∫–ª–∏–∫–∞</li>
                    </ul>
                </div>

                <!-- –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä—ã -->
                <div id="progress" class="sfua_howto_panel">
                    <h3>–ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä—ã</h3>
                    <p>–ü–æ—è–≤–ª—è—é—Ç—Å—è –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –ø–æ–∏—Å–∫–∞. –ï—Å—Ç—å –¥–≤–∞ —Ç–∏–ø–∞:</p>

                    <h4>1. –ü—Ä–æ–≥—Ä–µ—Å—Å –ø–æ–∏—Å–∫–∞ —Å–æ–±—ã—Ç–∏–π</h4>
                    <ul>
                        <li>–ü–æ—è–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ <strong>¬´–ù–∞—á–∞—Ç—å –ø–æ–∏—Å–∫¬ª</strong></li>
                        <li>–ß–µ—Ç—ã—Ä–µ –∫—Ä—É–≥–∞: –∑–∞–≥—Ä—É–∑–∫–∞ —Å–µ—Å—Å–∏–π ‚Üí –∑–∞–≥—Ä—É–∑–∫–∞ —Å–æ–±—ã—Ç–∏–π ‚Üí —Ä–∞—Å–∫—Ä—ã—Ç–∏–µ ‚Üí –∫–ª–∏–∫+–ø–æ–∏—Å–∫</li>
                        <li>–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å: <code>–ö–ª–∏–∫–∞—é –ø–æ —Å–æ–±—ã—Ç–∏—è–º –∏ –æ—Å—É—â–µ—Å—Ç–≤–ª—è—é –ø–æ–∏—Å–∫: N –∏–∑ 231</code></li>
                        <li>–ö–Ω–æ–ø–∫–∞ —Å–æ —Å—Ç—Ä–µ–ª–∫–æ–π ‚Äî –≤–∫–ª—é—á–∞–µ—Ç —Ä–µ–∂–∏–º <strong>¬´—Å–ª–µ–¥–∏—Ç—å¬ª</strong> (–∑–∞–∫—Ä–µ–ø–ª–µ–Ω–∏–µ –ø—Ä–∏ –ø—Ä–æ–∫—Ä—É—Ç–∫–µ)</li>
                        <li>–ö—Ä–µ—Å—Ç–∏–∫ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –¥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø–æ–∏—Å–∫–∞</li>
                    </ul>

                    <h4>2. –ü—Ä–æ–≥—Ä–µ—Å—Å –ø–æ–∏—Å–∫–∞ –æ—à–∏–±–æ–∫</h4>
                    <ul>
                        <li>–ü–æ—è–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ <strong>¬´–û—à–∏–±–∫–∏¬ª</strong></li>
                        <li>–¢—Ä–∏ –∫—Ä—É–≥–∞: –∑–∞–≥—Ä—É–∑–∫–∞ —Å–µ—Å—Å–∏–π ‚Üí –∑–∞–≥—Ä—É–∑–∫–∞ —Å–æ–±—ã—Ç–∏–π ‚Üí –ø–æ–∏—Å–∫</li>
                        <li>–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å: <code>–ó–∞–≥—Ä—É–∂–∞—é —Å–æ–±—ã—Ç–∏—è: N –∏–∑ X</code></li>
                        <li>–ö–Ω–æ–ø–∫–∞ —Å–æ —Å—Ç—Ä–µ–ª–∫–æ–π ‚Äî –≤–∫–ª—é—á–∞–µ—Ç —Ä–µ–∂–∏–º <strong>¬´—Å–ª–µ–¥–∏—Ç—å¬ª</strong> (–∑–∞–∫—Ä–µ–ø–ª–µ–Ω–∏–µ –ø—Ä–∏ –ø—Ä–æ–∫—Ä—É—Ç–∫–µ)</li>
                        <li>–ö—Ä–µ—Å—Ç–∏–∫ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –¥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø–æ–∏—Å–∫–∞</li>
                    </ul>

                    <h4>–†–µ–∂–∏–º ¬´—Å–ª–µ–¥–∏—Ç—å¬ª:</h4>
                    <ul>
                        <li>–ü—Ä–∏ –≤–∫–ª—é—á–µ–Ω–∏–∏ ‚Äî –ø–∞–Ω–µ–ª—å –∑–∞–∫—Ä–µ–ø–ª—è–µ—Ç—Å—è –ø—Ä–∏ –ø—Ä–æ–∫—Ä—É—Ç–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã</li>
                        <li>–°–æ—Å—Ç–æ—è–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –º–µ–∂–¥—É —Å–µ—Å—Å–∏—è–º–∏</li>
                        <li>–ü–æ–≤—Ç–æ—Ä–Ω—ã–π –∫–ª–∏–∫ ‚Äî –æ—Ç–∫–ª—é—á–∞–µ—Ç —Ä–µ–∂–∏–º</li>
                    </ul>

                    <h4>–§–∏–Ω–∞–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç:</h4>
                    <ul>
                        <li><strong>–ï—Å–ª–∏ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π –Ω–µ—Ç</strong>: <code>–ü–æ–∏—Å–∫ –∑–∞–≤–µ—Ä—à—ë–Ω. –ò—Å–∫–æ–º—ã–µ —Å–æ–±—ã—Ç–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</code></li>
                        <li><strong>–ï—Å–ª–∏ –µ—Å—Ç—å</strong>: <code>–ü–æ–∏—Å–∫ –∑–∞–≤–µ—Ä—à—ë–Ω. –ù–∞–π–¥–µ–Ω–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π: N</code></li>
                        <li><strong>–î–ª—è –æ—à–∏–±–æ–∫</strong>: <code>–ü–æ–∏—Å–∫ –∑–∞–≤–µ—Ä—à—ë–Ω. –ù–∞–π–¥–µ–Ω–æ –æ—à–∏–±–æ–∫: N –∏–∑ –Ω–∏—Ö X Crash</code> (–≥–¥–µ <code>X</code> ‚Äî –∫—Ä–∞—Å–Ω–æ–µ —á–∏—Å–ª–æ, –µ—Å–ª–∏ X > 0)</li>
                    </ul>
                </div>

                <!-- –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å —Å–æ–±—ã—Ç–∏—è -->
                <div id="showcurrent" class="sfua_howto_panel">
                    <h3>–ö–Ω–æ–ø–∫–∞ ¬´–†–∞–∑–≤–µ—Ä–Ω—É—Ç—å —Å–æ–±—ã—Ç–∏—è¬ª</h3>
                    <p>–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞—Å–∫—Ä—ã–≤–∞–µ—Ç —Å–∫—Ä—ã—Ç—ã–µ —Å–æ–±—ã—Ç–∏—è –≤ —Å–µ—Å—Å–∏–∏: <strong>¬´+N¬ª</strong>, <strong>¬´–í—Å–µ N —Å–æ–±—ã—Ç–∏–π¬ª</strong> –∏ –æ—Å–Ω–æ–≤–Ω—ã–µ —Ç–∏–ø—ã —Å–æ–±—ã—Ç–∏–π.</p>

                    <h4>–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:</h4>
                    <ol>
                        <li>–ü–æ—è–≤–ª—è–µ—Ç—Å—è —Å–ª–µ–≤–∞ –æ—Ç –¥–∞—Ç—ã –∫–∞–∂–¥–æ–π —Å–µ—Å—Å–∏–∏</li>
                        <li>–ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –∫–ª–∏–∫–∞–µ—Ç –ø–æ –≤—Å–µ–º —ç–ª–µ–º–µ–Ω—Ç–∞–º, –∫–æ—Ç–æ—Ä—ã–µ —Å–∫—Ä—ã–≤–∞—é—Ç —Å–æ–±—ã—Ç–∏—è</li>
                        <li>–†–∞—Å–∫—Ä—ã–≤–∞–µ—Ç –ø–æ–ª–Ω—ã–π –ø–æ—Ç–æ–∫ —Å–æ–±—ã—Ç–∏–π –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞</li>
                    </ol>

                    <h4>–≠–ª–µ–º–µ–Ω—Ç—ã, –ø–æ –∫–æ—Ç–æ—Ä—ã–º –∫–ª–∏–∫–∞–µ—Ç:</h4>
                    <ul>
                        <li><strong>¬´+N¬ª</strong> ‚Äî —Ä–∞—Å–∫—Ä—ã–≤–∞–µ—Ç —Å–∫—Ä—ã—Ç—ã–µ —Å–æ–±—ã—Ç–∏—è</li>
                        <li><strong>¬´–í—Å–µ N —Å–æ–±—ã—Ç–∏–π¬ª</strong> ‚Äî –∑–∞–≥—Ä—É–∂–∞–µ—Ç –≤—Å–µ —Å–æ–±—ã—Ç–∏—è –≤ —Å–µ—Å—Å–∏–∏</li>
                        <li><strong>–¢–∏–ø—ã —Å–æ–±—ã—Ç–∏–π</strong>: <code>tap</code>, <code>deeplink</code>, <code>error</code>, <code>tech</code>, <code>authorization</code> –∏ –¥—Ä—É–≥–∏–µ –∏–∑ —Å–ø–∏—Å–∫–∞</li>
                    </ul>

                    <h4>–ó–∞—â–∏—Ç–∞ –æ—Ç –¥—É–±–ª–µ–π:</h4>
                    <ul>
                        <li>–ü–µ—Ä–µ–¥ –∫–ª–∏–∫–æ–º –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, –µ—Å—Ç—å –ª–∏ —É —ç–ª–µ–º–µ–Ω—Ç–∞ –∫–ª–∞—Å—Å <code>span_checked</code></li>
                        <li>–ï—Å–ª–∏ –∫–ª–∞—Å—Å –µ—Å—Ç—å ‚Äî –∫–ª–∏–∫ –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è</li>
                        <li>–ü–æ—Å–ª–µ –∫–ª–∏–∫–∞ –∫–ª–∞—Å—Å <code>span_checked</code> –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏</li>
                    </ul>

                    <h4>–°–æ—Å—Ç–æ—è–Ω–∏—è –∫–Ω–æ–ø–∫–∏:</h4>
                    <ul>
                        <li><strong>¬´–†–∞–∑–≤–µ—Ä–Ω—É—Ç—å —Å–æ–±—ã—Ç–∏—è —Å–µ—Å—Å–∏–∏¬ª</strong> ‚Äî –Ω–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ</li>
                        <li><strong style="color: #555;">¬´–ó–∞–≥—Ä—É–∑–∫–∞...¬ª</strong> ‚Äî –∏–¥—ë—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∞ (–∫–ª–∏–∫ –ø–æ —ç–ª–µ–º–µ–Ω—Ç–∞–º)</li>
                        <li><strong style="color: #0a0;">¬´–°–æ–±—ã—Ç–∏—è –∑–∞–≥—Ä—É–∂–µ–Ω—ã¬ª</strong> ‚Äî –≤—Å—ë —Ä–∞—Å–∫—Ä—ã—Ç–æ</li>
                    </ul>

                    <h4>–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:</h4>
                    <ul>
                        <li>–†–∞–±–æ—Ç–∞–µ—Ç –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ ‚Äî –∫–Ω–æ–ø–∫–∞ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å–µ—Å—Å–∏–∏</li>
                        <li>–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫—É—é –ø–æ–¥–≥—Ä—É–∑–∫—É (—á–µ—Ä–µ–∑ <code>MutationObserver</code>)</li>
                        <li>–ù–µ –º–µ—à–∞–µ—Ç –¥—Ä—É–≥–∏–º —Ñ—É–Ω–∫—Ü–∏—è–º —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è</li>
                    </ul>
                </div>

                <!-- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ ID -->
                <div id="update" class="sfua_howto_panel">
                    <h3>–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ ID –ø—Ä–æ—Ñ–∏–ª—è</h3>
                    <p>–ü–æ–∑–≤–æ–ª—è–µ—Ç –±—ã—Å—Ç—Ä–æ —Å–º–µ–Ω–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å –±–µ–∑ —Ä—É—á–Ω–æ–π –ø–æ–¥–º–µ–Ω—ã –≤ –∞–¥—Ä–µ—Å–Ω–æ–π —Å—Ç—Ä–æ–∫–µ</p>

                    <h4>–ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:</h4>
                    <ol>
                        <li>–°–∫–æ–ø–∏—Ä—É–π—Ç–µ ID –ø—Ä–æ—Ñ–∏–ª—è (–Ω–µ –º–µ–Ω–µ–µ 15 —Å–∏–º–≤–æ–ª–æ–≤)</li>
                        <li>–í—Å—Ç–∞–≤—å—Ç–µ –≤ –ø–æ–ª–µ –≤–≤–æ–¥–∞ –≤ AppMetrica</li>
                        <li>–ù–∞–∂–º–∏—Ç–µ Enter –∏–ª–∏ –∫–Ω–æ–ø–∫—É ¬´–û–±–Ω–æ–≤–∏—Ç—å¬ª</li>
                    </ol>

                    <h4>–í–∞–ª–∏–¥–∞—Ü–∏—è:</h4>
                    <ul>
                        <li>–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ ID ‚Äî <strong>15 —Å–∏–º–≤–æ–ª–æ–≤</strong></li>
                        <li>ID –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —á–∏—Å–ª–æ–º</li>
                        <li>ID –¥–æ–ª–∂–µ–Ω –æ—Ç–ª–∏—á–∞—Ç—å—Å—è –æ—Ç —Ç–µ–∫—É—â–µ–≥–æ</li>
                        <li>–ï—Å–ª–∏ iframe –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª—Å—è ‚Äî –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç</li>
                    </ul>

                    <h4>–í–∏–∑—É–∞–ª—å–Ω—ã–µ –ø–æ–¥—Å–∫–∞–∑–∫–∏:</h4>
                    <ul>
                        <li><span class="indicator yellow"></span> <strong>–ñ—ë–ª—Ç–∞—è —Ä–∞–º–∫–∞</strong> ‚Äî ID –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –≤–≤–µ–¥–µ–Ω–Ω–æ–º—É</li>
                        <li><span class="indicator green"></span> <strong>–ó–µ–ª—ë–Ω–∞—è —Ä–∞–º–∫–∞</strong> ‚Äî –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ</li>
                        <li><span class="indicator red"></span> <strong>–ö—Ä–∞—Å–Ω–∞—è —Ä–∞–º–∫–∞</strong> ‚Äî –æ—à–∏–±–∫–∞ (ID –Ω–µ –ø—Ä–æ—à–µ–ª –≤–∞–ª–∏–¥–∞—Ü–∏—é)</li>
                    </ul>
                </div>

                <!-- –í—Ä–µ–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
                <div id="timezone" class="sfua_howto_panel">
                    <h3>–í—Ä–µ–º—è —Å–µ—Å—Å–∏–∏ –≤ —á–∞—Å–æ–≤–æ–º –ø–æ—è—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h3>
                    <p>–û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –≤—Ä–µ–º—è –Ω–∞—á–∞–ª–∞ —Å–µ—Å—Å–∏–∏ —Å —É—á—ë—Ç–æ–º —á–∞—Å–æ–≤–æ–≥–æ –ø–æ—è—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.</p>

                    <h4>–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:</h4>
                    <ol>
                        <li>–†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –∏—â–µ—Ç —Ä–µ–≥–∏–æ–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Ç–∞–±–ª–∏—Ü–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ (–≤ AppMetrica)</li>
                        <li>–°—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç –µ–≥–æ —Å –±–∞–∑–æ–π <code>data/timezones.json</code></li>
                        <li>–ï—Å–ª–∏ —Ä–µ–≥–∏–æ–Ω –Ω–∞–π–¥–µ–Ω ‚Äî —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç —Å–º–µ—â–µ–Ω–∏–µ –æ—Ç UTC</li>
                        <li>–ü—Ä–∏–º–µ–Ω—è–µ—Ç —Å–º–µ—â–µ–Ω–∏–µ –∫ –≤—Ä–µ–º–µ–Ω–∏ —Å–µ—Å—Å–∏–∏</li>
                        <li>–û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ —Å–∫–æ–±–∫–∞—Ö —Ä—è–¥–æ–º —Å –¥–∞—Ç–æ–π</li>
                    </ol>

                    <h4>–ü—Ä–∏–º–µ—Ä –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è:</h4>
                    <pre style="background: #1e1e1e; padding: 12px; border-radius: 6px; font-family: monospace; margin: 10px 0;">
10 —è–Ω–≤ 2025, 15:23 (17:23)
                    </pre>
                    <p>–ì–¥–µ <code>17:23</code> ‚Äî –≤—Ä–µ–º—è –≤ —á–∞—Å–æ–≤–æ–º –ø–æ—è—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.</p>

                    <h4>–£—Å–ª–æ–≤–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è:</h4>
                    <ul>
                        <li>–†–µ–≥–∏–æ–Ω –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É–∫–∞–∑–∞–Ω –≤ AppMetrica</li>
                        <li>–†–µ–≥–∏–æ–Ω –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ —Ñ–∞–π–ª–µ <code>timezones.json</code></li>
                        <li>–ï—Å–ª–∏ —É—Å–ª–æ–≤–∏–µ –Ω–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ ‚Äî –≤—Ä–µ–º—è –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è</li>
                    </ul>

                    <h4>–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:</h4>
                    <ul>
                        <li>–†–∞–±–æ—Ç–∞–µ—Ç –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ ‚Äî –∫–Ω–æ–ø–∫–∞ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å–µ—Å—Å–∏–∏</li>
                        <li>–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫—É—é –ø–æ–¥–≥—Ä—É–∑–∫—É (—á–µ—Ä–µ–∑ <code>MutationObserver</code>)</li>
                    </ul>
                </div>
            </div>

            <!-- –§—É—Ç–µ—Ä -->
            <div class="sfua_howto_footer">
                <button class="sfua_howto_ok">–ü–æ–Ω—è—Ç–Ω–æ</button>
            </div>
        </div>
    </div>
</body>
</html>


manifest.json:
--------------------------------------------------
{
  "manifest_version": 3,
  "name": "SFUA FE",
  "version": "6.3.52",
  "description": "–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –∞–Ω–∞–ª–∏–∑–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Å–µ—Å—Å–∏–π –≤ –Ø–Ω–¥–µ–∫—Å AppMetrica",
  "permissions": ["scripting", "activeTab", "storage", "tabs", "webNavigation"],
  "host_permissions": ["*://appmetrica.yandex.ru/*"],
  "background": {
    "service_worker": "background.js"
  },
  "content_scripts": [
    {
      "matches": ["*://appmetrica.yandex.ru/*"],
      "js": [
        "content/showcurrent.js",
        "content/usertimezone.js",
        "content/scrolltotop.js",
        "content/sync_manual_clicks.js"],
      "all_frames": true,
      "run_at": "document_end"
    }
  ],
"web_accessible_resources": [
  {
    "resources": [
      "data/timezones.json",
      "actions/*.js",
      "background/*.js",
      "content/styles/showcurrent.css",
      "background/styles/*.css",
      "content/styles/*.css",
      "content/*.js",
      "styles.css",
      "modal_error.js",
      "*.js",
      "*.css",
      "*.html"
    ],
    "matches": ["<all_urls>"]
  }
],
  "action": {
    "default_popup": "popup.html",
    "default_icon": {
      "16": "icons/icon16.png",
      "48": "icons/icon48.png",
      "128": "icons/icon128.png"
    }
  },
  "icons": {
    "16": "icons/icon16.png",
    "48": "icons/icon48.png",
    "128": "icons/icon128.png"
  }
}


how_to_use.css:
--------------------------------------------------
/* how_to_use.css ‚Äî —Ç—ë–º–Ω–∞—è —Ç–µ–º–∞ VS Code + —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤—ã—Å–æ—Ç–∞ */

.sfua_howto_modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.6);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 2147483647;
    opacity: 0;
    transition: opacity 0.3s ease;
}

.sfua_howto_content {
    width: 48%;
    background: #1e1e1e; /* –§–æ–Ω VS Code */
    border-radius: 12px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
    overflow: hidden;
    display: flex;
    flex-direction: column;
    height: 680px;
    transition: transform 0.3s ease;
}

/* –ó–∞–≥–æ–ª–æ–≤–æ–∫ */
.sfua_howto_header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 16px 20px;
    background: #007acc; /* –°–∏–Ω–∏–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∫–∞–∫ –≤ VS Code */
    color: white;
    font-size: 16px;
    font-weight: 600;
    border-bottom: 1px solid #3c3c3c;
}

.sfua_howto_close {
    background: none;
    border: none;
    font-size: 24px;
    color: white;
    cursor: pointer;
    width: 30px;
    height: 30px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
    transition: background 0.2s ease;
}

.sfua_howto_close:hover {
    background: rgba(255, 255, 255, 0.2);
}

/* –í–∫–ª–∞–¥–∫–∏ */
.sfua_howto_tabs {
    display: flex;
    background: #1e1e1e; /* –§–æ–Ω VS Code */
    border-bottom: 1px solid #3c3c3c;
    font-size: 14px;
    font-weight: 500;
    overflow-x: auto;
    scrollbar-width: thin;
    margin: 0 auto;
}

.sfua_howto_tab {
    padding: 12px 16px;
    background: none;
    border: none;
    color: #d4d4d4;
    cursor: pointer;
    white-space: nowrap;
    transition: all 0.2s ease;
    border-bottom: 2px solid transparent;
}

.sfua_howto_tab.active {
    color: #007acc;
    border-bottom-color: #007acc;
}

.sfua_howto_tab:hover:not(.active) {
    color: #ffffff;
    background: rgba(255, 255, 255, 0.05);
}

/* –¢–µ–ª–æ —Å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –≤—ã—Å–æ—Ç–æ–π –∏ —Å–∫—Ä–æ–ª–ª–æ–º */
.sfua_howto_body {
    padding: 24px;
    color: #d4d4d4;
    line-height: 1.6;
    font-size: 14px;
    background: #252526;
    height: calc(680px - 180px);
    overflow-y: auto;
    overflow-x: hidden;
}

.sfua_howto_panel {
    display: none;
}

.sfua_howto_panel.active {
    display: block;
}

.sfua_howto_panel h3 {
    margin: 0 0 12px 0;
    color: #4fc1ff;
    font-weight: 600;
}

.sfua_howto_panel h4 {
    margin: 16px 0 8px 0;
    color: #7ea6e0;
    font-weight: 500;
}

.sfua_howto_panel ul {
    margin: 8px 0;
    padding-left: 20px;
}

.sfua_howto_panel code {
    background: #1e1e1e;
    color: #d4d4d4;
    padding: 2px 6px;
    border-radius: 4px;
    font-family: 'Courier New', monospace;
    font-size: 13px;
    border: 1px solid #3c3c3c;
}

/* –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã —Ü–≤–µ—Ç–æ–≤ */
.indicator {
    display: inline-block;
    width: 12px;
    height: 12px;
    border-radius: 50%;
    margin-right: 8px;
    vertical-align: middle;
}

.indicator.green { background: #48bb78; }
.indicator.yellow { background: #ecc94b; }
.indicator.red { background: #e53e3e; }

/* –§—É—Ç–µ—Ä */
.sfua_howto_footer {
    padding: 16px 20px;
    text-align: center;
    background: #252526;
    border-top: 1px solid #3c3c3c;
}

.sfua_howto_ok {
    padding: 8px 20px;
    background: #007acc;
    color: white;
    border: none;
    border-radius: 6px;
    font-size: 14px;
    cursor: pointer;
    transition: background 0.2s ease;
}

.sfua_howto_ok:hover {
    background: #005a9e;
}

/* –°–∫—Ä–æ–ª–ª–±–∞—Ä (–≤ —Å—Ç–∏–ª–µ VS Code) */
.sfua_howto_body::-webkit-scrollbar {
    width: 6px;
}

.sfua_howto_body::-webkit-scrollbar-track {
    background: #252526;
}

.sfua_howto_body::-webkit-scrollbar-thumb {
    background: #5a5a5a;
    border-radius: 3px;
}

.sfua_howto_body::-webkit-scrollbar-thumb:hover {
    background: #757575;
}


progress.css:
--------------------------------------------------
/* progress.css */

/* === –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä === */
.sfua_result_container {
    width: 100%;
    background: white;
    border: 1px solid #e2e8f0;
    border-radius: 8px;
    box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
    overflow: hidden;
    z-index: 10000;
    font-family: 'Segoe UI', sans-serif;
    font-size: 12px;
    color: #4a5568;
    position: relative;
    margin: 10px auto 8px;
    box-sizing: border-box;
}

/* –†–µ–∂–∏–º "–∑–∞–∫—Ä–µ–ø–ª—ë–Ω" ‚Äî —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è –ò —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ following */
.sfua_result_container.pinned.following {
    position: fixed;
    top: -40px;
    left: 25%;
    transform: translateX(-50%);
    width: 1200px;
    margin: 0 !important;
    z-index: 10001;
    animation: slideDown 0.3s forwards;
}

@keyframes slideDown {
    from { top: -40px; }
    to { top: 10px; }
}

.sfua_result_container.pinned:not(.following) {
    position: static;
    margin: 10px auto 8px;
}

/* –ö—Ä—É–≥–∏ */
.sfua_result_container .circle_wrapper {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 20px;
    height: 20px;
}

.sfua_result_container .progress_circle {
    width: 20px;
    height: 20px;
    background-color: #edf2f7;
    border-radius: 50%;
    transition: all 0.2s ease;
}

/* –ó–∞–≥–æ–ª–æ–≤–æ–∫ */
.sfua_result_container .progress_header {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 8px 0;
    width: 100%;
}

.sfua_result_container .progress_circles {
    display: flex;
    gap: 10px;
    justify-content: center;
    margin-bottom: 6px;
    width: 100%;
    max-width: 180px;
}

.sfua_result_container .current_operation {
    text-align: center;
    font-weight: 500;
    font-size: 13px;
}

/* –†–µ–∑—É–ª—å—Ç–∞—Ç—ã */
.sfua_result_container .results_container {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
    padding: 0 12px 8px;
    max-height: 100px;
    overflow-y: auto;
    justify-content: center;
}

/* –ö–Ω–æ–ø–∫–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ */
.sfua_result_container .results_container .sfua_result_item {
    padding: 5px 10px;
    background-color: #f7fafc; /* –°–≤–µ—Ç–ª–µ–µ, —á–µ–º #edf2f7 */
    border-radius: 6px;
    font-size: 11px;
    font-weight: 500;
    color: #4a5568;
    cursor: pointer;
    white-space: nowrap;
    opacity: 0;
    transform: translateY(4px);
    transition: 
        opacity 0.2s ease,
        transform 0.2s ease;
}

/* –ü–æ—è–≤–ª–µ–Ω–∏–µ */
.sfua_result_container .results_container .sfua_result_item {
    opacity: 0;
    transform: translateY(4px);
}

.sfua_result_container .results_container .sfua_result_item:hover {
    background-color: rgb(203, 212, 221) !important;
    transform: translateY(0);
    box-shadow: 0 1px 3px rgba(66, 153, 225, 0.2);
    transition: 
        background-color 0.2s ease,
        color 0.2s ease,
        transform 0.1s ease,
        box-shadow 0.2s ease,
        border 0.2s ease;
}


allcode.py:
--------------------------------------------------
import os
import pathlib

def collect_files_content(folder_path, output_file="project_content.txt"):
    """
    –°–æ–±–∏—Ä–∞–µ—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤ –≤ –ø–∞–ø–∫–µ –∏ —Å–æ–∑–¥–∞–µ—Ç –∏—Ç–æ–≥–æ–≤—ã–π —Ñ–∞–π–ª
    """
    # –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤
    supported_extensions = {'.html', '.css', '.js','.json', '.xml'}
    
    # –ü–æ–ª—É—á–∞–µ–º –∞–±—Å–æ–ª—é—Ç–Ω—ã–π –ø—É—Ç—å –∫ –ø–∞–ø–∫–µ
    folder_path = os.path.abspath(folder_path)
    
    with open(output_file, 'w', encoding='utf-8') as output:
        # –°–Ω–∞—á–∞–ª–∞ —Å–æ–±–∏—Ä–∞–µ–º –≤—Å–µ —Ñ–∞–π–ª—ã
        all_files = []
        for root, dirs, files in os.walk(folder_path):
            for file in files:
                file_path = os.path.join(root, file)
                file_ext = pathlib.Path(file).suffix.lower()
                
                # –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Ñ–∞–π–ª—ã –∏ —Å–∞–º –≤—ã—Ö–æ–¥–Ω–æ–π —Ñ–∞–π–ª
                if (file.startswith('.') or file == output_file or 
                    file.startswith('__') or file == 'Thumbs.db'):
                    continue
                
                # –î–æ–±–∞–≤–ª—è–µ–º —Ñ–∞–π–ª, –¥–∞–∂–µ –µ—Å–ª–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è
                all_files.append(file_path)
        
        # –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º —Ñ–∞–π–ª—ã
        for file_path in all_files:
            try:
                relative_path = os.path.relpath(file_path, folder_path)
                file_ext = pathlib.Path(file_path).suffix.lower()
                
                # –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Ñ–∞–π–ª–∞
                output.write(f"\n{relative_path}:\n")
                output.write("-" * 50 + "\n")
                
                # –ß–∏—Ç–∞–µ–º –∏ –∑–∞–ø–∏—Å—ã–≤–∞–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞
                with open(file_path, 'r', encoding='utf-8', errors='ignore') as f:
                    content = f.read()
                    output.write(content)
                    output.write("\n\n")
                    
            except Exception as e:
                output.write(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ —Ñ–∞–π–ª–∞ {file_path}: {str(e)}\n\n")
        
        # –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–æ–µ–∫—Ç–∞ –≤ –∫–æ–Ω—Ü–µ
        output.write("\n" + "="*60 + "\n")
        output.write("–°–¢–†–£–ö–¢–£–†–ê –ü–†–û–ï–ö–¢–ê:\n")
        output.write("="*60 + "\n")
        generate_directory_tree(folder_path, output)

def generate_directory_tree(start_path, output_file, prefix=''):
    """
    –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç ASCII —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∫–∞—Ç–∞–ª–æ–≥–æ–≤
    """
    if not os.path.exists(start_path):
        output_file.write(f"–ü—É—Ç—å –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç: {start_path}\n")
        return
    
    if os.path.isfile(start_path):
        output_file.write(f"{prefix}üìÑ {os.path.basename(start_path)}\n")
        return
    
    items = os.listdir(start_path)
    items = [item for item in items if not item.startswith('.') and item != '__pycache__']
    items.sort()
    
    for i, item in enumerate(items):
        path = os.path.join(start_path, item)
        is_last = i == len(items) - 1
        
        if os.path.isdir(path):
            output_file.write(f"{prefix}{'‚îî‚îÄ‚îÄ ' if is_last else '‚îú‚îÄ‚îÄ '}üìÅ {item}/\n")
            new_prefix = prefix + ('    ' if is_last else '‚îÇ   ')
            generate_directory_tree(path, output_file, new_prefix)
        else:
            output_file.write(f"{prefix}{'‚îî‚îÄ‚îÄ ' if is_last else '‚îú‚îÄ‚îÄ '}üìÑ {item}\n")

if __name__ == "__main__":
    # –£–∫–∞–∂–∏—Ç–µ –ø—É—Ç—å –∫ –≤–∞—à–µ–π –ø–∞–ø–∫–µ
    folder_to_scan = input("–í–≤–µ–¥–∏—Ç–µ –ø—É—Ç—å –∫ –ø–∞–ø–∫–µ (–∏–ª–∏ –Ω–∞–∂–º–∏—Ç–µ Enter –¥–ª—è —Ç–µ–∫—É—â–µ–π –ø–∞–ø–∫–∏): ").strip()
    
    if not folder_to_scan:
        folder_to_scan = "."
    
    if os.path.exists(folder_to_scan):
        output_filename = "project_content.txt"
        collect_files_content(folder_to_scan, output_filename)
        print(f"–§–∞–π–ª {output_filename} —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω!")
    else:
        print("–£–∫–∞–∑–∞–Ω–Ω–∞—è –ø–∞–ø–∫–∞ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç!")


popup.html:
--------------------------------------------------
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>SFUA</title>
    <link rel="stylesheet" href="styles.css">
    <script src="popup.js" defer></script>
</head>
<body>
    <div class="sfua_container">
        <div class="section">
            <h3>–¢–∏–ø —Å–æ–±—ã—Ç–∏—è</h3>
            <div class="event_types">
                <span class="event_type active">tap</span>
                <span class="event_type">open_screen</span>
                <span class="event_type">condition</span>
                <span class="event_type">event</span>
                <span class="event_type">authorization</span>
                <span class="event_type">tabbar</span>
                <span class="event_type">deeplink</span>
                <span class="event_type">tech</span>
                <span class="event_type">error</span>
                <span class="event_type">open_error</span>
                <span class="event_type">open_error_screen</span>
                <span class="event_type">errorMetric</span>
                <span class="event_type">offline_tap</span>
            </div>
        </div>

        <div class="section">
            <h3>–ü–∞—Ä–∞–º–µ—Ç—Ä—ã</h3>
            <div class="params_row">
                <input class="param_key" type="text" value="%">
                <span class="equals">=</span>
                <input class="param_value" type="text" value="–æ–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ">
            </div>
        </div>

        <!-- –ö–Ω–æ–ø–∫–∏ –≤ –æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–µ -->
        <div class="buttons_row">
            <button class="search_button">–ù–∞—á–∞—Ç—å –ø–æ–∏—Å–∫</button>
            <button class="error_search_button">
                <span class="error_icon"></span>
                <span class="error_text">–û—à–∏–±–∫–∏</span>
            </button>
        </div>

        <!-- –ö–Ω–æ–ø–∫–∞ FAQ -->
        <div class="faq_row">
            <button class="faq_button">–ö—Ä–∞—Ç–∫–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ</button>
        </div>
    </div>
</body>
</html>


popup.js:
--------------------------------------------------
// popup.js

document.addEventListener('DOMContentLoaded', async function () {
    const eventTypes = document.querySelectorAll('.event_type');
    const searchButton = document.querySelector('.search_button');
    const errorSearchButton = document.querySelector('.error_search_button');
    const paramKey = document.querySelector('.param_key');
    const paramValue = document.querySelector('.param_value');

    let currentTabId = null;

    // –ü–æ–ª—É—á–∞–µ–º –∞–∫—Ç–∏–≤–Ω—É—é –≤–∫–ª–∞–¥–∫—É AppMetrica
    try {
        const tabs = await chrome.tabs.query({
            active: true,
            currentWindow: true,
            url: ['*://appmetrica.yandex.ru/*']
        });
        const appTab = tabs.find(tab => tab.url.includes('appmetrica.yandex.ru'));
        if (appTab) {
            currentTabId = appTab.id;
        }
    } catch (err) {
        console.error('SFUA: –û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –≤–∫–ª–∞–¥–∫–∏:', err);
    }

    // –ï—Å–ª–∏ AppMetrica –Ω–µ –æ—Ç–∫—Ä—ã—Ç–∞
    if (!currentTabId) {
        document.querySelector('.sfua_container').innerHTML = `
            <div style="text-align: center; color: #718096; font-size: 12px; padding: 20px;">
                –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ AppMetrica
            </div>
        `;
        return;
    }

    const STORAGE_KEY = `sfua_popup_state_tab_${currentTabId}`;
    const ERROR_SEARCH_DONE_KEY = `sfua_error_search_done_tab_${currentTabId}`;
    const SEARCH_IN_PROGRESS_KEY = `sfua_search_in_progress_tab_${currentTabId}`;

    // === –§—É–Ω–∫—Ü–∏–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –∫–Ω–æ–ø–∫–∏ "–ü–æ–∏—Å–∫ –æ—à–∏–±–æ–∫" ===
    function disableErrorSearchButton() {
        errorSearchButton.disabled = true;
        errorSearchButton.style.opacity = '0.6';
        errorSearchButton.title = '–ü–æ–∏—Å–∫ –æ—à–∏–±–æ–∫ —É–∂–µ –≤—ã–ø–æ–ª–Ω–µ–Ω. –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É, —á—Ç–æ–±—ã –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–Ω–æ–≤–∞.';
    }

    function enableErrorSearchButton() {
        errorSearchButton.disabled = false;
        errorSearchButton.style.opacity = '1';
        errorSearchButton.title = '–ü–æ–∏—Å–∫ –≤—Å–µ—Ö –æ—à–∏–±–æ–∫ (–≤–∫–ª—é—á–∞—è –ö—Ä—ç—à)';
    }

    // === –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–æ–∏—Å–∫–∞ –æ—à–∏–±–æ–∫ ===
    async function checkErrorSearchState() {
        const result = await chrome.storage.local.get([ERROR_SEARCH_DONE_KEY]);
        const isDone = result[ERROR_SEARCH_DONE_KEY] === true;
        const hasActiveContainer = !!document.querySelector('.sfua_error_container');

        if (isDone && !hasActiveContainer) {
            // –ü–æ–∏—Å–∫ –±—ã–ª –∑–∞–≤–µ—Ä—à—ë–Ω, –Ω–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –Ω–µ—Ç ‚Üí –º–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–Ω–æ–≤–∞
            enableErrorSearchButton();
            // –û—á–∏—â–∞–µ–º —É—Å—Ç–∞—Ä–µ–≤—à–∏–π —Ñ–ª–∞–≥
            chrome.storage.local.remove(ERROR_SEARCH_DONE_KEY);
        } else if (isDone && hasActiveContainer) {
            // –ü–æ–∏—Å–∫ –∑–∞–≤–µ—Ä—à—ë–Ω –∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∞–∫—Ç–∏–≤–µ–Ω ‚Üí –Ω–µ–ª—å–∑—è –∑–∞–ø—É—Å–∫–∞—Ç—å
            disableErrorSearchButton();
        } else {
            // –ù–∏–∫–∞–∫–∏—Ö —Å–ª–µ–¥–æ–≤ –ø–æ–∏—Å–∫–∞ ‚Üí —Ä–∞–∑—Ä–µ—à–∞–µ–º
            enableErrorSearchButton();
        }
    }

    // === –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è ===
    const result = await chrome.storage.local.get([STORAGE_KEY, ERROR_SEARCH_DONE_KEY, SEARCH_IN_PROGRESS_KEY]);
    const saved = result[STORAGE_KEY];

    if (saved) {
        eventTypes.forEach(type => {
            if (type.textContent.trim() === saved.eventType) {
                type.classList.add('active');
            } else {
                type.classList.remove('active');
            }
        });
        if (saved.key !== undefined) paramKey.value = saved.key;
        if (saved.value !== undefined) paramValue.value = saved.value;
    } else if (eventTypes.length > 0) {
        eventTypes[0].classList.add('active');
    }

    // === –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –æ–±—ã—á–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞ ===
    if (result[SEARCH_IN_PROGRESS_KEY]) {
        searchButton.disabled = true;
        searchButton.textContent = '–ò–¥—ë—Ç –ø–æ–∏—Å–∫‚Ä¶';
        searchButton.title = '–ò–¥—ë—Ç –ø–æ–∏—Å–∫. –ß—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –Ω–æ–≤—ã–π, –Ω—É–∂–Ω–æ –¥–æ–∂–¥–∞—Ç—å—Å—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∏–ª–∏ –æ–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É';
    } else {
        searchButton.title = '–ü–æ–∏—Å–∫ —Å–æ–±—ã—Ç–∏–π –ø–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—é –∫–ª—é—á:–∑–Ω–∞—á–µ–Ω–∏–µ –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥';
    }

    // === –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ —Ç–∏–ø–∞ —Å–æ–±—ã—Ç–∏—è ===
    eventTypes.forEach(type => {
        type.addEventListener('click', () => {
            eventTypes.forEach(t => t.classList.remove('active'));
            type.classList.add('active');
            saveState();
        });
    });

    paramKey.addEventListener('input', saveState);
    paramValue.addEventListener('input', saveState);

    // === –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è ===
    function saveState() {
        const activeType = document.querySelector('.event_type.active');
        const state = {
            eventType: activeType ? activeType.textContent.trim() : 'tap',
            key: paramKey.value,
            value: paramValue.value
        };
        const changes = {};
        changes[STORAGE_KEY] = state;
        chrome.storage.local.set(changes);
    }

    // === –ö–∞—Ä—Ç–∞ —Ç–∏–ø–æ–≤ —Å–æ–±—ã—Ç–∏–π ===
    const typesMap = {
        'tap': 0, 'open_screen': 1, 'condition': 2, 'event': 3,
        'authorization': 4, 'tabbar': 5, 'deeplink': 6, 'tech': 7,
        'error': 8, 'open_error': 9, 'open_error_screen': 10,
        'errorMetric': 11, 'offline_tap': 12
    };

    // === –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ "–ü–æ–∏—Å–∫ –æ—à–∏–±–æ–∫" ===
    errorSearchButton.addEventListener('click', async () => {
        saveState();

        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ –≤–∫–ª–∞–¥–∫–∞
        let tab;
        try {
            tab = await chrome.tabs.get(currentTabId);
            if (!tab || !tab.url.includes('appmetrica.yandex.ru')) {
                alert('–í–∫–ª–∞–¥–∫–∞ AppMetrica –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ –∏–ª–∏ –∑–∞–∫—Ä—ã—Ç–∞');
                return;
            }
        } catch (err) {
            console.error('SFUA: –í–∫–ª–∞–¥–∫–∞ –Ω–µ –¥–æ—Å—Ç—É–ø–Ω–∞:', err);
            alert('–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –≤–∫–ª–∞–¥–∫–µ');
            return;
        }

        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∑–∞–≥—Ä—É–∂–µ–Ω –ª–∏ iframe
        let iframeReady = false;
        try {
            const result = await chrome.scripting.executeScript({
                target: { tabId: currentTabId },
                func: () => {
                    const iframe = document.querySelector('iframe.iframe-integration__iframe');
                    return !!iframe && !!iframe.contentDocument?.body;
                }
            });
            iframeReady = result[0]?.result;
        } catch (e) {
            console.warn('SFUA: –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ iframe:', e);
        }

        if (!iframeReady) {
            const retry = confirm('AppMetrica –µ—â—ë –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω–∞. –ü–æ–¥–æ–∂–¥–∞—Ç—å –∏ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–Ω–æ–≤–∞?');
            if (retry) {
                errorSearchButton.disabled = true;
                errorSearchButton.textContent = '–û–∂–∏–¥–∞–Ω–∏–µ...';
                setTimeout(() => {
                    errorSearchButton.disabled = false;
                    errorSearchButton.textContent = '–û—à–∏–±–∫–∏';
                    // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –Ω–∞–∂–∞—Ç—å —Å–Ω–æ–≤–∞
                }, 3000);
            }
            return;
        }

        // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–ª–∞–≥
        chrome.storage.local.set({ [ERROR_SEARCH_DONE_KEY]: true }, () => {
            if (chrome.runtime.lastError) {
                console.warn('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ–∏—Å–∫–∞ –æ—à–∏–±–æ–∫:', chrome.runtime.lastError);
            } else {
                console.log('‚úÖ –ü–æ–∏—Å–∫ –æ—à–∏–±–æ–∫ –ø–æ–º–µ—á–µ–Ω –∫–∞–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–π');
            }
            disableErrorSearchButton();
        });

        // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å
        try {
            await chrome.runtime.sendMessage({
                action: "executeStartErrorSearch",
                tabId: currentTabId
            });
            console.log('‚úÖ –°–æ–æ–±—â–µ–Ω–∏–µ "executeStartErrorSearch" –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ');
            window.close();
        } catch (err) {
            console.error('SFUA: –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è:', err);
            alert('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø–æ–∏—Å–∫ –æ—à–∏–±–æ–∫. –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.');
        }
    });

    // === –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ "–ù–∞—á–∞—Ç—å –ø–æ–∏—Å–∫" ===
    async function startSearch(eventType, key, value) {
        saveState();

        // –ë–ª–æ–∫–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É
        searchButton.disabled = true;
        const originalText = searchButton.textContent;
        searchButton.textContent = '–ò–¥—ë—Ç –ø–æ–∏—Å–∫‚Ä¶';
        searchButton.title = '–ò–¥—ë—Ç –ø–æ–∏—Å–∫. –ß—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –Ω–æ–≤—ã–π, –Ω—É–∂–Ω–æ –¥–æ–∂–¥–∞—Ç—å—Å—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∏–ª–∏ –æ–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É';

        // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–ª–∞–≥, —á—Ç–æ –ø–æ–∏—Å–∫ –∏–¥—ë—Ç
        chrome.storage.local.set({ [SEARCH_IN_PROGRESS_KEY]: true }, () => {
            if (chrome.runtime.lastError) {
                console.warn('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ–∏—Å–∫–∞:', chrome.runtime.lastError);
            }
        });

        // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ñ–ª–∞–≥–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
        try {
            await chrome.runtime.sendMessage({
                action: "resetParamCheckFlags",
                tabId: currentTabId
            });
        } catch (err) {
            console.warn("SFUA: –ù–µ —É–¥–∞–ª–æ—Å—å —Å–±—Ä–æ—Å–∏—Ç—å —Ñ–ª–∞–≥–∏", err);
        }

        // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å –Ω–∞ –∑–∞–ø—É—Å–∫ –ø–æ–∏—Å–∫–∞
        try {
            const response = await chrome.runtime.sendMessage({
                action: "startSearch",
                eventType: eventType,
                key: key,
                value: value,
                tabId: currentTabId
            });

            if (response && !response.success) {
                throw new Error(response.error);
            }

            // –ß–µ—Ä–µ–∑ 1 —Å–µ–∫ —Ä–∞–∑–±–ª–æ–∫–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É
            setTimeout(() => {
                if (searchButton.disabled) {
                    searchButton.disabled = false;
                    searchButton.textContent = originalText;
                    searchButton.title = '–ü–æ–∏—Å–∫ —Å–æ–±—ã—Ç–∏–π –ø–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—é –∫–ª—é—á:–∑–Ω–∞—á–µ–Ω–∏–µ –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥';
                }
                // –£–¥–∞–ª—è–µ–º —Ñ–ª–∞–≥
                chrome.storage.local.remove(SEARCH_IN_PROGRESS_KEY);
            }, 1000);

            window.close();

        } catch (error) {
            console.error('SFUA: –û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ø–æ–∏—Å–∫–∞:', error);
            setTimeout(() => {
                if (searchButton.disabled) {
                    searchButton.disabled = false;
                    searchButton.textContent = originalText;
                    searchButton.title = '–ü–æ–∏—Å–∫ —Å–æ–±—ã—Ç–∏–π –ø–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—é –∫–ª—é—á:–∑–Ω–∞—á–µ–Ω–∏–µ –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥';
                }
                chrome.storage.local.remove(SEARCH_IN_PROGRESS_KEY);
            }, 3000);
        }
    }

    searchButton.addEventListener('click', () => {
        const activeType = document.querySelector('.event_type.active');
        if (!activeType) return;
        const typeName = activeType.textContent.trim();
        const eventType = typesMap[typeName] ?? 0;
        startSearch(eventType, paramKey.value, paramValue.value);
    });

// === –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ FAQ ===
const faqButton = document.querySelector('.faq_button');
if (faqButton) {
    faqButton.addEventListener('click', () => {
        console.log('[Popup] –û—Ç–∫—Ä—ã–≤–∞–µ–º FAQ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ');
        chrome.runtime.sendMessage({
            action: "showHowToUse"
        });
        window.close();
    });
}

function injectHowToUse() {
    const script = document.createElement('script');
    script.src = chrome.runtime.getURL('how_to_use.js');
    script.onload = () => script.remove();
    (document.head || document.documentElement).appendChild(script);
}

    // === –ì–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏: Ctrl+Enter ===
    function handleCtrlEnter(e) {
        if (e.key === 'Enter' && (e.ctrlKey || e.metaKey)) {
            e.preventDefault();
            const activeType = document.querySelector('.event_type.active');
            if (!activeType) return;
            const typeName = activeType.textContent.trim();
            const eventType = typesMap[typeName] ?? 0;
            startSearch(eventType, paramKey.value, paramValue.value);
        }
    }

    paramKey.addEventListener('keydown', handleCtrlEnter);
    paramValue.addEventListener('keydown', handleCtrlEnter);

    // === –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ ===
    checkErrorSearchState();

    // === –°–ª–µ–¥–∏–º –∑–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º –≤–∫–ª–∞–¥–∫–∏ ===
    chrome.tabs.onUpdated.addListener((tabId, changeInfo, tab) => {
        if (tabId === currentTabId && changeInfo.status === 'complete' && tab.url.includes('appmetrica.yandex.ru')) {
            console.log('[Popup] –í–∫–ª–∞–¥–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞ ‚Äî –ø—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ–∏—Å–∫–∞ –æ—à–∏–±–æ–∫');
            checkErrorSearchState();
        }
    });

    // === –°–ª–µ–¥–∏–º –∑–∞ –∞–∫—Ç–∏–≤–∞—Ü–∏–µ–π –≤–∫–ª–∞–¥–∫–∏ ===
    chrome.tabs.onActivated.addListener(async (activeInfo) => {
        if (activeInfo.tabId === currentTabId) {
            try {
                const tab = await chrome.tabs.get(currentTabId);
                if (tab.url?.includes('appmetrica.yandex.ru')) {
                    console.log('[Popup] –í–∫–ª–∞–¥–∫–∞ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–∞ ‚Äî –ø—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ');
                    checkErrorSearchState();
                }
            } catch (e) {
                console.warn('–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –≤–∫–ª–∞–¥–∫—É:', e);
            }
        }
    });
});


content/sync_manual_clicks.js:
--------------------------------------------------
// sync_manual_clicks.js

(function () {
    console.log('SFUA: sync_manual_clicks.js ‚Äî –∑–∞–ø—É—â–µ–Ω');

    // === –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–æ–≤ –ø–æ span.link__inner ===
    document.addEventListener('click', function (e) {
        const target = e.target;

        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —ç—Ç–æ span —Å –∫–ª–∞—Å—Å–æ–º link__inner
        if (target.classList.contains('link__inner')) {
            e.preventDefault();
            e.stopPropagation();

            // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º –∫–ª–∞—Å—Å span_checked
            if (target.classList.contains('span_checked')) {
                target.classList.remove('span_checked');
            } else {
                target.classList.add('span_checked');
            }

            // üîî –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: –º–æ–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–±—ã—Ç–∏–µ –¥–ª—è –¥—Ä—É–≥–∏—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤
            // –ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –¥—Ä—É–≥–∏–µ —Å–∫—Ä–∏–ø—Ç—ã –¥–æ–ª–∂–Ω—ã —Ä–µ–∞–≥–∏—Ä–æ–≤–∞—Ç—å
            target.dispatchEvent(new CustomEvent('sfua:spanToggled', {
                bubbles: true,
                detail: { checked: target.classList.contains('span_checked') }
            }));
        }
    });
    const observer = new MutationObserver(() => {
        // –ú–æ–∂–Ω–æ –ø–µ—Ä–µ–Ω–∞–∑–Ω–∞—á–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏, –µ—Å–ª–∏ —ç–ª–µ–º–µ–Ω—Ç—ã –ø–æ–¥–≥—Ä—É–∂–∞—é—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏
        // –ù–æ –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ ‚Äî –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ document
    });

    observer.observe(document.body, {
        childList: true,
        subtree: true
    });

    console.log('SFUA: –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–æ–≤ –ø–æ link__inner –∞–∫—Ç–∏–≤–µ–Ω');
})();


content/showcurrent.js:
--------------------------------------------------
// content/showcurrent.js

if (!window.__SFUA_SHOWCURRENT_LOADED__) {
    window.__SFUA_SHOWCURRENT_LOADED__ = true;

    console.log('SFUA ShowCurrent –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω (v3.3)');

    window.__SFUA__ = window.__SFUA__ || {};
    window.__SFUA__.globalSessionCounter = window.__SFUA__.globalSessionCounter || 0;
    window.__SFUA__.observer = null;

    const mainStyles = `
        [class^="btn_current_"] {
            color: #04b;
            cursor: pointer;
            font-size: 12px;
            margin-left: 10px;
            display: inline-block;
        }
        [class^="btn_current_"]:hover { opacity: 0.8; }
        [class^="btn_current_"][data-state="loading"] {
            color: #555;
            cursor: default;
            pointer-events: none;
        }
        [class^="btn_current_"][data-state="done"] {
            color: #0a0;
            cursor: default;
        }
    `;

    const ALLOWED_ELEMENTS = new Set([
        'tap', 'condition', 'open_screen', 'event', 'tabbar', 'authorization',
        'offline_tap', 'offline_open_screen', 'errorMetric', 'error', 'Deeplink',
        'tech', 'push', 'open_error_screen', 'deeplink'
    ]);

    function checkHasAnyClickable(sessionElement) {
        const buttons = sessionElement.querySelectorAll('span.link__inner');
        for (const btn of buttons) {
            const text = btn.textContent.trim();
            if (
                /^(–í—Å–µ \d+ —Å–æ–±—ã—Ç–∏[—è–µ–π]|–í—Å–µ \d+)$/.test(text) ||
                /^\+\d+$/.test(text) ||
                ALLOWED_ELEMENTS.has(text)
            ) {
                return true;
            }
        }
        return false;
    }

    function addStyles(doc) {
        if (doc.querySelector('link[data-sfua-showcurrent]')) return;

        const link = doc.createElement('link');
        link.rel = 'stylesheet';
        link.href = chrome.runtime.getURL('content/styles/showcurrent.css');
        link.setAttribute('data-sfua-showcurrent', 'true');

        link.onerror = () => console.error('SFUA SHOWCURRENT: –ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å CSS');
        link.onload = () => console.log('SFUA SHOWCURRENT: –°—Ç–∏–ª–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã');

        doc.head.appendChild(link);
    }

    function processSessionElements(doc, isNew = false) {
        const selector = 'div.profile-session_js_inited:not([class*="current_parent_"])';
        const sessionElements = doc.querySelectorAll(selector);

        console.log(`SFUA SHOWCURRENT: –ù–∞–π–¥–µ–Ω–æ ${sessionElements.length} —Å–µ—Å—Å–∏–π`);

        if (sessionElements.length === 0) return;

        let itemsProcessed = 0;
        sessionElements.forEach(element => {
            const className = `current_parent_${window.__SFUA__.globalSessionCounter}`;
            element.classList.add(className);

            const dateElement = element.querySelector('div.profile-session__date');
            if (!dateElement) {
                window.__SFUA__.globalSessionCounter++;
                return;
            }

            const hasAnyClickable = checkHasAnyClickable(element);

            if (hasAnyClickable) {
                if (!dateElement.nextElementSibling?.classList?.contains(`btn_current_${window.__SFUA__.globalSessionCounter}`)) {
                    const button = doc.createElement('div');
                    button.className = `btn_current_${window.__SFUA__.globalSessionCounter}`;
                    button.textContent = "–†–∞–∑–≤–µ—Ä–Ω—É—Ç—å —Å–æ–±—ã—Ç–∏—è —Å–µ—Å—Å–∏–∏";
                    button.addEventListener('click', handleButtonClick);
                    dateElement.insertAdjacentElement('afterend', button);
                    itemsProcessed++;
                }
            } else {
                const nextEl = dateElement.nextElementSibling;
                if (!nextEl || !nextEl.classList?.contains('sfua_no_events_placeholder')) {
                    if (nextEl && nextEl.classList?.contains('sfua_no_events_placeholder')) {
                        nextEl.remove();
                    }
                    const placeholder = doc.createElement('div');
                    placeholder.className = 'sfua_no_events_placeholder';
                    placeholder.textContent = "–°–æ–±—ã—Ç–∏—è –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç";
                    placeholder.style.cssText = 'display: inline-block; font-size: 12px; color: #a0aec0; margin-left: 10px; user-select: none;';
                    dateElement.insertAdjacentElement('afterend', placeholder);
                    itemsProcessed++;
                }
            }

            window.__SFUA__.globalSessionCounter++;
        });

        console.log(`SFUA SHOWCURRENT: –û–±—Ä–∞–±–æ—Ç–∞–Ω–æ —Å–µ—Å—Å–∏–π: ${itemsProcessed}`);
    }

    function setupMutationObserver(doc) {
        if (window.__SFUA__.observer) {
            window.__SFUA__.observer.disconnect();
        }

        window.__SFUA__.observer = new MutationObserver(mutations => {
            mutations.forEach(mutation => {
                if (mutation.addedNodes.length) {
                    processSessionElements(doc, true);
                }
            });
        });

        window.__SFUA__.observer.observe(doc.body, {
            childList: true,
            subtree: true
        });
    }

    function delay(ms) {
        return new Promise(resolve => setTimeout(resolve, ms));
    }

    // === –ï–î–ò–ù–´–ô –ú–ï–¢–û–î –ö–õ–ò–ö–ê –° –î–û–ë–ê–í–õ–ï–ù–ò–ï–ú –ö–õ–ê–°–°–ê ===
    function simulateClickWithCheck(element) {
        if (!element || element.classList.contains('span_checked')) {
            return;
        }

        // 1. –ö–ª–∏–∫–∞–µ–º
        element.click();

        // 2. –î–æ–±–∞–≤–ª—è–µ–º –∫–ª–∞—Å—Å ‚Äî –∫–∞–∫ –ø—Ä–∏ —Ä—É—á–Ω–æ–º –∫–ª–∏–∫–µ
        element.classList.add('span_checked');

        // 3. –ú–æ–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–±—ã—Ç–∏–µ
        element.dispatchEvent(new CustomEvent('sfua:spanToggled', {
            bubbles: true,
            detail: { checked: true }
        }));
    }

    async function handleButtonClick(event) {
        event.preventDefault();
        event.stopPropagation();

        const button = event.currentTarget;
        const currentState = button.getAttribute('data-state');
        if (currentState === 'loading' || currentState === 'done') return;

        console.log(`SFUA SHOWCURRENT: –ù–∞–∂–∞—Ç–∞ –∫–Ω–æ–ø–∫–∞ ${button.className}`);
        button.setAttribute('data-state', 'loading');
        button.textContent = "–ó–∞–≥—Ä—É–∑–∫–∞...";

        try {
            const sessionIndex = parseInt(button.className.split('_').pop());
            const parent = button.ownerDocument.querySelector(`.current_parent_${sessionIndex}`);
            if (!parent) throw new Error('Parent not found');

            // 1. "–í—Å–µ N —Å–æ–±—ã—Ç–∏–π"
            const allEventsButtons = [...parent.querySelectorAll('span.link__inner')]
            .filter(btn => 
                /^(–í—Å–µ \d+ —Å–æ–±—ã—Ç–∏[—è–µ–π]|–í—Å–µ \d+)$/.test(btn.textContent.trim()) &&
                !btn.classList.contains('span_checked')
            );
            console.log(`"–í—Å–µ N": ${allEventsButtons.length}`);
            for (const btn of allEventsButtons) {
                simulateClickWithCheck(btn);
                console.log(`–ö–ª–∏–∫ –ø–æ "${btn.textContent.trim()}"`);
                await delay(2000);
            }

            // 2. "+N"
            const plusButtons = [...parent.querySelectorAll('span.link__inner')]
                .filter(btn => 
                    /^\+\d+$/.test(btn.textContent.trim()) &&
                    !btn.classList.contains('span_checked')
                );
            console.log(`"+N": ${plusButtons.length}`);
            for (const btn of plusButtons) {
                simulateClickWithCheck(btn);
                console.log(`–ö–ª–∏–∫ –ø–æ "${btn.textContent.trim()}"`);
                await delay(300 + Math.random() * 200);
            }

            if (plusButtons.length) await delay(1000);

            // 3. ALLOWED_ELEMENTS
            const otherButtons = [...parent.querySelectorAll('span.link__inner')]
                .filter(btn => 
                    ALLOWED_ELEMENTS.has(btn.textContent.trim()) &&
                    !btn.classList.contains('span_checked')
                );
            console.log(`–†–∞–∑—Ä–µ—à—ë–Ω–Ω—ã–µ: ${otherButtons.length}`);
            for (const btn of otherButtons) {
                simulateClickWithCheck(btn);
                console.log(`–ö–ª–∏–∫ –ø–æ "${btn.textContent.trim()}"`);
                await delay(300 + Math.random() * 200);
            }

            button.setAttribute('data-state', 'done');
            button.textContent = "–°–æ–±—ã—Ç–∏—è –∑–∞–≥—Ä—É–∂–µ–Ω—ã";

        } catch (error) {
            console.error('SFUA Error:', error);
            button.textContent = "–û—à–∏–±–∫–∞!";
            button.removeAttribute('data-state');
        }
    }

    function initForDocument(doc) {
        addStyles(doc);
        processSessionElements(doc);
        setupMutationObserver(doc);

        setTimeout(() => processSessionElements(doc, true), 3000);
    }

    function initialize() {
        initForDocument(document);

        window.addEventListener('unload', () => {
            if (window.__SFUA__.observer) window.__SFUA__.observer.disconnect();
        });
    }

    if (document.readyState === 'complete' || document.readyState === 'interactive') {
        setTimeout(initialize, 0);
    } else {
        document.addEventListener('DOMContentLoaded', initialize);
        window.addEventListener('load', initialize);
    }
} else {
    console.log('SFUA SHOWCURRENT: –£–∂–µ –∑–∞–≥—Ä—É–∂–µ–Ω');
}


content/usertimezone.js:
--------------------------------------------------
// content/usertimezone.js

(function () {
    // –ó–∞—â–∏—Ç–∞ –æ—Ç –¥–≤–æ–π–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
    if (window.sfua_usertimezone_loaded) {
        console.log('[SFUA TIMEZONE] –£–∂–µ –∑–∞–≥—Ä—É–∂–µ–Ω ‚Äî –ø—Ä–æ–ø—É—Å–∫–∞–µ–º');
        return;
    }
    window.sfua_usertimezone_loaded = true;

    const CONFIG = {
        logPrefix: '[SFUA TIMEZONE]',
        checkInterval: 200,
        maxRetries: 50,
        animationDuration: 700, // 0.7s
        animationEasing: 'cubic-bezier(0.4, 0, 0.2, 1)'
    };

    let timezoneOffset = null;
    let isInitialized = false;
    let observer = null;
    let interval = null;

    async function initTimezoneHandler() {
        if (isInitialized) {
            console.log(`${CONFIG.logPrefix} –£–∂–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω ‚Äî –ø—Ä–æ–ø—É—Å–∫–∞–µ–º`);
            return;
        }

        console.log(`${CONFIG.logPrefix} –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è`);

        try {
            // ‚úÖ –ò—â–µ–º .userinfo_timezone –í–û –í–°–ï–ú –¥–æ–∫—É–º–µ–Ω—Ç–µ (–≤–∫–ª—é—á–∞—è iframe –∏ —Ä–æ–¥–∏—Ç–µ–ª—å)
            timezoneOffset = await findTimezoneOffset();
            if (timezoneOffset === null) {
                console.error(`${CONFIG.logPrefix} –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å —á–∞—Å–æ–≤–æ–π –ø–æ—è—Å`);
                return;
            }

            console.log(`${CONFIG.logPrefix} –ù–∞–π–¥–µ–Ω–∞ —Ä–∞–∑–Ω–∏—Ü–∞ –≤ —á–∞—Å–æ–≤–æ–º –ø–æ—è—Å–µ: ${timezoneOffset} –æ—Ç –ú–°–ö`);

            // ‚úÖ –ù–∞—á–∏–Ω–∞–µ–º –æ–±—Ä–∞–±–æ—Ç–∫—É
            processExistingDates();
            setupObservation();

            isInitialized = true;

        } catch (error) {
            console.error(`${CONFIG.logPrefix} –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏:`, error);
        }
    }

    // ‚úÖ –ò—â–µ–º .userinfo_timezone –≤–µ–∑–¥–µ: –≤ iframe –∏ –≤ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–º –¥–æ–∫—É–º–µ–Ω—Ç–µ
    function findTimezoneOffset() {
        return new Promise((resolve) => {
            let retries = 0;

            const tryFind = () => {
                if (isInitialized) {
                    resolve(null);
                    return;
                }

                // 1. –ò—â–µ–º –≤ iframe
                const iframe = document.querySelector('iframe.iframe-integration__iframe');
                if (iframe && iframe.contentDocument) {
                    const el = iframe.contentDocument.querySelector('.userinfo_timezone');
                    if (el) {
                        const offset = parseTimezone(el.textContent);
                        if (offset !== null) {
                            resolve(offset);
                            return;
                        }
                    }
                }

                // 2. –ò—â–µ–º –≤ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–º –¥–æ–∫—É–º–µ–Ω—Ç–µ
                const elInParent = document.querySelector('.userinfo_timezone');
                if (elInParent) {
                    const offset = parseTimezone(elInParent.textContent);
                    if (offset !== null) {
                        resolve(offset);
                        return;
                    }
                }

                // 3. –ü–æ–≤—Ç–æ—Ä—è–µ–º
                if (retries++ < CONFIG.maxRetries) {
                    setTimeout(tryFind, CONFIG.checkInterval);
                } else {
                    console.warn(`${CONFIG.logPrefix} –≠–ª–µ–º–µ–Ω—Ç .userinfo_timezone –Ω–∏–≥–¥–µ –Ω–µ –Ω–∞–π–¥–µ–Ω`);
                    resolve(null);
                }
            };

            tryFind();
        });
    }

    function parseTimezone(text) {
        if (!text) return null;
        const cleaned = text.trim();
        const sign = cleaned.includes('-') ? -1 : 1;
        const numbers = cleaned.replace(/\D/g, '');
        const value = parseInt(numbers);
        return isNaN(value) ? null : sign * value;
    }

    function processExistingDates() {
        const dateElements = document.querySelectorAll('.profile-session__date');
        console.log(`${CONFIG.logPrefix} –ù–∞–π–¥–µ–Ω–æ ${dateElements.length} —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Å –¥–∞—Ç–æ–π/–≤—Ä–µ–º–µ–Ω–µ–º —Å–µ—Å—Å–∏–∏`);
        dateElements.forEach(el => {
            if (!el.querySelector('.user_sessiontime')) {
                updateDateElement(el);
            }
        });
    }

    function updateDateElement(element) {
        if (element.dataset.timezoneProcessed) return;
        const originalText = element.textContent.trim();
        if (!originalText.includes(' –≤ ')) return;

        try {
            const adjustedTime = adjustTime(originalText);
            const span = document.createElement('span');
            span.className = 'user_sessiontime';
            span.textContent = ` (${adjustedTime})`;
            span.title = '–í—Ä–µ–º—è —Å–µ—Å—Å–∏–∏ –≤ —á–∞—Å–æ–≤–æ–º –ø–æ—è—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è';

            // === –°—Ç–∏–ª–∏ –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏ —Å–ø—Ä–∞–≤–∞ –Ω–∞–ª–µ–≤–æ ===
            span.style.cssText = `
                font-size: 18px;
                font-weight: 700;
                color: rgba(0, 0, 0, .35);
                margin-left: 4px;
                cursor: default;
                display: inline-block;
                transform: scale(0);
                transform-origin: right center; /* –ö–ª—é—á: –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ø—Ä–∞–≤–∞ */
                transition: transform ${CONFIG.animationDuration}ms ${CONFIG.animationEasing};
            `;

            element.appendChild(span);
            element.dataset.timezoneProcessed = 'true';
            console.log(`${CONFIG.logPrefix} –î–æ–±–∞–≤–ª–µ–Ω–æ –≤—Ä–µ–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: ${adjustedTime}`);

            // === –ê–ù–ò–ú–ê–¶–ò–Ø: scale(0) ‚Üí scale(1) ===
            requestAnimationFrame(() => {
                setTimeout(() => {
                    span.style.transform = 'scale(1)';
                }, 10);
            });

        } catch (e) {
            console.error(`${CONFIG.logPrefix} –û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞—Ç—ã:`, e);
        }
    }

    function adjustTime(dateString) {
        const MONTHS = {
            '–Ø–Ω–≤–∞—Ä—è': 0, '–§–µ–≤—Ä–∞–ª—è': 1, '–ú–∞—Ä—Ç–∞': 2, '–ê–ø—Ä–µ–ª—è': 3,
            '–ú–∞—è': 4, '–ò—é–Ω—è': 5, '–ò—é–ª—è': 6, '–ê–≤–≥—É—Å—Ç–∞': 7,
            '–°–µ–Ω—Ç—è–±—Ä—è': 8, '–û–∫—Ç—è–±—Ä—è': 9, '–ù–æ—è–±—Ä—è': 10, '–î–µ–∫–∞–±—Ä—è': 11
        };

        const [datePart, timePart] = dateString.split(' –≤ ');
        const [hours, minutes] = timePart.split(':').map(Number);
        const now = new Date();
        let date = new Date();

        if (datePart === '–°–µ–≥–æ–¥–Ω—è') {
            // –æ—Å—Ç–∞–≤–ª—è–µ–º —Ç–µ–∫—É—â—É—é –¥–∞—Ç—É
        } else if (datePart === '–í—á–µ—Ä–∞') {
            date.setDate(date.getDate() - 1);
        } else {
            const [day, monthName] = datePart.split(' ');
            date.setMonth(MONTHS[monthName], parseInt(day));
            date.setFullYear(now.getFullYear());
        }

        date.setHours(hours, minutes, 0, 0);
        const adjustedDate = new Date(date.getTime() + timezoneOffset * 3600000);
        return `${adjustedDate.getHours().toString().padStart(2, '0')}:${adjustedDate.getMinutes().toString().padStart(2, '0')}`;
    }

    function setupObservation() {
        if (observer) observer.disconnect();
        if (interval) clearInterval(interval);

        observer = new MutationObserver((mutations) => {
            mutations.forEach((mutation) => {
                mutation.addedNodes.forEach((node) => {
                    if (node.nodeType === Node.ELEMENT_NODE) {
                        if (node.matches('.profile-session__date')) {
                            updateDateElement(node);
                        }
                        node.querySelectorAll('.profile-session__date').forEach(updateDateElement);
                    }
                });
            });
        });

        observer.observe(document.body, {
            childList: true,
            subtree: true
        });

        interval = setInterval(() => {
            if (isInitialized) {
                const newElements = document.querySelectorAll('.profile-session__date:not([data-timezone-processed])');
                if (newElements.length > 0) {
                    console.log(`${CONFIG.logPrefix} –ù–∞–π–¥–µ–Ω–æ ${newElements.length} –Ω–æ–≤—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤`);
                    newElements.forEach(updateDateElement);
                }
            }
        }, CONFIG.checkInterval);

        console.log(`${CONFIG.logPrefix} –ù–∞–±–ª—é–¥–µ–Ω–∏–µ –∑–∞ DOM –∑–∞–ø—É—â–µ–Ω–æ`);
    }

    function start() {
        if (document.readyState === 'complete') {
            initTimezoneHandler();
        } else {
            document.addEventListener('DOMContentLoaded', initTimezoneHandler);
        }

        // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
        setTimeout(() => {
            if (!isInitialized && !document.querySelector('.user_sessiontime')) {
                console.log(`${CONFIG.logPrefix} –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞`);
                initTimezoneHandler();
            }
        }, 3000);
    }

    start();

})();


content/scrolltotop.js:
--------------------------------------------------
// content/scrolltotop.js

(function () {
    console.log("ScrollToTop: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è");

    // === –ü–∞—Ä–∞–º–µ—Ç—Ä—ã ===
    const SHOW_THRESHOLD = 300;  // –ü–æ–∫–∞–∑–∞—Ç—å –ø—Ä–∏ –ø—Ä–æ–∫—Ä—É—Ç–∫–µ >300px
    const HIDE_THRESHOLD = 500;  // –°–∫—Ä—ã—Ç—å –ø—Ä–∏ –ø—Ä–æ–∫—Ä—É—Ç–∫–µ <500px
    const ANIMATION_DURATION = 1500; // 1.5 —Å–µ–∫

    // === –°–æ–∑–¥–∞—ë–º –∫–Ω–æ–ø–∫—É ===
    const button = document.createElement('button');
    button.className = 'sfua_scroll_to_top';
    button.style.cssText = `
        position: fixed;
        bottom: -100px;
        right: -100px;
        width: 40px;
        height: 40px;
        border: none;
        border-radius: 20%;
        background-color: #edf2f7;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        cursor: pointer;
        z-index: 10000;
        opacity: 0;
        transform: scale(0);
        transition: all 0.4s ease;
        display: flex;
        align-items: center;
        justify-content: center;
    `;

    // SVG —Å—Ç—Ä–µ–ª–∫–∞ –≤–≤–µ—Ä—Ö (—Å–µ—Ä–∞—è)
    const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
    svg.setAttribute('width', '32');
    svg.setAttribute('height', '32');
    svg.setAttribute('viewBox', '0 0 24 24');
    svg.setAttribute('fill', 'none');
    svg.setAttribute('stroke', '#4a5568');
    svg.setAttribute('stroke-width', '2');
    svg.setAttribute('stroke-linecap', 'round');
    svg.setAttribute('stroke-linejoin', 'round');

    const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
    line.setAttribute('x1', '12');
    line.setAttribute('y1', '19');
    line.setAttribute('x2', '12');
    line.setAttribute('y2', '5');

    const polyline = document.createElementNS('http://www.w3.org/2000/svg', 'polyline');
    polyline.setAttribute('points', '5 12 12 5 19 12');

    svg.appendChild(line);
    svg.appendChild(polyline);
    button.appendChild(svg);

    // –î–æ–±–∞–≤–ª—è–µ–º –≤ body
    document.body.appendChild(button);

    // === –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–∏–¥–∏–º–æ—Å—Ç—å—é ===
    let isVisible = false;

    function updateButton() {
        const scrollTop = window.pageYOffset || document.documentElement.scrollTop;

        if (scrollTop >= SHOW_THRESHOLD && !isVisible) {
            // –ü–æ–∫–∞–∑–∞—Ç—å —Å –∞–Ω–∏–º–∞—Ü–∏–µ–π
            button.style.bottom = '60px';
            button.style.right = '100px';
            button.style.opacity = '1';
            button.style.transform = 'scale(1)';
            isVisible = true;
        } else if (scrollTop < HIDE_THRESHOLD && isVisible) {
            // –°–∫—Ä—ã—Ç—å —Å –∞–Ω–∏–º–∞—Ü–∏–µ–π
            button.style.opacity = '0';
            button.style.transform = 'scale(0)';
            setTimeout(() => {
                if (!isVisible) {
                    button.style.bottom = '-100px';
                    button.style.right = '-100px';
                }
            }, ANIMATION_DURATION);
            isVisible = false;
        }
    }

    // === –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ –Ω–∞–≤–µ—Ä—Ö ===
    button.addEventListener('click', () => {
        window.scrollTo({
            top: 0,
            behavior: 'smooth'
        });
    });

    // === –°–ª—É—à–∞–µ–º –ø—Ä–æ–∫—Ä—É—Ç–∫—É ===
    window.addEventListener('scroll', () => {
        requestAnimationFrame(updateButton);
    });

    // === –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è ===
    updateButton();

    console.log("ScrollToTop: –ì–æ—Ç–æ–≤");
})();


content/styles/showcurrent.css:
--------------------------------------------------
[class^="btn_current_"] {
    color: #04b;
    cursor: pointer;
    font-size: 12px;
    margin-left: 10px;
    display: inline-block;
}

[class^="btn_current_"]:hover {
    opacity: 0.8;
}

[class^="btn_current_"][data-state="loading"]
{
    color: #555;
    cursor: default;
    pointer-events: none;
    opacity: 1;
}
[class^="btn_current_"][data-state="done"] {
    color: #0a0;
    cursor: default;
    pointer-events: none;
    opacity: 1;
}


icons/icon48.png:
--------------------------------------------------
PNG

   
IHDR   0   0   W   	pHYs  .#  .#x?v  
iTXtXML:com.adobe.xmp     <?xpacket begin="Ôªø" id="W5M0MpCehiHzreSzNTczkc9d"?> <x:xmpmeta xmlns:x="adobe:ns:meta/" x:xmptk="Adobe XMP Core 6.0-c003 116.ddc7bc4, 2021/08/17-13:18:37        "> <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"> <rdf:Description rdf:about="" xmlns:xmp="http://ns.adobe.com/xap/1.0/" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xmpMM="http://ns.adobe.com/xap/1.0/mm/" xmlns:stEvt="http://ns.adobe.com/xap/1.0/sType/ResourceEvent#" xmlns:stRef="http://ns.adobe.com/xap/1.0/sType/ResourceRef#" xmlns:photoshop="http://ns.adobe.com/photoshop/1.0/" xmlns:tiff="http://ns.adobe.com/tiff/1.0/" xmlns:exif="http://ns.adobe.com/exif/1.0/" xmp:CreatorTool="Adobe Photoshop 21.2 (Windows)" xmp:CreateDate="2025-05-27T20:00:26+04:00" xmp:MetadataDate="2025-05-29T08:48:09+04:00" xmp:ModifyDate="2025-05-29T08:48:09+04:00" dc:format="image/png" xmpMM:InstanceID="xmp.iid:a25492f0-cef9-104d-871f-6ac9d48de367" xmpMM:DocumentID="adobe:docid:photoshop:ab53913c-b985-e94c-86f5-d1ed83954569" xmpMM:OriginalDocumentID="xmp.did:a90bc5b9-7cea-af49-a9ed-f1346aff474b" photoshop:ColorMode="3" photoshop:ICCProfile="sRGB IEC61966-2.1" tiff:Orientation="1" tiff:XResolution="3000000/10000" tiff:YResolution="3000000/10000" tiff:ResolutionUnit="2" exif:ColorSpace="65535" exif:PixelXDimension="231" exif:PixelYDimension="231"> <xmpMM:History> <rdf:Seq> <rdf:li stEvt:action="created" stEvt:instanceID="xmp.iid:a90bc5b9-7cea-af49-a9ed-f1346aff474b" stEvt:when="2025-05-27T20:00:26+04:00" stEvt:softwareAgent="Adobe Photoshop 21.2 (Windows)"/> <rdf:li stEvt:action="saved" stEvt:instanceID="xmp.iid:ccc09a5f-f29a-3744-a216-64cd058a4f66" stEvt:when="2025-05-29T08:47:26+04:00" stEvt:softwareAgent="Adobe Photoshop 21.2 (Windows)" stEvt:changed="/"/> <rdf:li stEvt:action="saved" stEvt:instanceID="xmp.iid:48189c3c-7194-6841-a888-78a35e7acfff" stEvt:when="2025-05-29T08:48:09+04:00" stEvt:softwareAgent="Adobe Photoshop 21.2 (Windows)" stEvt:changed="/"/> <rdf:li stEvt:action="converted" stEvt:parameters="from application/vnd.adobe.photoshop to image/png"/> <rdf:li stEvt:action="derived" stEvt:parameters="converted from application/vnd.adobe.photoshop to image/png"/> <rdf:li stEvt:action="saved" stEvt:instanceID="xmp.iid:a25492f0-cef9-104d-871f-6ac9d48de367" stEvt:when="2025-05-29T08:48:09+04:00" stEvt:softwareAgent="Adobe Photoshop 21.2 (Windows)" stEvt:changed="/"/> </rdf:Seq> </xmpMM:History> <xmpMM:DerivedFrom stRef:instanceID="xmp.iid:48189c3c-7194-6841-a888-78a35e7acfff" stRef:documentID="xmp.did:a90bc5b9-7cea-af49-a9ed-f1346aff474b" stRef:originalDocumentID="xmp.did:a90bc5b9-7cea-af49-a9ed-f1346aff474b"/> </rdf:Description> </rdf:RDF> </x:xmpmeta> <?xpacket end="r"?>(G  ^IDATh≈ôm\Uœπ/3vv]ZJH%$AT0@
ƒ®1HIK-j I}E!nwk]:n;;l[I&>s(+“úDEA[mP& *>@^D({sxWvT|c ô*kﬁ≠wDN…≤1C)J∆àlW>hK/≈∂÷¶h#xDNJ
Q”∂x=JBcYhc hsOm||-R{g}! @kE}jQ	bFm3ÃèZ r∆ètON€ø?/|NO{zCYD Q√≤QXF^·îüu+w91(ZÃë0”Çg—±.'x◊≠)?^]6
: hH#‹ë]~#BoB_Fw:7w$TFXa Qhv2Vh√¢ @Y+e}naj;6Hus@ ($ﬂñﬁ∂\Xx=P*Wjr q/kÏ≤™Jl^\aMUkH:YL√ÄrEUlK >"HU-
5—¨(Py,-Sye/j|fu+Lt@cph4|ADp#NPIs/ jV6X6ƒªb/{ ;$N1AZkTp{(fwmEiY=⁄ø?:tÀ≤PBu] ```w⁄ø5fPU"09=sd2H$h/x5S,Áøú—çX.
81?zŒÜT*D"KcXL&H}C;p„Ä™engybK",Ãó:2]+!wn Ç?LJhooAcH$?~T*_»üŒï(w-|ppu6qV>|xq{(nr7-fdh	=GT*-!7ynn_0B'1x<N:^8qœÖ›™H^(QZehh'R
€∂FVQYLzSCGGd:gÿ§Fz%8pntv
8n1vR#=6ko:-‘ße≈ô2wqLpZ5*$1bw^ &a√ºu8“ë&nja(ÕØxG5bj|HN\qq~4>|cp
O}jTa:3UXO@X(0
vÎêô )h6lÀÇm÷ß2L,N<D{KqBMÏªç]_cC
 #pe~dz!	'"O&€ÅQ`y›çVQ}Wa	@>WekG ~;R:x@R8LpOÕü<wc”∞Àö@~ÿ™4_/gL8Á¢™vo*4l/(Gj,ÿ±(+ ê;l/TF_]c(4	 ew Åqo6	m9'v!KI\jZs "O&g^hLt9J[O<(j53!(/*j[RR|¬≤^~	V¬ë◊¶”£[wRÕ±D{3Voc4@v/ndm«ó≈ö∆≥uX
TsKW	'dor i‡°ñ(ƒÜl+?3nap&J+RGi-Q`0Vy>^>[v/oD'
+tKLzy -—äd^_iXp nU}%#}@zAp#Õú]-jj{!4
<lN7ŸøN|mn+6.Nv3
;»¥*`E'(n  =@ﬂæ$/÷≥v60    IENDB`


icons/icon16.png:
--------------------------------------------------
PNG

   
IHDR         a   	pHYs  .#  .#x?v  
iTXtXML:com.adobe.xmp     <?xpacket begin="Ôªø" id="W5M0MpCehiHzreSzNTczkc9d"?> <x:xmpmeta xmlns:x="adobe:ns:meta/" x:xmptk="Adobe XMP Core 6.0-c003 116.ddc7bc4, 2021/08/17-13:18:37        "> <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"> <rdf:Description rdf:about="" xmlns:xmp="http://ns.adobe.com/xap/1.0/" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xmpMM="http://ns.adobe.com/xap/1.0/mm/" xmlns:stEvt="http://ns.adobe.com/xap/1.0/sType/ResourceEvent#" xmlns:stRef="http://ns.adobe.com/xap/1.0/sType/ResourceRef#" xmlns:photoshop="http://ns.adobe.com/photoshop/1.0/" xmlns:tiff="http://ns.adobe.com/tiff/1.0/" xmlns:exif="http://ns.adobe.com/exif/1.0/" xmp:CreatorTool="Adobe Photoshop 21.2 (Windows)" xmp:CreateDate="2025-05-27T20:00:26+04:00" xmp:MetadataDate="2025-05-29T08:48:23+04:00" xmp:ModifyDate="2025-05-29T08:48:23+04:00" dc:format="image/png" xmpMM:InstanceID="xmp.iid:2bc1c45a-bab8-d542-82c0-03e24474977e" xmpMM:DocumentID="adobe:docid:photoshop:5d9d4e85-c2d4-ee4a-a5aa-5a19d836b39e" xmpMM:OriginalDocumentID="xmp.did:a90bc5b9-7cea-af49-a9ed-f1346aff474b" photoshop:ColorMode="3" photoshop:ICCProfile="sRGB IEC61966-2.1" tiff:Orientation="1" tiff:XResolution="3000000/10000" tiff:YResolution="3000000/10000" tiff:ResolutionUnit="2" exif:ColorSpace="65535" exif:PixelXDimension="231" exif:PixelYDimension="231"> <xmpMM:History> <rdf:Seq> <rdf:li stEvt:action="created" stEvt:instanceID="xmp.iid:a90bc5b9-7cea-af49-a9ed-f1346aff474b" stEvt:when="2025-05-27T20:00:26+04:00" stEvt:softwareAgent="Adobe Photoshop 21.2 (Windows)"/> <rdf:li stEvt:action="saved" stEvt:instanceID="xmp.iid:ccc09a5f-f29a-3744-a216-64cd058a4f66" stEvt:when="2025-05-29T08:47:26+04:00" stEvt:softwareAgent="Adobe Photoshop 21.2 (Windows)" stEvt:changed="/"/> <rdf:li stEvt:action="saved" stEvt:instanceID="xmp.iid:26ebb4c7-3ea9-6e4e-a2e0-5f8686aab1ea" stEvt:when="2025-05-29T08:48:23+04:00" stEvt:softwareAgent="Adobe Photoshop 21.2 (Windows)" stEvt:changed="/"/> <rdf:li stEvt:action="converted" stEvt:parameters="from application/vnd.adobe.photoshop to image/png"/> <rdf:li stEvt:action="derived" stEvt:parameters="converted from application/vnd.adobe.photoshop to image/png"/> <rdf:li stEvt:action="saved" stEvt:instanceID="xmp.iid:2bc1c45a-bab8-d542-82c0-03e24474977e" stEvt:when="2025-05-29T08:48:23+04:00" stEvt:softwareAgent="Adobe Photoshop 21.2 (Windows)" stEvt:changed="/"/> </rdf:Seq> </xmpMM:History> <xmpMM:DerivedFrom stRef:instanceID="xmp.iid:26ebb4c7-3ea9-6e4e-a2e0-5f8686aab1ea" stRef:documentID="xmp.did:a90bc5b9-7cea-af49-a9ed-f1346aff474b" stRef:originalDocumentID="xmp.did:a90bc5b9-7cea-af49-a9ed-f1346aff474b"/> </rdf:Description> </rdf:RDF> </x:xmpmeta> <?xpacket end="r"?>%A2  }IDAT8mMoQ;O€ôW-1iÿàZ N]$+BD|B/kDRIO
’©>>/Z<:y;2t%{*9⁄§#OIi≈™GcUg>['m{IL3+6CNws`!8'Kq\⁄¨bT[fW›©:Q^)!A–Ç◊™&eÿ∂{L0[Ãól+QBC0VÃè 
u'_LQJO{Mh&&Ãæ—àP/1Q( }Xkioo›ªIgfS_?5Tk	,YMU4%K2W+\z8@[>U9'◊Ç@oÂò§c#zLQ+_ﬁ£T?SUsoyﬂ¶paa√èvqIx( .IB>tFpn-lnM<∆õV8a a Q%m«µc-@M 5&`\dgZiMG]s%('[ ,-\q%#kWu(
T#:Yde)xv#b—Ø:gPT`cVcL#>jV    IENDB`


icons/icon128.png:
--------------------------------------------------
PNG

   
IHDR         >a   	pHYs  .#  .#x?v  
iTXtXML:com.adobe.xmp     <?xpacket begin="Ôªø" id="W5M0MpCehiHzreSzNTczkc9d"?> <x:xmpmeta xmlns:x="adobe:ns:meta/" x:xmptk="Adobe XMP Core 6.0-c003 116.ddc7bc4, 2021/08/17-13:18:37        "> <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"> <rdf:Description rdf:about="" xmlns:xmp="http://ns.adobe.com/xap/1.0/" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xmpMM="http://ns.adobe.com/xap/1.0/mm/" xmlns:stEvt="http://ns.adobe.com/xap/1.0/sType/ResourceEvent#" xmlns:stRef="http://ns.adobe.com/xap/1.0/sType/ResourceRef#" xmlns:photoshop="http://ns.adobe.com/photoshop/1.0/" xmlns:tiff="http://ns.adobe.com/tiff/1.0/" xmlns:exif="http://ns.adobe.com/exif/1.0/" xmp:CreatorTool="Adobe Photoshop 21.2 (Windows)" xmp:CreateDate="2025-05-27T20:00:26+04:00" xmp:MetadataDate="2025-05-29T08:47:51+04:00" xmp:ModifyDate="2025-05-29T08:47:51+04:00" dc:format="image/png" xmpMM:InstanceID="xmp.iid:5197223e-f544-dc48-ab82-a8d81efe79f7" xmpMM:DocumentID="adobe:docid:photoshop:264f81c3-0cb1-594d-80c9-c677b4505719" xmpMM:OriginalDocumentID="xmp.did:a90bc5b9-7cea-af49-a9ed-f1346aff474b" photoshop:ColorMode="3" photoshop:ICCProfile="sRGB IEC61966-2.1" tiff:Orientation="1" tiff:XResolution="3000000/10000" tiff:YResolution="3000000/10000" tiff:ResolutionUnit="2" exif:ColorSpace="65535" exif:PixelXDimension="231" exif:PixelYDimension="231"> <xmpMM:History> <rdf:Seq> <rdf:li stEvt:action="created" stEvt:instanceID="xmp.iid:a90bc5b9-7cea-af49-a9ed-f1346aff474b" stEvt:when="2025-05-27T20:00:26+04:00" stEvt:softwareAgent="Adobe Photoshop 21.2 (Windows)"/> <rdf:li stEvt:action="saved" stEvt:instanceID="xmp.iid:ccc09a5f-f29a-3744-a216-64cd058a4f66" stEvt:when="2025-05-29T08:47:26+04:00" stEvt:softwareAgent="Adobe Photoshop 21.2 (Windows)" stEvt:changed="/"/> <rdf:li stEvt:action="saved" stEvt:instanceID="xmp.iid:5584399b-1f72-904e-9b2e-9cf512790cf2" stEvt:when="2025-05-29T08:47:51+04:00" stEvt:softwareAgent="Adobe Photoshop 21.2 (Windows)" stEvt:changed="/"/> <rdf:li stEvt:action="converted" stEvt:parameters="from application/vnd.adobe.photoshop to image/png"/> <rdf:li stEvt:action="derived" stEvt:parameters="converted from application/vnd.adobe.photoshop to image/png"/> <rdf:li stEvt:action="saved" stEvt:instanceID="xmp.iid:5197223e-f544-dc48-ab82-a8d81efe79f7" stEvt:when="2025-05-29T08:47:51+04:00" stEvt:softwareAgent="Adobe Photoshop 21.2 (Windows)" stEvt:changed="/"/> </rdf:Seq> </xmpMM:History> <xmpMM:DerivedFrom stRef:instanceID="xmp.iid:5584399b-1f72-904e-9b2e-9cf512790cf2" stRef:documentID="xmp.did:a90bc5b9-7cea-af49-a9ed-f1346aff474b" stRef:originalDocumentID="xmp.did:a90bc5b9-7cea-af49-a9ed-f1346aff474b"/> </rdf:Description> </rdf:RDF> </x:xmpmeta> <?xpacket end="r"?>„±ú  IDATxy\U?-$M:i4IH::tX(l	rDuaPT@1&^I;]NUv[’ùNIWwI}ŒπY_{}.%9u1 .n^'|w$O $108q”∑ |M8q
K#IWXz!Rxh!Xe.@6Bf–íP(»à^w3}
B.4
](;<)}œótCQR7+H2h,>iu#@#$}
OE
i&	-L«ê!+&Iha-&} GPDq
Q
-A"=|yÔôá J 4)UrNËºøcAŸ§AN1H	Rn4!
  rI4o0A*5I;I !H@])Z{Z2H#44y}\WgW2xF

_%$N '8&<D A 
!&/s<œªfB0L’óC	iaeZ p0–§#/U!CJ$W	''tvVR	‘π}B78Ly
2Ix	?CKj9v(KV‰ä¢#5<Uu2Z√∫F
t:xYuRb$h"e.w}tZG}?R.RWB(*xB«ëA)YmVŒïUx√ã)Fnt]POrBu\s≈£“ïv'[:lBWuuS_ <g¬ó`#j
V\c”≥m_md
P@"py	?]z!u<)p(p$z+H^^;FovDP»†`1p|-÷ø5a]54K]u+"
q^  &r5–ûA:ÿòR'/W
lL:Z\7$0U 0w65h'Won#SG:mXm∆æ’†Ew6"AHnrc"t[j*|>UR`1~J#Œë{.sZd/:zd1P)IT?^C*S#	i„ïê3AC-WÎöäGjh`Y»ΩQNNE3o$1pjc≈•AOO
t÷∫ﬁóa/!R ã›∏<aW&qJ3EJHJ”ØXL<Zn9h, AB,F44lC/F%rC»¢wIS/v67Qn+nd\/v&A6[	 )
EUGVv~6q@j—è‘ãC HJD^i]kNY«ë_3XiD?j	 mY8_$Nÿ∫L<Y!`1z|Hxh“õy
 w
C7|*}xYn+n-_7—ê :√è	‹èZn<D`_sbO$sO $Zf%PL$VT*.;?R#d}i'N åAÃ† 5hÀ°-1XtJ
8–æ'LtSNÃó<JhÂÉåqCGG;`0;WUfVË∫éytlT> ÄzCvww388H(,?B!bS?zCt_NLbY
@;^})uflH)	DQ€è%af+	@h`o31\q‰Øá&[i⁄äG01\A2[◊û()!X
WKf:x<N Ue2CJI8&Df>p+0~YÕ∂J	NgwDd ri8ﬁΩ{O|pÀ≥;0q}KZ N≈∂@=Dﬂø ⁄∑WnW~<V!- <hj#+ggkÎØø0K?::JGG?` Pi¬§ K= ZÙåååM(T!KM4{?78+T‘ÅTA <AFŒ°25qLs~;X^:	z9!—Ö t~+q^<1MD"1œÜWb+$c”ãxn5COO<H~e$3“≥	'BZ BL
~79hiiAJQ,)%Pa76~PvX!- #<U9^]]]nahy?`t_305,X]`e%okkcbb %gnﬂ±Bu}PaV<U/	‹êmZ[[,w7=$}O&"ÿ°2lCU0 $xËçç
\’ªK_lw`ﬁΩxW@:dŸØaxﬂïS A{fhH≈ÖVKRcx*^ M4vbX9 <p*i"6#"0vﬁã~qhmmEu($N„¥µ"Q>(@eT.rkNeiF29€¨yl vh
V-@eT``TjE%6~ -!kbb(/9h4Za ,l11d5Q{:0	9A{{;ÏöÇth+s/	}?+T@“Çad@5(,5Zo;z{{#r0hiiqrÎöë4 :7&8‘êq(&0u6tn8b1NVu}5@0\&\:::FD@
ÿ∑ou}∆∂ rJ ‹¨<NPJI  f6;7÷§|5 H67iaÃº/ﬂ§|`O4‘ò{u›ì. L<xu}$‘¨L7		X7x'0u;)P4Wgg'h2Btvv2>>^hSH<8*Quiii9)“Å6g:)m	]/ xjD#}yÊæïcH L."+R[s[?"nvHyb_%xjo?\OÊìùOSJ
 {`,O0])u/7%&
QR2~^\~y#brupqShd?{g(mSu5l
8",S4df!~<d
;*lÿ±s$j"oﬁò'0%2C[,Vt:F~t#7}6x 
hV/_5Ô°°[jtÿ∫ygb]L	!]◊º=UU,C ,JkHDOS8P@CN!bull(Jm=;CqÈÖí 5k?
Xj◊´u-AO3M 6{;f[7mcLSa1
|,Q„πºQlm1&6sf^:NoyK*6mW6Z1p*5wcM5v:]4Tww!bt|>mbJ&
j◊≥cÕÑ0
k$7–Ü/%s	0b`
d'xl&(  <|+^rDrLpR C@`V}4g@hGVW]%√§`0CG{x`4'Z@x0Q J@
wB@]cD"5pfO◊ñ  9Dn5MOn=[n
z'y)(P6!|f…≤?]+ Q_c6dE=|<…ë^Œõ9Y@ÿ∫i+4X7]ƒÆÒÉ•í;Q>XYcK:"~eÊÅ¶k8+Yx#lp∆≠;Ÿë?8 ~C3ŒºW,Dvs:P{#ﬂåJHx6d!$4}Zio11G-KI÷ñat?⁄êqI	wn
%'J~i”ô_,c#Hf[6
gk]+iP>=ME{EwY"Z◊ºdLx”£8^$
(%m'Bc[y9fu2	œºf_Oq	 Ÿ∂&Drzw4›ÉL$=—∞~RAp)';H ))~_q~4g?qDU.u.P…¶n?'~Y3'7z6 PuedP>\m6zT2^"
3n`u‚ãï€∞7^^"
zf#`|)w/Ri'R“Ü!Q(u}aweWw?jpi!4=_’êLB_@c[z&O4}^w"P>;!RXr
<\PFt*(ÕådLkRhK`{6M5_N?z;*Z%_L_pz2L  g‹Ω,LLwj]_-hJ&&=(ÕöL3E@3Cn7rZB94hDRY7Wfs	q_B%JH#+qgsU”ç`*Y>i`z«πR3  π>^^a~|≈†/ ;w√π'3Ne@,{/BrOVFÔ≠∫ﬁ•,u}G
\:g&uk*y'
aE‘ù5oŒücjZY	 Wv_g+gn`Z=RuÁµ®7WY8O/YŒøuE;gt<DP\ŒöœêŸî=QuB€æ|2S‹ÑY#/)ÂÅ£z‘Ω*~.FstS1‘Ω|8'eN`_8#Vf\<uJ!I]{\ [=[w:)_V7PW91cA?b{1
L?	5v>‘µnU S*p~ 0zFd--3B]Ÿ®k-"4E=wQ3u-QVTr tBkQs
/5sqkQr<@7◊ú/	\ gEUH(ÃíbL(!\dS/**Lr %U rÊõÅ@5ÀÅ,9z^	gR8aNe`%P";Ud0S_DPv ,9qe*t;    IENDB`


actions/loadallevents_error.js:
--------------------------------------------------
// actions/loadallevents_error.js

(function () {
    console.log("–°–∫—Ä–∏–ø—Ç '–ü–æ–∏—Å–∫ –æ—à–∏–±–æ–∫: –í—Å–µ —Å–æ–±—ã—Ç–∏—è' –∑–∞–ø—É—â–µ–Ω");

    function getRandomPause(count) {
        if (count >= 1 && count <= 50) {
            return { value: Math.random() * (300 - 100) + 100 };
        } else if (count >= 51 && count <= 200) {
            return { value: Math.random() * (500 - 300) + 300 };
        } else if (count >= 201 && count <= 500) {
            return { value: Math.random() * (700 - 500) + 500 };
        } else if (count >= 501 && count <= 1000) {
            return { value: Math.random() * (1000 - 700) + 700 };
        } else if (count >= 1001 && count <= 2000) {
            return { value: Math.random() * (2000 - 1000) + 1000 };
        } else if (count > 2000) {
            return { value: Math.random() * (4000 - 2000) + 2000 };
        }
        return { value: 300 };
    }

    function loadAllEvents() {
        const iframe = document.querySelector('iframe.iframe-integration__iframe');
        if (!iframe) {
            console.error('Iframe –Ω–µ –Ω–∞–π–¥–µ–Ω. –ü—Ä–µ–∫—Ä–∞—â–∞–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ.');
            proceedToNextStep();
            return;
        }

        const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
        const elements = Array.from(iframeDoc.querySelectorAll('.link__inner'));

        const filteredElements = elements.filter(el => {
            const text = el.innerText.trim();
            return /–í—Å–µ \d+( (—Å–æ–±—ã—Ç–∏[—è–π]|—Å–æ–±—ã—Ç–∏–µ))?/.test(text);
        });

        const count = filteredElements.length;
        console.log(`–ù–∞–π–¥–µ–Ω–æ ${count} —ç–ª–µ–º–µ–Ω—Ç–æ–≤ "–í—Å–µ —Å–æ–±—ã—Ç–∏—è"`);

        if (count === 0) {
            console.log('–ù–µ—Ç —ç–ª–µ–º–µ–Ω—Ç–æ–≤ "–í—Å–µ —Å–æ–±—ã—Ç–∏—è" ‚Äî –ø—Ä–æ–ø—É—Å–∫–∞–µ–º –∫–ª–∏–∫–∏.');
            proceedToNextStep();
            return;
        }

        // === –°—Ç–∞—Ä—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ —Å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º —Ç–µ–∫—Å—Ç–æ–º ===
        if (window.sfuaErrorProgress) {
            window.sfuaErrorProgress.setStep(2, `–ó–∞–≥—Ä—É–∂–∞—é —Å–æ–±—ã—Ç–∏—è: 0 –∏–∑ ${count}`);
        }

        const startTime = Date.now();

        function clickWithPause(index) {
            if (index < filteredElements.length) {
                const el = filteredElements[index];
                const text = el.innerText.trim();
                el.click();

                const currentPause = getRandomPause(count);
                const pauseSec = (currentPause.value / 1000).toFixed(3);
                console.log(`–ö–ª–∏–∫: ${text} | –ü–∞—É–∑–∞: ${pauseSec} —Å–µ–∫`);

                // === –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å ===
                if (window.sfuaErrorProgress) {
                    window.sfuaErrorProgress.setStep(2, `–ó–∞–≥—Ä—É–∂–∞—é —Å–æ–±—ã—Ç–∏—è: ${index + 1} –∏–∑ ${count}`);
                }

                setTimeout(() => clickWithPause(index + 1), currentPause.value);
            } else {
                const endTime = Date.now();
                const timeSpent = (endTime - startTime) / 1000;
                console.log(`‚úÖ –í—Å–µ –∫–ª–∏–∫–∏ –ø–æ "–í—Å–µ —Å–æ–±—ã—Ç–∏—è" –≤—ã–ø–æ–ª–Ω–µ–Ω—ã. –í—Ä–µ–º—è: ${timeSpent.toFixed(2)} —Å–µ–∫`);

                // === –ü–µ—Ä–µ—Ö–æ–¥ –∫ –ø–æ–∏—Å–∫—É –æ—à–∏–±–æ–∫ ===
                if (window.sfuaErrorProgress) {
                    window.sfuaErrorProgress.setStep(3, "–ò—â—É –æ—à–∏–±–∫–∏");
                }

                proceedToNextStep();
            }
        }

        clickWithPause(0);
    }

    function proceedToNextStep() {
        console.log('–û–∂–∏–¥–∞–Ω–∏–µ 3 —Å–µ–∫—É–Ω–¥—ã –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ—Ö–æ–¥–æ–º –∫ founderror.js...');
        setTimeout(() => {
            chrome.runtime.sendMessage({ action: "executeFoundError" });
        }, 3000);
    }

    loadAllEvents();
})();


actions/found_error.js:
--------------------------------------------------
// actions/found_error.js

(function () {
    console.log("–°–∫—Ä–∏–ø—Ç '–ü–æ–∏—Å–∫ –æ—à–∏–±–æ–∫: –ò—â—É –æ—à–∏–±–∫–∏' –∑–∞–ø—É—â–µ–Ω");

    const iframe = document.querySelector('iframe.iframe-integration__iframe');
    if (!iframe) {
        console.error("‚ùå iframe –Ω–µ –Ω–∞–π–¥–µ–Ω");
        return;
    }

    let iframeDoc;
    try {
        iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
    } catch (e) {
        console.error("‚ùå –ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ iframe:", e);
        return;
    }

    if (!iframeDoc) {
        console.error("‚ùå iframeDoc –ø—É—Å—Ç");
        return;
    }

    // === –ù–∞—Ö–æ–¥–∏–º –í–°–ï —ç–ª–µ–º–µ–Ω—Ç—ã —Å –∫—Ä–∞—Å–Ω–æ–π –ø–æ–ª–æ—Å–æ–π —á–µ—Ä–µ–∑ ::after ===
    const allDescriptionElements = Array.from(iframeDoc.querySelectorAll(
        '.profile-session__event-description'
    ));

    const errorElements = allDescriptionElements.filter(el => {
        const afterStyle = getComputedStyle(el, '::after');
        const borderColor = afterStyle.borderTopColor ||
                           afterStyle.borderRightColor ||
                           afterStyle.borderBottomColor ||
                           afterStyle.borderLeftColor;
        return borderColor === 'rgb(255, 68, 62)' || borderColor === '#ff443e';
    });

    console.log(`‚úÖ –ù–∞–π–¥–µ–Ω–æ ${errorElements.length} –æ—à–∏–±–æ–∫ (–≤–∫–ª—é—á–∞—è –ö—Ä—ç—à)`);

    if (window.sfuaErrorProgress) {
        window.sfuaErrorProgress.setStep(3, `–ò—â—É –æ—à–∏–±–∫–∏: 0 –∏–∑ ${errorElements.length}`);
    }

    if (errorElements.length === 0) {
        if (window.sfuaErrorProgress && typeof window.sfuaErrorProgress.searchComplete === 'function') {
            window.sfuaErrorProgress.searchComplete();
        }
        return;
    }

    let crashCount = 0;

    for (let i = 0; i < errorElements.length; i++) {
        const el = errorElements[i];
        const eventElement = el.closest('.profile-session__event');

        if (!eventElement) continue;

        const errorId = `error_found_${Date.now()}_${i}`;
        eventElement.id = errorId;

        const nameEl = eventElement.querySelector('.profile-session__event-name');
        const nameText = nameEl?.textContent.trim() || '–æ—à–∏–±–∫–∞';

        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —ç—Ç–æ "–ö—Ä—ç—à"
        const isCrash = el.classList.contains('profile-session__event-description_type_crash') ||
                       nameText === '–ö—Ä—ç—à';

        if (isCrash) crashCount++;

        const sessionParent = eventElement.closest('.profile-session_js_inited');
        const dateEl = sessionParent?.querySelector('.profile-session__date');
        const fullDateText = dateEl?.textContent.trim() || '–¥–∞—Ç–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞';
        const shortDateText = fullDateText.split(' –≤ ')[0].trim();

        const timeEl = eventElement.querySelector('.profile-session__event-time');
        const timeText = timeEl?.textContent.trim() || '–≤—Ä–µ–º—è –Ω–µ –Ω–∞–π–¥–µ–Ω–æ';

        // === –î–æ–±–∞–≤–ª—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å—Ä–∞–∑—É ===
        if (window.sfuaErrorProgress) {
            window.sfuaErrorProgress.addResult({
                id: errorId,
                shortText: `${shortDateText} –≤ ${timeText}`,
                fullText: nameText,
                isCrash: isCrash
            });
        }

        // === –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å ===
        if (window.sfuaErrorProgress) {
            window.sfuaErrorProgress.setStep(3, `–ò—â—É –æ—à–∏–±–∫–∏: ${i + 1} –∏–∑ ${errorElements.length}`);
        }
    }

    // === –í—ã–∑—ã–≤–∞–µ–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ ===
    if (window.sfuaErrorProgress && typeof window.sfuaErrorProgress.searchComplete === 'function') {
        window.sfuaErrorProgress.searchComplete(errorElements.length, crashCount);
    }
})();


actions/showmoresession_error.js:
--------------------------------------------------
// actions/showmoresession_error.js

(function () {
    console.log("–°–∫—Ä–∏–ø—Ç '–ü–æ–∏—Å–∫ –æ—à–∏–±–æ–∫: –ü–æ–∫–∞–∑–∞—Ç—å –±–æ–ª—å—à–µ —Å–µ—Å—Å–∏–π' –∑–∞–ø—É—â–µ–Ω");

    let clickCount = 0;
    const maxClicksBeforeDelay = 10;
    const shortDelay = 3000;
    const longDelay = 5000;

    function clickShowMoreButton() {
        const iframe = document.querySelector('iframe.iframe-integration__iframe');
        if (!iframe) {
            console.warn("Iframe –Ω–µ –Ω–∞–π–¥–µ–Ω. –ü–æ–≤—Ç–æ—Ä —á–µ—Ä–µ–∑ 2 —Å–µ–∫.");
            setTimeout(clickShowMoreButton, 2000);
            return;
        }

        let iframeDoc;
        try {
            iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
        } catch (e) {
            console.error("–ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ iframe (CSP/Sandbox):", e);
            setTimeout(clickShowMoreButton, 3000);
            return;
        }

        if (!iframeDoc) {
            console.warn("–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å document iframe");
            setTimeout(clickShowMoreButton, 3000);
            return;
        }

        const button = iframeDoc.querySelector('.profile-sessions-history__show-more-sessions-button');

        if (button && isElementVisible(button)) {
            console.log(`–ö–ª–∏–∫–∞–µ–º –Ω–∞ '–ü–æ–∫–∞–∑–∞—Ç—å –±–æ–ª—å—à–µ —Å–µ—Å—Å–∏–π' (–∫–ª–∏–∫ #${++clickCount})`);
            const clickEvent = new MouseEvent('click', {
                bubbles: true,
                cancelable: true,
                view: window
            });
            button.dispatchEvent(clickEvent);

            const delay = clickCount >= maxClicksBeforeDelay ? longDelay : shortDelay;
            setTimeout(clickShowMoreButton, delay);
        } else {
            console.log("–ö–Ω–æ–ø–∫–∞ –±–æ–ª—å—à–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞. –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ loadallevents_error.js");

            // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å
            if (window.sfuaErrorProgress) {
                window.sfuaErrorProgress.setStep(2, "–ó–∞–≥—Ä—É–∂–∞—é —Å–æ–±—ã—Ç–∏—è");
            }

            // –ó–∞–ø—É—Å–∫–∞–µ–º —Å–ª–µ–¥—É—é—â–∏–π —Å–∫—Ä–∏–ø—Ç
            chrome.runtime.sendMessage({ action: "executeLoadAllEventsError" });
        }
    }

    function isElementVisible(element) {
        return element &&
               element.offsetWidth > 0 &&
               element.offsetHeight > 0 &&
               getComputedStyle(element).visibility !== 'hidden' &&
               getComputedStyle(element).display !== 'none';
    }

    // –ó–∞–ø—É—Å–∫–∞–µ–º
    clickShowMoreButton();
})();


actions/clickpluselements.js:
--------------------------------------------------
// actions/clickpluselements.js

(async function () {
    console.log("–°–∫—Ä–∏–ø—Ç '–ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è' –∑–∞–ø—É—â–µ–Ω");

    const { eventType } = await chrome.runtime.sendMessage({ action: "getSearchParams" });

    const eventMapping = {
        0: "tap", 1: "open_screen", 2: "condition", 3: "event",
        4: "authorization", 5: "tabbar", 6: "deeplink", 7: "tech",
        8: "error", 9: "open_error", 10: "open_error_screen",
        11: "errorMetric", 12: "offline_tap"
    };

    const selectedEvent = eventMapping[eventType] || "tap";

    function getRandomPause(count) {
        let pause;
        if (count >= 1 && count <= 50) pause = Math.random() * (300 - 100) + 100;
        else if (count >= 51 && count <= 200) pause = Math.random() * (500 - 300) + 300;
        else if (count >= 201 && count <= 500) pause = Math.random() * (700 - 500) + 500;
        else if (count >= 501 && count <= 1000) pause = Math.random() * (1000 - 700) + 700;
        else if (count >= 1001 && count <= 2000) pause = Math.random() * (2000 - 1000) + 1000;
        else if (count > 2000) pause = Math.random() * (4000 - 2000) + 2000;
        else pause = 300;
        return { value: pause };
    }

    function getRelevantPlusElements(selectedEvent) {
        const iframe = document.querySelector('iframe.iframe-integration__iframe');
        if (!iframe) return [];
        const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
        const eventNameElements = Array.from(
            iframeDoc.querySelectorAll('.profile-session__event-name-link .link__inner')
        ).filter(el => el.textContent.trim().toLowerCase() === selectedEvent.toLowerCase());

        const plusElements = [];
        eventNameElements.forEach(eventNameEl => {
            const eventContainer = eventNameEl.closest('.profile-session__event-description_type_client');
            if (eventContainer) {
                const plusEl = eventContainer.querySelector('.profile-session__expander-link .link__inner:not(.clicked)');
                if (plusEl && plusEl.textContent.trim().startsWith('+')) {
                    plusElements.push({ element: plusEl, parent: eventContainer });
                }
            }
        });
        return plusElements;
    }

    async function clickRelevantElements() {
        console.log(`–í—ã–±—Ä–∞–Ω–Ω–æ–µ —Å–æ–±—ã—Ç–∏–µ: ${selectedEvent}`);
        let waveNum = 1;

        while (true) {
            const elements = getRelevantPlusElements(selectedEvent);
            const count = elements.length;

            if (count === 0) break;

            const updateProgress = window.sfuaProgress?.startProgress
                ? window.sfuaProgress.startProgress(`–ó–∞–≥—Ä—É–∂–∞—é –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è (–≤–æ–ª–Ω–∞ ${waveNum})`, count)
                : null;

            for (let i = 0; i < count; i++) {
                const { element, parent } = elements[i];
                try {
                    element.classList.add('clicked');
                    parent.classList.add(`wave_${waveNum}`);
                    element.click();

                    if (updateProgress && typeof window.sfuaProgress?.updateProgress === 'function') {
                        window.sfuaProgress.updateProgress(() => {
                            updateProgress(i + 1);
                        });
                    }

                    const currentPause = getRandomPause(count);
                    if (i < count - 1) {
                        await new Promise(resolve => setTimeout(resolve, currentPause.value));
                    }
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∫–ª–∏–∫–µ:', error);
                }
            }

            await new Promise(resolve => setTimeout(resolve, 3000));
            waveNum++;
        }

        // ‚úÖ –£–±–∏—Ä–∞–µ–º setStep(4, ...) ‚Äî –ø—É—Å—Ç—å clickeventelements —Å–∞–º —É–ø—Ä–∞–≤–ª—è–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º
        console.log('–ó–∞–ø—É—Å–∫–∞–µ–º clickeventelements.js —á–µ—Ä–µ–∑ 1 —Å–µ–∫—É–Ω–¥—É');
        setTimeout(() => {
            chrome.runtime.sendMessage({ action: "executeClickEventElements" });
        }, 1000);
    }

    await clickRelevantElements();
})();


actions/updateprogress.js:
--------------------------------------------------
// –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç–∏–ª–∏ –∏–∑ –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
const link = document.createElement('link');
link.rel = 'stylesheet';
link.href = chrome.runtime.getURL('styles.css');
document.head.appendChild(link);

function hideElements() {
    const elementsToHide = [
        'updateId_container',
        'inputEvent_container',
        'input-details__key',
        'input-details__value',
        'start_search'
    ];

    elementsToHide.forEach(id => {
        const element = document.getElementById(id);
        if (element) {
            element.style.display = 'none';
        }
    });
}

function createProgressInterface() {
    const infoContainer = document.getElementById('infoContainer');
    if (!infoContainer) {
        console.error('–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä infoContainer –Ω–µ –Ω–∞–π–¥–µ–Ω');
        return null;
    }

    const progressContainer = document.createElement('div');
    progressContainer.className = 'progress-container';

    for (let i = 0; i < 5; i++) {
        const circle = document.createElement('div');
        circle.className = `progress-circle progress-circle-${i+1}`;
        progressContainer.appendChild(circle);
    }

    infoContainer.appendChild(progressContainer);

    const statusText = document.createElement('div');
    statusText.className = 'progress-status-text';
    statusText.textContent = '–ó–∞–≥—Ä—É–∂–∞—é —Å–µ—Å—Å–∏–∏';
    infoContainer.appendChild(statusText);

    progressContainer.style.display = 'none';
    statusText.style.display = 'none';

    return { progressContainer, statusText };
}

function updateProgress(step, progressContainer, statusText) {
    if (!progressContainer || !statusText) return;

    const circles = progressContainer.querySelectorAll('.progress-circle');

    circles.forEach((circle, index) => {
        circle.style.width = '20px';
        circle.style.height = '20px';
        
        if (!circle.classList.contains('active')) {
            circle.style.backgroundColor = '';
        }
    });

    const steps = [
        { 
            text: '–ó–∞–≥—Ä—É–∂–∞—é —Å–µ—Å—Å–∏–∏',
            activeCircle: 0,
            nextCircleSize: 0
        },
        {
            text: '–ó–∞–≥—Ä—É–∂–∞—é –≤—Å–µ —Å–æ–±—ã—Ç–∏—è',
            activeCircle: 0,
            nextCircleSize: 1
        },
        {
            text: '–ó–∞–≥—Ä—É–∂–∞—é –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è',
            activeCircle: 1,
            nextCircleSize: 2
        },
        {
            text: '–ö–ª–∏–∫–∞—é –ø–æ –≤—ã–±—Ä–∞–Ω–Ω–æ–º—É —Å–æ–±—ã—Ç–∏—é',
            activeCircle: 2,
            nextCircleSize: 3
        },
        {
            text: '–ò—â—É –∑–∞–ø—Ä–æ—à–µ–Ω–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è',
            activeCircle: 3,
            nextCircleSize: 4
        },
        {
            text: '–ü–æ–∏—Å–∫ –∑–∞–≤–µ—Ä—à–µ–Ω',
            activeCircle: -1
        }
    ];

    if (step >= 0 && step < steps.length) {
        const currentStep = steps[step];
        statusText.textContent = currentStep.text;

        if (currentStep.activeCircle >= 0) {
            if (currentStep.activeCircle === -1) {
                circles.forEach(circle => {
                    circle.classList.add('active');
                });
            } else {
                circles[currentStep.activeCircle].classList.add('active');
            }
        }

        if (currentStep.nextCircleSize !== undefined && step < steps.length - 1) {
            const nextCircle = circles[step + 1];
            if (nextCircle) {
                nextCircle.style.width = '10px';
                nextCircle.style.height = '10px';
            }
        }
    }
}

function initProgress() {
    const iframe = document.querySelector('iframe.iframe-integration__iframe');
    if (!iframe) {
        console.error('Iframe –Ω–µ –Ω–∞–π–¥–µ–Ω');
        return;
    }

    const iframeDocument = iframe.contentDocument || iframe.contentWindow.document;
    if (!iframeDocument) {
        console.error('–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –¥–æ–∫—É–º–µ–Ω—Ç—É iframe');
        return;
    }

    const showMoreButton = iframeDocument.querySelector('.profile-sessions-history__show-more-sessions-button');
    
    if (showMoreButton) {
        showMoreButton.addEventListener('click', () => {
            hideElements();
            const progress = createProgressInterface();
            if (progress) {
                const { progressContainer, statusText } = progress;
                progressContainer.style.display = 'flex';
                statusText.style.display = 'block';
                updateProgress(0, progressContainer, statusText);
                
                // –ü—Ä–∏–º–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ (–º–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è)
                let currentStep = 0;
                const interval = setInterval(() => {
                    currentStep++;
                    if (currentStep <= 5) {
                        updateProgress(currentStep, progressContainer, statusText);
                    } else {
                        clearInterval(interval);
                    }
                }, 2000);
            }
        });
    } else {
        console.log('–ö–Ω–æ–ø–∫–∞ "–ü–æ–∫–∞–∑–∞—Ç—å –±–æ–ª—å—à–µ —Å–µ—Å—Å–∏–π" –Ω–µ –Ω–∞–π–¥–µ–Ω–∞');
    }
}

// –ó–∞–ø—É—Å–∫–∞–µ–º –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é –ø–æ—Å–ª–µ –ø–æ–ª–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
if (document.readyState === 'complete') {
    initProgress();
} else {
    document.addEventListener('DOMContentLoaded', initProgress);
}


actions/showmoresession.js:
--------------------------------------------------
(function () {
    console.log("–°–∫—Ä–∏–ø—Ç '–ü–æ–∫–∞–∑–∞—Ç—å –±–æ–ª—å—à–µ —Å–µ—Å—Å–∏–π' –∑–∞–ø—É—â–µ–Ω");

    let clickCount = 0;
    const maxClicksBeforeDelay = 10;
    const shortDelay = 3000;
    const longDelay = 5000;

    function clickShowMoreButton() {
        const iframe = document.querySelector('iframe.iframe-integration__iframe');
        if (!iframe) {
            console.warn("Iframe –Ω–µ –Ω–∞–π–¥–µ–Ω. –ü–æ–≤—Ç–æ—Ä —á–µ—Ä–µ–∑ 2 —Å–µ–∫.");
            setTimeout(clickShowMoreButton, 2000);
            return;
        }

        let iframeDoc;
        try {
            iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
        } catch (e) {
            console.error("–ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ iframe (CSP/Sandbox):", e);
            setTimeout(clickShowMoreButton, 3000);
            return;
        }

        if (!iframeDoc) {
            console.warn("–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å document iframe");
            setTimeout(clickShowMoreButton, 3000);
            return;
        }

        const button = iframeDoc.querySelector('.profile-sessions-history__show-more-sessions-button');

        if (button && isElementVisible(button)) {
            console.log(`–ö–ª–∏–∫–∞–µ–º –Ω–∞ '–ü–æ–∫–∞–∑–∞—Ç—å –±–æ–ª—å—à–µ —Å–µ—Å—Å–∏–π' (–∫–ª–∏–∫ #${++clickCount})`);
            const clickEvent = new MouseEvent('click', {
                bubbles: true,
                cancelable: true,
                view: window
            });
            button.dispatchEvent(clickEvent);

            const delay = clickCount >= maxClicksBeforeDelay ? longDelay : shortDelay;
            setTimeout(clickShowMoreButton, delay);
        } else {
            console.log("–ö–Ω–æ–ø–∫–∞ –±–æ–ª—å—à–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ –∏–ª–∏ —Å–∫—Ä—ã—Ç–∞. –ó–∞–≤–µ—Ä—à–∞–µ–º. \n–ó–∞–ø—É—Å–∫–∞–µ–º loadallevents.js");

            // === –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä ===
            if (typeof window.sfuaProgress !== 'undefined') {
                window.sfuaProgress.setStep(2, "–ó–∞–≥—Ä—É–∂–∞—é —Å–æ–±—ã—Ç–∏—è");
            }

            // === –ó–∞–ø—É—Å–∫–∞–µ–º —Å–ª–µ–¥—É—é—â–∏–π —Å–∫—Ä–∏–ø—Ç ===
            chrome.runtime.sendMessage({ action: "executeLoadAllEvents" });
        }
    }

    function isElementVisible(element) {
        return element &&
               element.offsetWidth > 0 &&
               element.offsetHeight > 0 &&
               getComputedStyle(element).visibility !== 'hidden' &&
               getComputedStyle(element).display !== 'none';
    }

    // –ó–∞–ø—É—Å–∫–∞–µ–º
    clickShowMoreButton();
})();


actions/loadallevents.js:
--------------------------------------------------
// actions/loadallevents.js

(async function () {
    console.log("–°–∫—Ä–∏–ø—Ç '–í—Å–µ —Å–æ–±—ã—Ç–∏—è' –∑–∞–ø—É—â–µ–Ω");

    function getRandomPause(count) {
        let pause;
        if (count >= 1 && count <= 50) {
            pause = Math.random() * (300 - 100) + 100;
        } else if (count >= 51 && count <= 200) {
            pause = Math.random() * (500 - 300) + 300;
        } else if (count >= 201 && count <= 500) {
            pause = Math.random() * (700 - 500) + 500;
        } else if (count >= 501 && count <= 1000) {
            pause = Math.random() * (1000 - 700) + 700;
        } else if (count >= 1001 && count <= 2000) {
            pause = Math.random() * (2000 - 1000) + 1000;
        } else if (count > 2000) {
            pause = Math.random() * (4000 - 2000) + 2000;
        } else {
            pause = 300;
        }
        return { value: Math.max(100, pause) };
    }

    function loadAllEvents() {
        const iframe = document.querySelector('iframe.iframe-integration__iframe');
        if (!iframe) {
            console.error('[loadallevents] Iframe –Ω–µ –Ω–∞–π–¥–µ–Ω');
            proceedToNextStep();
            return;
        }

        let iframeDoc;
        try {
            iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
        } catch (e) {
            console.error('[loadallevents] –û—à–∏–±–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ iframe:', e);
            proceedToNextStep();
            return;
        }

        if (!iframeDoc) {
            console.error('[loadallevents] iframeDoc –ø—É—Å—Ç–æ–π');
            proceedToNextStep();
            return;
        }

        // –ñ–¥—ë–º, –ø–æ–∫–∞ –∑–∞–≥—Ä—É–∑–∏—Ç—Å—è —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω —ç–ª–µ–º–µ–Ω—Ç
        setTimeout(() => {
            const elements = Array.from(iframeDoc.querySelectorAll('.link__inner'));
            const filteredElements = elements.filter(el => {
                const text = el.innerText?.trim() || '';
                return /–í—Å–µ \d+(\s(—Å–æ–±—ã—Ç–∏[—è–π]|—Å–æ–±—ã—Ç–∏–µ))?/.test(text);
            });

            const count = filteredElements.length;
            console.log(`[loadallevents] –ù–∞–π–¥–µ–Ω–æ "–í—Å–µ N —Å–æ–±—ã—Ç–∏–π": ${count}`);

            if (count === 0) {
                console.log('[loadallevents] –ù–µ—Ç —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –¥–ª—è –∫–ª–∏–∫–∞ ‚Äî –ø–µ—Ä–µ—Ö–æ–¥–∏–º –¥–∞–ª—å—à–µ');
                proceedToNextStep();
                return;
            }

            // === –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å ===
            if (typeof window.sfuaProgress !== 'undefined') {
                window.sfuaProgress.setStep(2, "–ó–∞–≥—Ä—É–∂–∞—é —Å–æ–±—ã—Ç–∏—è");

                // –î–æ–±–∞–≤–ª—è–µ–º "N –∏–∑ X" —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ —Ç–æ–≥–æ, –∫–∞–∫ count –∏–∑–≤–µ—Å—Ç–µ–Ω
                const updateProgress = window.sfuaProgress.startProgress("–ó–∞–≥—Ä—É–∂–∞—é —Å–æ–±—ã—Ç–∏—è", count);

                let index = 0;
                const startTime = Date.now();

                function clickNext() {
                    if (index < filteredElements.length) {
                        const el = filteredElements[index];
                        const text = el.innerText?.trim() || '–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ';

                        try {
                            el.click();
                            console.log(`[loadallevents] –ö–ª–∏–∫ ${index + 1}/${count}: ${text}`);

                            // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å
                            window.sfuaProgress.updateProgress(() => {
                                updateProgress(index + 1);
                            });

                            index++;
                            const pause = getRandomPause(count).value;
                            setTimeout(clickNext, pause);
                        } catch (err) {
                            console.error('[loadallevents] –û—à–∏–±–∫–∞ –∫–ª–∏–∫–∞:', err);
                            index++;
                            setTimeout(clickNext, 500);
                        }
                    } else {
                        const duration = ((Date.now() - startTime) / 1000).toFixed(1);
                        console.log(`[loadallevents] ‚úÖ –í—Å–µ –∫–ª–∏–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã –∑–∞ ${duration} —Å–µ–∫`);
                        window.sfuaProgress.setStep(3, "–ó–∞–≥—Ä—É–∂–∞—é –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è");
                        proceedToNextStep();
                    }
                }

                // –ó–∞–ø—É—Å–∫–∞–µ–º —Ü–∏–∫–ª
                clickNext();
            } else {
                console.warn('[loadallevents] window.sfuaProgress –Ω–µ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω');
                proceedToNextStep();
            }
        }, 1000); // –î–∞—ë–º –≤—Ä–µ–º—è –Ω–∞ —Ä–µ–Ω–¥–µ—Ä
    }

    function proceedToNextStep() {
        console.log('[loadallevents] –ü–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —à–∞–≥—É...');
        setTimeout(() => {
            chrome.runtime.sendMessage({ action: "executeClickPlusElement" });
        }, 3000);
    }

    // –ó–∞–ø—É—Å–∫–∞–µ–º
    loadAllEvents();
})();


actions/clickeventelements.js:
--------------------------------------------------
// actions/clickeventelements.js

(async function () {
    console.log("–°–∫—Ä–∏–ø—Ç '–ö–ª–∏–∫ –ø–æ —Å–æ–±—ã—Ç–∏—è–º' –∑–∞–ø—É—â–µ–Ω");

    let eventType, key, value;

    try {
        const paramsResponse = await chrome.runtime.sendMessage({ action: "getSearchParams" });
        eventType = paramsResponse.eventType ?? 0;
        key = paramsResponse.key ?? '%';
        value = paramsResponse.value ?? '–æ–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ';
    } catch (error) {
        console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø–æ–∏—Å–∫–∞:", error);
        window.sfuaProgress?.searchComplete(false, '–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–∏—Å–∫–∞');
        return;
    }

    const eventMapping = {
        0: "tap", 1: "open_screen", 2: "condition", 3: "event",
        4: "authorization", 5: "tabbar", 6: "Deeplink", 7: "tech",
        8: "error", 9: "open_error", 10: "open_error_screen",
        11: "errorMetric", 12: "offline_tap"
    };

    const selectedEvent = eventMapping[eventType] || "tap";

    if (window.__SFUA_CLICK_EVENTS_RUNNING__) return;
    window.__SFUA_CLICK_EVENTS_RUNNING__ = true;

    function convertToRegex(str) {
        const trimmed = str.trim();
        if (trimmed === '%') return /.+/;
        const escaped = trimmed.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
        return new RegExp(escaped.replace(/%/g, '.*'), 'i');
    }

    const regexKey = convertToRegex(key);
    const regexValue = convertToRegex(value);

    function delay(ms) {
        return new Promise(resolve => setTimeout(resolve, ms));
    }

    function getRandomPause(count) {
        const map = [
            [1, 50, 100, 300],
            [51, 200, 300, 500],
            [201, 500, 500, 700],
            [501, 1000, 700, 1000],
            [1001, 2000, 1000, 2000],
            [2001, Infinity, 2000, 4000]
        ];
        for (const [min, max, minMs, maxMs] of map) {
            if (count >= min && count <= max) {
                return Math.random() * (maxMs - minMs) + minMs;
            }
        }
        return 300;
    }

    function simulateClickWithCheck(element) {
        if (!element || element.classList.contains('span_checked')) return;
        element.click();
        element.classList.add('span_checked');
        element.dispatchEvent(new CustomEvent('sfua:spanToggled', {
            bubbles: true,
            detail: { checked: true }
        }));
    }

    async function clickAndSearch() {
        const iframe = document.querySelector('.iframe-integration__iframe');
        if (!iframe) {
            window.sfuaProgress?.searchComplete(false, 'iframe –Ω–µ –Ω–∞–π–¥–µ–Ω');
            return;
        }

        let iframeDoc;
        try {
            iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
        } catch (e) {
            window.sfuaProgress?.searchComplete(false, '–ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ iframe');
            return;
        }

        if (!iframeDoc) {
            window.sfuaProgress?.searchComplete(false, 'iframe –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω');
            return;
        }

        iframeDoc.querySelectorAll('.this_one_matches').forEach(el => {
            el.style.border = '';
            el.classList.remove('this_one_matches');
        });

        const allEventSpans = [...iframeDoc.querySelectorAll('span.link__inner')]
            .filter(span => {
                const text = span.textContent.trim();
                return text === selectedEvent && !span.classList.contains('span_checked');
            });

        const total = allEventSpans.length;
        console.log(`–ù–∞–π–¥–µ–Ω–æ "${selectedEvent}": ${total}`);

        if (total === 0) {
            window.sfuaProgress?.searchComplete(true, '–°–æ–≤–ø–∞–¥–µ–Ω–∏–π –Ω–µ –Ω–∞–π–¥–µ–Ω–æ');
            return;
        }

        // ‚úÖ –¢–æ–ª—å–∫–æ –∑–¥–µ—Å—å ‚Äî –∫–æ–≥–¥–∞ total –∏–∑–≤–µ—Å—Ç–µ–Ω ‚Äî –æ–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å
        if (typeof window.sfuaProgress !== 'undefined') {
            window.sfuaProgress.setStep(4, "–ö–ª–∏–∫–∞—é –ø–æ —Å–æ–±—ã—Ç–∏—è–º –∏ –æ—Å—É—â–µ—Å—Ç–≤–ª—è—é –ø–æ–∏—Å–∫");
        }

        const updateProgress = window.sfuaProgress?.startProgress
            ? window.sfuaProgress.startProgress("–ö–ª–∏–∫–∞—é –ø–æ —Å–æ–±—ã—Ç–∏—è–º –∏ –æ—Å—É—â–µ—Å—Ç–≤–ª—è—é –ø–æ–∏—Å–∫", total)
            : null;

        let eventCounter = 1;
        let foundAny = false;

        for (let i = 0; i < total; i++) {
            const span = allEventSpans[i];
            simulateClickWithCheck(span);
            await delay(getRandomPause(total));

            const allParams = iframeDoc.querySelectorAll('.event-details__param');
            for (const param of allParams) {
                if (param.classList.contains('check_has_already_been_performed')) continue;

                const keyEl = param.querySelector('.event-details__key');
                const valueEl = param.querySelector('.event-details__value');
                if (!keyEl || !valueEl) {
                    param.classList.add('check_has_already_been_performed');
                    continue;
                }

                const keyText = keyEl.textContent.trim();
                const valueText = valueEl.textContent.trim();

                if (regexKey.test(keyText) && regexValue.test(valueText)) {
                    foundAny = true;
                    const eventParent = param.closest('.profile-session__event');
                    const sessionParent = eventParent?.closest('.profile-session_js_inited');
                    const timeEl = eventParent?.querySelector('.profile-session__event-time');
                    const dateEl = sessionParent?.querySelector('.profile-session__date');

                    const timeText = timeEl?.textContent.trim() || '–≤—Ä–µ–º—è –Ω–µ –Ω–∞–π–¥–µ–Ω–æ';
                    const dateText = dateEl?.textContent.trim() || '–¥–∞—Ç–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ';
                    const shortDateText = dateText.split(' ').slice(0, 2).join(' ');

                    const anchorId = `found_event_${Date.now()}_${eventCounter++}`;
                    if (timeEl) timeEl.id = anchorId;

                    const detailsParent = param.closest('.event-details_js_inited');
                    if (detailsParent) {
                        detailsParent.classList.add('this_one_matches');
                        detailsParent.style.border = '2px solid #008D00';
                    }

                    window.sfuaProgress?.addResult({ id: anchorId, shortDateText, timeText });
                }

                param.classList.add('check_has_already_been_performed');
            }

            // ‚úÖ –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å
            if (updateProgress && typeof window.sfuaProgress?.updateProgress === 'function') {
                window.sfuaProgress.updateProgress(() => {
                    updateProgress(i + 1);
                });
            }
        }

        window.sfuaProgress?.searchComplete(true, foundAny ? undefined : '–°–æ–≤–ø–∞–¥–µ–Ω–∏–π –Ω–µ –Ω–∞–π–¥–µ–Ω–æ');
    }

    try {
        await delay(1000);
        await clickAndSearch();
    } catch (err) {
        console.error("–û—à–∏–±–∫–∞ –≤ clickeventelements:", err);
        window.sfuaProgress?.searchComplete(false, '–û—à–∏–±–∫–∞: ' + err.message);
    } finally {
        delete window.__SFUA_CLICK_EVENTS_RUNNING__;
    }
})();


background/userinfo.js:
--------------------------------------------------
// background/userinfo.js

(function () {
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω –ª–∏ —É–∂–µ —Å–∫—Ä–∏–ø—Ç
    if (window.sfua_userinfo_loaded) {
        console.log('[SFUA] userinfo.js —É–∂–µ –∑–∞–≥—Ä—É–∂–µ–Ω ‚Äî –ø—Ä–æ–ø—É—Å–∫–∞–µ–º');
        return;
    }
    window.sfua_userinfo_loaded = true;

    // –ì–ª–æ–±–∞–ª—å–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —á–∞—Å–æ–≤—ã—Ö –ø–æ—è—Å–æ–≤
    let TIMEZONES = null;

    // –ó–∞–≥—Ä—É–∂–∞–µ–º timezones.json
    async function loadTimezones() {
        try {
            const url = chrome.runtime.getURL('data/timezones.json');
            const response = await fetch(url);
            if (!response.ok) throw new Error('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å timezones.json');
            TIMEZONES = await response.json();
            console.log('[SFUA] –ß–∞—Å–æ–≤—ã–µ –ø–æ—è—Å–∞ –∑–∞–≥—Ä—É–∂–µ–Ω—ã');
        } catch (error) {
            console.error('[SFUA] –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ timezones.json:', error);
            TIMEZONES = {}; // fallback
        }
    }

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
    async function initializeUserInfo() {
        await loadTimezones();

        const iframe = document.querySelector('.iframe-integration__iframe');
        if (!iframe) {
            setTimeout(initializeUserInfo, 500);
            return;
        }

        const iframeDocument = iframe.contentDocument || iframe.contentWindow.document;

        // === –ü–ª–∞–≤–Ω–æ–µ –∏—Å—á–µ–∑–Ω–æ–≤–µ–Ω–∏–µ –∞–≤–∞—Ç–∞—Ä–∞ ===
        const profileImage = iframeDocument.querySelector('div.page-user-profile__profile-image');
        if (profileImage) {
            profileImage.style.transition = 'transform 0.6s cubic-bezier(0.4, 0, 0.2, 1)';
            void profileImage.offsetWidth;
            profileImage.style.transform = 'scale(0)';
            setTimeout(() => {
                profileImage.style.display = 'none';
            }, 600);
        }

        const profileTableElement = iframeDocument.querySelector('table.profile-info-table__table');
        if (!profileTableElement) {
            setTimeout(initializeUserInfo, 500);
            return;
        }

        // –ü–æ–¥–∫–ª—é—á–∞–µ–º —Å—Ç–∏–ª–∏
        const link = document.createElement('link');
        link.rel = 'stylesheet';
        link.href = chrome.runtime.getURL('background/styles/userinfo.css');
        link.onerror = () => {
            console.error('[SFUA] –ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å userinfo.css');
        };
        iframeDocument.head.appendChild(link);

        setTimeout(() => {
            processUserInfo(iframeDocument, profileImage, profileTableElement);
        }, 100);
    }

function processUserInfo(iframeDocument, profileImage, profileTableElement) {
    const headers = iframeDocument.querySelectorAll('th.profile-info-table__row-header');
    const dataCells = iframeDocument.querySelectorAll('td.profile-info-table__row-data-cell');

    console.log('[SFUA] –ù–∞–π–¥–µ–Ω–æ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤:', headers.length);
    console.log('[SFUA] –ù–∞–π–¥–µ–Ω–æ —è—á–µ–µ–∫ –¥–∞–Ω–Ω—ã—Ö:', dataCells.length);

    // === –î–æ–±–∞–≤–ª—è–µ–º –∫–ª–∞—Å—Å—ã main_userinfo_headerX –∏ main_userinfo_dataX ===
    headers.forEach((header, index) => {
        header.classList.add(`main_userinfo_header${index + 1}`);
        header.style.paddingBottom = '5px';
    });

    // === –•—Ä–∞–Ω–∏–º –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ ===
    const data = {};

    dataCells.forEach((cell, index) => {
        const cellIndex = index + 1;
        cell.classList.add(`main_userinfo_data${cellIndex}`);

        const headerCell = headers[index];
        if (!headerCell) return;

        const headerText = headerCell.textContent.trim();

        let cellText = cell.textContent.trim();

        // === –ï—Å–ª–∏ —ç—Ç–æ "–í–µ—Ä—Å–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è" ‚Äî –æ—á–∏—â–∞–µ–º ===
        if (headerText === "–í–µ—Ä—Å–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è" || (headerText.includes("–í–µ—Ä—Å–∏—è") && headerText.includes("–ø—Ä–∏–ª–æ–∂"))) {
            console.log(`[SFUA] –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –≤–µ—Ä—Å–∏—è: "${cellText}"`);

            // –£–¥–∞–ª—è–µ–º –≤—Å—ë –Ω–∞—á–∏–Ω–∞—è —Å –ø–µ—Ä–≤–æ–π –æ—Ç–∫—Ä—ã–≤–∞—é—â–µ–π —Å–∫–æ–±–∫–∏
            const openParenIndex = cellText.indexOf('(');
            let cleanedText = cellText;
            if (openParenIndex !== -1) {
                cleanedText = cellText.substring(0, openParenIndex).trim();
            }

            console.log(`[SFUA] –û—á–∏—â–µ–Ω–æ: "${cleanedText}"`);

            if (cleanedText !== cellText) {
                // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ–º DOM
                cell.textContent = '';
                setTimeout(() => {
                    cell.textContent = cleanedText;
                    console.log(`‚úÖ –Ø—á–µ–π–∫–∞ main_userinfo_data${cellIndex} –æ–±–Ω–æ–≤–ª–µ–Ω–∞`);
                }, 0);

                // üî• –°—Ä–∞–∑—É –æ–±–Ω–æ–≤–ª—è–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –≤ data
                data[cellIndex] = cleanedText;
            } else {
                data[cellIndex] = cellText;
            }
        } else {
            // –û–±—ã—á–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
            data[cellIndex] = cellText;
        }
    });

    // === –¢–µ–ø–µ—Ä—å —Å–æ–±–∏—Ä–∞–µ–º headersData –∏–∑ headers ===
    const headersData = {};
    headers.forEach((header, index) => {
        headersData[index + 1] = header.textContent.trim();
    });

    // === –°–æ–∑–¥–∞—ë–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å –∞–∫—Ç—É–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ ===
    createUserInfoContainer(iframeDocument, profileImage, profileTableElement, headersData, data);
}

function createUserInfoContainer(iframeDocument, profileImage, profileTableElement, headersData, data) {
    const existingContainer = iframeDocument.querySelector('.userinfo_container');
    if (existingContainer) {
        fadeOut(existingContainer, () => {
            existingContainer.remove();
            if (profileImage) {
                profileImage.style.display = '';
            }
        });
        return;
    }

    // === –ö–Ω–æ–ø–∫–∞ —Å –∞–Ω–∏–º–∞—Ü–∏–µ–π —Ç–µ–∫—Å—Ç–∞ ===
    const toggleButton = document.createElement('button');
    toggleButton.className = 'toggle-details-button';
    toggleButton.style.overflow = 'hidden';
    toggleButton.style.position = 'relative';
    toggleButton.style.transform = 'scale(0)';
    toggleButton.style.transformOrigin = 'top center';

    const textContainer = document.createElement('div');
    textContainer.style.position = 'absolute';
    textContainer.style.top = '0';
    textContainer.style.left = '0';
    textContainer.style.width = '100%';
    textContainer.style.height = '100%';
    textContainer.style.display = 'flex';
    textContainer.style.flexDirection = 'column';
    textContainer.style.justifyContent = 'center';
    textContainer.style.alignItems = 'center';
    textContainer.style.gap = '0';
    textContainer.style.overflow = 'hidden';

    const oldText = document.createElement('span');
    oldText.textContent = '–ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–¥—Ä–æ–±–Ω–æ';
    oldText.style.position = 'absolute';
    oldText.style.top = '0';
    oldText.style.left = '0';
    oldText.style.width = '100%';
    oldText.style.textAlign = 'center';
    oldText.style.lineHeight = '30px';
    oldText.style.transform = 'translateY(-100%)';
    oldText.style.transition = 'transform 0.3s ease-out';
    oldText.style.display = 'block';

    const newText = document.createElement('span');
    newText.textContent = '–ü–æ–∫–∞–∑–∞—Ç—å –∫—Ä–∞—Ç–∫–æ';
    newText.style.position = 'absolute';
    newText.style.top = '0';
    newText.style.left = '0';
    newText.style.width = '100%';
    newText.style.textAlign = 'center';
    newText.style.lineHeight = '30px';
    newText.style.transform = 'translateY(0)';
    newText.style.transition = 'transform 0.3s ease-out';
    newText.style.display = 'block';

    textContainer.appendChild(oldText);
    textContainer.appendChild(newText);
    toggleButton.appendChild(textContainer);

    const container = document.createElement('div');
    container.className = 'userinfo_container';
    container.style.display = 'block';
    container.style.transform = 'scale(0)';
    container.style.transformOrigin = 'top';
    container.style.transition = 'transform 0.3s ease-out';

    // ‚úÖ –ü–µ—Ä–µ–¥–∞—ë–º –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
    container.innerHTML = generateInfoHTML(headersData, data);

    profileTableElement.style.transform = 'scale(0)';
    profileTableElement.style.transformOrigin = 'top';
    profileTableElement.style.transition = 'transform 0.3s ease-out';

    const wrapper = document.createElement('div');
    wrapper.style.display = 'flex';
    wrapper.style.flexDirection = 'column';
    wrapper.style.gap = '10px';
    wrapper.appendChild(toggleButton);
    wrapper.appendChild(container);

    if (profileImage) {
        profileImage.parentNode.insertBefore(wrapper, profileImage.nextSibling);
    } else {
        const parent = iframeDocument.querySelector('.page-user-profile__main-info') || iframeDocument.body;
        parent.insertBefore(wrapper, parent.firstChild);
    }

    // === –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è ===
    setTimeout(() => {
        toggleButton.style.transition = 'transform 0.3s ease-out, max-height 0.4s ease';
        toggleButton.style.maxHeight = '40px';
        toggleButton.style.transform = 'scale(1)';
    }, 100);

    // === –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ ===
    chrome.storage.local.get(['sfua_userinfo_showCompact'], async (result) => {
        const showCompact = result.sfua_userinfo_showCompact ?? false;

        if (showCompact) {
            container.style.display = 'block';
            profileTableElement.classList.add('hidden');
            container.style.transform = 'scale(1)';
            profileTableElement.style.transform = 'scale(0)';

            newText.style.transform = 'translateY(100%)';
            oldText.style.transform = 'translateY(0)';
        } else {
            container.style.display = 'none';
            profileTableElement.classList.remove('hidden');
            profileTableElement.style.transform = 'scale(1)';
            container.style.transform = 'scale(0)';

            oldText.style.transform = 'translateY(-100%)';
            newText.style.transform = 'translateY(0)';
        }
    });

    // === –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ ===
    toggleButton.addEventListener('click', () => {
        if (container.style.display === 'none' || container.style.display === '') {
            container.style.display = 'block';
            profileTableElement.classList.add('hidden');
            profileTableElement.style.transform = 'scale(0)';
            setTimeout(() => container.style.transform = 'scale(1)', 10);

            newText.style.transform = 'translateY(100%)';
            oldText.style.transform = 'translateY(0)';

            chrome.storage.local.set({ sfua_userinfo_showCompact: true });
        } else {
            container.style.display = 'none';
            profileTableElement.classList.remove('hidden');
            container.style.transform = 'scale(0)';
            setTimeout(() => profileTableElement.style.transform = 'scale(1)', 10);

            oldText.style.transform = 'translateY(-100%)';
            newText.style.transform = 'translateY(0)';

            chrome.storage.local.set({ sfua_userinfo_showCompact: false });
        }
    });
}

    function generateInfoHTML(headersData, data) {
        let html = '';

        const addInfoRow = (title, value, isWarning = false) => {
            if (value && value !== '–ù–µ –Ω–∞–π–¥–µ–Ω–æ') {
                const valueStyle = isWarning ? 'style="color: red;"' : '';
                html += `
                    <div class="userinfo_wrapper">
                        <div class="userinfo_title">${title}:</div>
                        <div class="userinfo_data" ${valueStyle}>${value}</div>
                    </div>
                `;
            }
        };

        // –í—Å–µ —Å—Ç—Ä–æ–∫–∏ ‚Äî –∫–∞–∫ –≤ –æ—Ä–∏–≥–∏–Ω–∞–ª–µ
        for (const [index, headerText] of Object.entries(headersData)) {
            const num = parseInt(index);
            if (headerText === "–ú–æ–¥–µ–ª—å") {
                const deviceValue = `${data[num] || '–ù–µ –Ω–∞–π–¥–µ–Ω–æ'} (${data[num-1] || '–ù–µ –Ω–∞–π–¥–µ–Ω–æ'})`;
                addInfoRow("–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ", deviceValue);
                break;
            }
        }

        for (const [index, headerText] of Object.entries(headersData)) {
            const num = parseInt(index);
            if (headerText === "–û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞") {
                const osValue = `${data[num] || '–ù–µ –Ω–∞–π–¥–µ–Ω–æ'} ${data[num+1] || ''}`.trim();
                addInfoRow("–û–°", osValue);
                break;
            }
        }

        for (const [index, headerText] of Object.entries(headersData)) {
            const num = parseInt(index);
            if (headerText === "–í–µ—Ä—Å–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è") {
                let version = data[num] || '–ù–µ –Ω–∞–π–¥–µ–Ω–æ';
                // –£–¥–∞–ª—è–µ–º –ø–æ—Å–ª–µ–¥–Ω–µ–µ —Å–ª–æ–≤–æ –≤ —Å–∫–æ–±–∫–∞—Ö
                if (version !== '–ù–µ –Ω–∞–π–¥–µ–Ω–æ') {
                    version = version.replace(/\s*$$[^)]+$$\s*$/, '').trim();
                }
                addInfoRow("–í–µ—Ä—Å–∏—è –ú–ü", version);
                break;
            }
        }

        for (const [index, headerText] of Object.entries(headersData)) {
            const num = parseInt(index);
            if (headerText === "–û–ø–µ—Ä–∞—Ç–æ—Ä") {
                addInfoRow("–û–ø–µ—Ä–∞—Ç–æ—Ä", data[num] || '–ù–µ –Ω–∞–π–¥–µ–Ω–æ');
                break;
            }
        }

        let regionValue = '–ù–µ –Ω–∞–π–¥–µ–Ω–æ';
        for (const [index, headerText] of Object.entries(headersData)) {
            const num = parseInt(index);
            if (headerText === "–†–µ–≥–∏–æ–Ω" || headerText === "–ì–æ—Ä–æ–¥" || /—Ä–µ–≥–∏–æ–Ω|–æ–±–ª–∞—Å—Ç—å|–∫—Ä–∞–π/i.test(headerText)) {
                regionValue = data[num] || '–ù–µ –Ω–∞–π–¥–µ–Ω–æ';
                addInfoRow("–†–µ–≥–∏–æ–Ω", regionValue);
                if (regionValue !== '–ù–µ –Ω–∞–π–¥–µ–Ω–æ') {
                    const timezoneOffset = findTimezone(regionValue);
                    if (timezoneOffset !== null) {
                        const timezoneValue = timezoneOffset > 0 ? `+${timezoneOffset}` : timezoneOffset;
                        addInfoRow("–ß–∞—Å–æ–≤–æ–π –ø–æ—è—Å", `<span class="userinfo_timezone">${timezoneValue}</span> –ú–°–ö`);
                    }
                }
                break;
            }
        }

        for (const [index, headerText] of Object.entries(headersData)) {
            const num = parseInt(index);
            if (headerText === "–ö—Ä—ç—à–∏") {
                const crashValue = data[num] || '–ù–µ –Ω–∞–π–¥–µ–Ω–æ';
                addInfoRow("Crash", crashValue, crashValue !== '0');
                break;
            }
        }

        for (const [index, headerText] of Object.entries(headersData)) {
            const num = parseInt(index);
            if (headerText === "Root-—Å—Ç–∞—Ç—É—Å") {
                const rootValue = data[num] || '–ù–µ –Ω–∞–π–¥–µ–Ω–æ';
                addInfoRow("Root", rootValue, rootValue !== 'Not Rooted');
                break;
            }
        }

        for (const [index, headerText] of Object.entries(headersData)) {
            const num = parseInt(index);
            if (headerText === "–°–µ—Å—Å–∏–∏") {
                const sessionsValue = `${data[num] || '–ù–µ –Ω–∞–π–¥–µ–Ω–æ'} (${formatDate(data[num-1] || '–ù–µ –Ω–∞–π–¥–µ–Ω–æ')})`;
                addInfoRow("–°–µ—Å—Å–∏–∏ (–ø–æ—Å–ª–µ–¥–Ω—è—è)", sessionsValue);
                break;
            }
        }

        for (const [index, headerText] of Object.entries(headersData)) {
            const num = parseInt(index);
            if (headerText === "appmetrica_device_id") {
                addInfoRow("Appmetrica ID", data[num] || '–ù–µ –Ω–∞–π–¥–µ–Ω–æ');
                break;
            }
        }

        return html || '<div style="color: rgb(150, 150, 150);">–î–∞–Ω–Ω—ã–µ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</div>';
    }

    function findTimezone(regionName) {
        if (!regionName || regionName === '–ù–µ –Ω–∞–π–¥–µ–Ω–æ' || !TIMEZONES) return null;

        const normalized = regionName
            .toLowerCase()
            .replace(/[^–∞-—è—ë\s-]/gi, '')
            .replace(/(–æ–±–ª–∞—Å—Ç—å|–∫—Ä–∞–π|—Ä–µ—Å–ø—É–±–ª–∏–∫–∞|–∞–≤—Ç–æ–Ω–æ–º–Ω—ã–π –æ–∫—Ä—É–≥|–∞–æ|–≥–æ—Ä–æ–¥|–≥\.|—Ä–∞–π–æ–Ω)\b/gi, '')
            .replace(/\s+/g, ' ')
            .trim();

        for (const [region, offset] of Object.entries(TIMEZONES)) {
            const normalizedRegion = region.toLowerCase();
            if (
                normalized === normalizedRegion ||
                normalized.includes(normalizedRegion) ||
                normalizedRegion.includes(normalized) ||
                regionName.toLowerCase().includes(normalizedRegion)
            ) {
                return offset;
            }
        }

        console.log('–ß–∞—Å–æ–≤–æ–π –ø–æ—è—Å –Ω–µ –Ω–∞–π–¥–µ–Ω –¥–ª—è:', regionName);
        return null;
    }

    function formatDate(dateString) {
        if (dateString === '–ù–µ –Ω–∞–π–¥–µ–Ω–æ') return dateString;
        const [year, month, day] = dateString.split('-');
        return `${day}.${month}.${year}`;
    }

    function fadeOut(element, callback) {
        element.style.opacity = '1';
        element.style.transition = 'opacity 0.7s ease, transform 0.7s ease';
        element.style.opacity = '0';
        element.style.transform = 'scale(0.9)';
        element.addEventListener('transitionend', () => callback(), { once: true });
    }

    // –ó–∞–ø—É—Å–∫
    initializeUserInfo();
})();


background/updateId.js:
--------------------------------------------------
(function initIdUpdater() {
    console.log('[SFUA] –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ ID');

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∏–Ω–∂–µ–∫—Ç–∞ —Å—Ç–∏–ª–µ–π
    const injectStyles = (iframeDoc) => {
        return new Promise((resolve) => {
            const styleLink = iframeDoc.createElement('link');
            styleLink.rel = 'stylesheet';
            styleLink.href = chrome.runtime.getURL('background/styles/updateId.css');
            styleLink.onload = resolve;
            iframeDoc.head.appendChild(styleLink);
        });
    };

    // –°–æ–∑–¥–∞—ë–º —ç–ª–µ–º–µ–Ω—Ç –¥–ª—è –≤–≤–æ–¥–∞ ID
    const createIdInput = () => {
        const container = document.createElement('div');
        container.className = 'sfua-id-container';

        const input = document.createElement('input');
        input.type = 'text';
        input.className = 'sfua-id-input';
        input.placeholder = 'ID Appmetrica';

        const button = document.createElement('button');
        button.className = 'sfua-id-submit';
        button.disabled = true;
        button.innerHTML = `
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/>
            </svg>
        `;

        container.appendChild(input);
        container.appendChild(button);
        return { container, input, button };
    };

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è URL —Å –Ω–æ–≤—ã–º ID
    const updateUrlWithNewId = (newId) => {
        const currentUrl = new URL(window.location.href);
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –æ–±–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞
        currentUrl.searchParams.set('profileId', newId);
        currentUrl.searchParams.set('deviceId', newId);
        
        // –ü–µ—Ä–µ—Ö–æ–¥–∏–º –ø–æ –Ω–æ–≤–æ–º—É URL
        window.location.href = currentUrl.toString();
    };

    // –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
    const init = async () => {
        const iframe = document.querySelector('iframe.iframe-integration__iframe');
        if (!iframe) {
            console.log('[SFUA] Iframe –Ω–µ –Ω–∞–π–¥–µ–Ω, –ø–æ–≤—Ç–æ—Ä —á–µ—Ä–µ–∑ 1—Å');
            setTimeout(init, 1000);
            return;
        }

        try {
            const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
            
            // –ò–Ω–∂–µ–∫—Ç–∏–º —Å—Ç–∏–ª–∏
            await injectStyles(iframeDoc);
            
            const profileIdElement = iframeDoc.querySelector('.page-user-profile__profile-id');
            
            if (!profileIdElement) {
                console.log('[SFUA] –≠–ª–µ–º–µ–Ω—Ç ID –Ω–µ –Ω–∞–π–¥–µ–Ω, –ø–æ–≤—Ç–æ—Ä —á–µ—Ä–µ–∑ 1—Å');
                setTimeout(init, 1000);
                return;
            }

            if (iframeDoc.querySelector('.sfua-id-container')) {
                return;
            }

            console.log('[SFUA] –ù–∞–π–¥–µ–Ω —ç–ª–µ–º–µ–Ω—Ç ID, –¥–æ–±–∞–≤–ª—è–µ–º –ø–æ–ª–µ –≤–≤–æ–¥–∞');
            
            const { container, input, button } = createIdInput();
            profileIdElement.parentNode.insertBefore(container, profileIdElement.nextSibling);

            // –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â–∏–π ID –∏–∑ URL
            const getCurrentId = () => {
                const urlParams = new URLSearchParams(window.location.search);
                return urlParams.get('profileId') || '';
            };

            const currentId = getCurrentId();

            const checkId = () => {
                const newId = input.value.trim();

                if (!newId) {
                    button.disabled = true;
                    input.classList.remove('error', 'warning');
                    return;
                }

                if (newId === currentId) {
                    input.classList.add('warning');
                    input.classList.remove('error');
                    button.disabled = true;
                } else if (!/^\d{15,}$/.test(newId)) {
                    input.classList.add('error');
                    input.classList.remove('warning');
                    button.disabled = true;
                } else {
                    input.classList.remove('error', 'warning');
                    button.disabled = false;
                }
            };

            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è input
            input.addEventListener('input', checkId);

            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –ø–æ –∫–Ω–æ–ø–∫–µ
            button.addEventListener('click', () => {
                if (!button.disabled) {
                    updateUrlWithNewId(input.value.trim());
                }
            });

            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–∞–∂–∞—Ç–∏—è Enter –≤ input
            input.addEventListener('keypress', (e) => {
                if (e.key === 'Enter' && !button.disabled) {
                    updateUrlWithNewId(input.value.trim());
                }
            });

        } catch (error) {
            console.error('[SFUA] –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏:', error);
            setTimeout(init, 1000);
        }
    };

    // –ó–∞–ø—É—Å–∫–∞–µ–º —Å –Ω–µ–±–æ–ª—å—à–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π
    setTimeout(init, 100);
})();


background/styles/usertimezones.css:
--------------------------------------------------
.user_time {
    color: #999;
    font-size: 0.9em;
    margin-left: 3px;
    position: relative;
}

.user_time:hover::after {
    content: "–í—Ä–µ–º—è —Å–µ—Å—Å–∏–∏ –≤ —á–∞—Å–æ–≤–æ–º –ø–æ—è—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è";
    position: absolute;
    background: rgba(0, 0, 0, 0.8);
    color: #fff;
    padding: 5px 10px;
    border-radius: 4px;
    font-size: 12px;
    white-space: nowrap;
    z-index: 1000;
    bottom: 100%;
    left: 0;
}


background/styles/updateId.css:
--------------------------------------------------
.sfua-id-container {
    display: flex;
    gap: 8px;
    margin-top: 8px;
    width: 100%;
    margin-bottom: 10px;
    align-items: center;
}

.sfua-id-input {
    padding: 8px 12px;
    border: 1px solid #ddd;
    border-radius: 4px;
    font-size: 14px;
    width: 100%;
    transition: all 0.2s;
    outline: none;
}

.sfua-id-input.error {
    border: 1px solid #ff6b6b;
    transition: all 0.2s;
}

.sfua-id-input.warning {
    border: 1px solid #ffd700;
    transition: all 0.2s;
}

.sfua-id-submit {
    background: #1983ff;
    color: white;
    border: none;
    border-radius: 4px;
    padding: 8px;
    cursor: pointer;
    transition: all 0.2s;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 32px;
    height: 32px;
}

.sfua-id-submit:hover:not(:disabled) {
    background: #1673e0;
}

.sfua-id-submit:disabled {
    background: #cccccc;
    cursor: not-allowed;
    opacity: 0.7;
}

.sfua-id-submit svg {
    width: 16px;
    height: 16px;
}


background/styles/userinfo.css:
--------------------------------------------------
/* background/styles/userinfo.css */

.userinfo_container {
    margin-top: 0;
    width: 100%;
    min-height: 100px;
    color: rgb(51, 51, 51);
    overflow: hidden;
    font-size: 11px;
    transform-origin: top;
    transition: transform 0.3s ease-out;
}

.userinfo_wrapper {
    display: flex;
    align-items: center;
    margin-bottom: 4px;
}

.userinfo_title {
    width: 120px;
    color: rgb(150, 150, 150);
    font-weight: bold;
}

.userinfo_data {
    color: inherit;
    flex: 1;
}

.popup {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background-color: rgba(0, 0, 0, 0.7);
    color: white;
    padding: 10px 20px;
    border-radius: 5px;
    opacity: 0;
    transition: opacity 0.3s ease;
    z-index: 10000;
}

.page-user-profile__profile-image {
    transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1) !important;
}

.toggle-details-button {
    display: block;
    width: 100%;
    height: 30px;
    color: white;
    background-color: #4299e1;
    margin-bottom: 5px;
    font-size: 14px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    overflow: hidden;
    position: relative;
    text-align: center;
    line-height: 30px;
    transform-origin: top center;
    transition: transform 0.3s ease-out, max-height 0.4s ease;
}

.toggle-details-button:hover {
    background-color: #266396;
}

.hidden {
    display: none !important;
}

.profile-info-table_js_inited {
    margin-top: 7px !important;
}

.profile-info-table__row-header {
    padding-bottom: 5px !important;
}

/* –ê–Ω–∏–º–∞—Ü–∏—è –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã */
table.profile-info-table__table {
    transform-origin: top;
    transition: transform 0.3s ease-out;
}


data/timezones.json:
--------------------------------------------------
{
      "–ú–æ—Å–∫–≤–∞": 0,
      "–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥": 0,
      "–ö–∞–ª–∏–Ω–∏–Ω–≥—Ä–∞–¥": -1,
      "–°–∞–º–∞—Ä–∞": 1,
      "–°–∞–º–∞—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": 1,
      "–ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥": 2,
      "–û–º—Å–∫": 3,
      "–ö—Ä–∞—Å–Ω–æ—è—Ä—Å–∫": 4,
      "–ò—Ä–∫—É—Ç—Å–∫": 5,
      "–Ø–∫—É—Ç—Å–∫": 6,
      "–í–ª–∞–¥–∏–≤–æ—Å—Ç–æ–∫": 7,
      "–ú–∞–≥–∞–¥–∞–Ω": 8,
      "–ö–∞–º—á–∞—Ç–∫–∞": 9,
      "–í–æ—Ä–æ–Ω–µ–∂": 0,
      "–í–æ—Ä–æ–Ω–µ–∂—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": 0,
      "–†–æ—Å—Ç–æ–≤-–Ω–∞-–î–æ–Ω—É": 0,
      "–†–æ—Å—Ç–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": 0,
      "–ù–∏–∂–Ω–∏–π –ù–æ–≤–≥–æ—Ä–æ–¥": 0,
      "–ù–∏–∂–µ–≥–æ—Ä–æ–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": 0,
      "–ö–∞–∑–∞–Ω—å": 0,
      "–†–µ—Å–ø—É–±–ª–∏–∫–∞ –¢–∞—Ç–∞—Ä—Å—Ç–∞–Ω": 0,
      "–£—Ñ–∞": 2,
      "–†–µ—Å–ø—É–±–ª–∏–∫–∞ –ë–∞—à–∫–æ—Ä—Ç–æ—Å—Ç–∞–Ω": 2,
      "–ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫": 4,
      "–ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": 4,
      "–ö—Ä–∞—Å–Ω–æ–¥–∞—Ä": 0,
      "–ö—Ä–∞—Å–Ω–æ–¥–∞—Ä—Å–∫–∏–π –∫—Ä–∞–π": 0,
      "–ü–µ—Ä–º—å": 2,
      "–ü–µ—Ä–º—Å–∫–∏–π –∫—Ä–∞–π": 2,
      "–í–æ–ª–≥–æ–≥—Ä–∞–¥": 0,
      "–í–æ–ª–≥–æ–≥—Ä–∞–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": 0,
      "–°–∞—Ä–∞—Ç–æ–≤": 1,
      "–°–∞—Ä–∞—Ç–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": 1,
      "–¢—é–º–µ–Ω—å": 2,
      "–¢—é–º–µ–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": 2,
      "–ò–∂–µ–≤—Å–∫": 1,
      "–£–¥–º—É—Ä—Ç—Å–∫–∞—è –†–µ—Å–ø—É–±–ª–∏–∫–∞": 1,
      "–ë–∞—Ä–Ω–∞—É–ª": 4,
      "–ê–ª—Ç–∞–π—Å–∫–∏–π –∫—Ä–∞–π": 4,
      "–£–ª–∞–Ω-–£–¥—ç": 5,
      "–†–µ—Å–ø—É–±–ª–∏–∫–∞ –ë—É—Ä—è—Ç–∏—è": 5,
      "–ß–∏—Ç–∞": 6,
      "–ó–∞–±–∞–π–∫–∞–ª—å—Å–∫–∏–π –∫—Ä–∞–π": 6,
      "–ü–µ—Ç—Ä–æ–ø–∞–≤–ª–æ–≤—Å–∫-–ö–∞–º—á–∞—Ç—Å–∫–∏–π": 9,
      "–ö–∞–º—á–∞—Ç—Å–∫–∏–π –∫—Ä–∞–π": 9,
      "–•–∞–±–∞—Ä–æ–≤—Å–∫": 7,
      "–•–∞–±–∞—Ä–æ–≤—Å–∫–∏–π –∫—Ä–∞–π": 7,
      "–í–ª–∞–¥–∏–º–∏—Ä": 0,
      "–í–ª–∞–¥–∏–º–∏—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": 0,
      "–°–æ—á–∏": 0,
      "–¢—É–ª–∞": 0,
      "–¢—É–ª—å—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": 0,
      "–ö–∏—Ä–æ–≤": 0,
      "–ö–∏—Ä–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": 0,
      "–ß–µ–ª—è–±–∏–Ω—Å–∫": 2,
      "–ß–µ–ª—è–±–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": 2,
      "–û—Ä–µ–Ω–±—É—Ä–≥": 2,
      "–û—Ä–µ–Ω–±—É—Ä–≥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": 2,
      "–ü–µ–Ω–∑–∞": 0,
      "–ü–µ–Ω–∑–µ–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": 0,
      "–†—è–∑–∞–Ω—å": 0,
      "–†—è–∑–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": 0,
      "–ê—Å—Ç—Ä–∞—Ö–∞–Ω—å": 1,
      "–ê—Å—Ç—Ä–∞—Ö–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": 1,
      "–ù–∞–±–µ—Ä–µ–∂–Ω—ã–µ –ß–µ–ª–Ω—ã": 0,
      "–¢–æ–º—Å–∫": 4,
      "–¢–æ–º—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": 4,
      "–ö–µ–º–µ—Ä–æ–≤–æ": 4,
      "–ö–µ–º–µ—Ä–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": 4,
      "–°–º–æ–ª–µ–Ω—Å–∫": 0,
      "–°–º–æ–ª–µ–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": 0,
      "–ö—É—Ä—Å–∫": 0,
      "–ö—É—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": 0,
      "–û—Ä–µ–ª": 0,
      "–û—Ä–ª–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": 0,
      "–ë–µ–ª–≥–æ—Ä–æ–¥": 0,
      "–ë–µ–ª–≥–æ—Ä–æ–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": 0,
      "–ê—Ä—Ö–∞–Ω–≥–µ–ª—å—Å–∫": 0,
      "–ê—Ä—Ö–∞–Ω–≥–µ–ª—å—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": 0,
      "–ú—É—Ä–º–∞–Ω—Å–∫": 0,
      "–ú—É—Ä–º–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": 0,
      "–°–µ–≤–µ—Ä–æ–¥–≤–∏–Ω—Å–∫": 0,
      "–ô–æ—à–∫–∞—Ä-–û–ª–∞": 0,
      "–†–µ—Å–ø—É–±–ª–∏–∫–∞ –ú–∞—Ä–∏–π –≠–ª": 0,
      "–°—ã–∫—Ç—ã–≤–∫–∞—Ä": 0,
      "–†–µ—Å–ø—É–±–ª–∏–∫–∞ –ö–æ–º–∏": 0,
      "–ù–∞–ª—å—á–∏–∫": 0,
      "–ö–∞–±–∞—Ä–¥–∏–Ω–æ-–ë–∞–ª–∫–∞—Ä–∏—è": 0,
      "–°—Ç–∞–≤—Ä–æ–ø–æ–ª—å": 0,
      "–°—Ç–∞–≤—Ä–æ–ø–æ–ª—å—Å–∫–∏–π –∫—Ä–∞–π": 0,
      "–ì—Ä–æ–∑–Ω—ã–π": 0,
      "–ß–µ—á–µ–Ω—Å–∫–∞—è –†–µ—Å–ø—É–±–ª–∏–∫–∞": 0,
      "–ú–∞—Ö–∞—á–∫–∞–ª–∞": 0,
      "–î–∞–≥–µ—Å—Ç–∞–Ω": 0,
      "–í–ª–∞–¥–∏–∫–∞–≤–∫–∞–∑": 0,
      "–°–µ–≤–µ—Ä–Ω–∞—è –û—Å–µ—Ç–∏—è": 0,
      "–Ø—Ä–æ—Å–ª–∞–≤–ª—å": 0,
      "–Ø—Ä–æ—Å–ª–∞–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": 0,
      "–ö–æ—Å—Ç—Ä–æ–º–∞": 0,
      "–ö–æ—Å—Ç—Ä–æ–º—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": 0,
      "–ò–≤–∞–Ω–æ–≤–æ": 0,
      "–ò–≤–∞–Ω–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": 0,
      "–ë—Ä—è–Ω—Å–∫": 0,
      "–ë—Ä—è–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": 0,
      "–ö—É—Ä–≥–∞–Ω": 2,
      "–ö—É—Ä–≥–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": 2,
      "–°–µ–≤–∞—Å—Ç–æ–ø–æ–ª—å": 0,
      "–†–µ—Å–ø—É–±–ª–∏–∫–∞ –ö—Ä—ã–º": 0,
      "–°–∏–º—Ñ–µ—Ä–æ–ø–æ–ª—å": 0,
      "–°–∞—Ö–∞–ª–∏–Ω": 7,
      "–°–∞—Ö–∞–ª–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å" : 7,
      "–ö–∞–ª—É–≥–∞" : 0,
      "–ö–∞–ª—É–∂—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å" : 0
    }


============================================================
–°–¢–†–£–ö–¢–£–†–ê –ü–†–û–ï–ö–¢–ê:
============================================================
‚îú‚îÄ‚îÄ üìÑ 128.png
‚îú‚îÄ‚îÄ üìÅ actions/
‚îÇ   ‚îú‚îÄ‚îÄ üìÑ clickeventelements.js
‚îÇ   ‚îú‚îÄ‚îÄ üìÑ clickpluselements.js
‚îÇ   ‚îú‚îÄ‚îÄ üìÑ found_error.js
‚îÇ   ‚îú‚îÄ‚îÄ üìÑ loadallevents.js
‚îÇ   ‚îú‚îÄ‚îÄ üìÑ loadallevents_error.js
‚îÇ   ‚îú‚îÄ‚îÄ üìÑ showmoresession.js
‚îÇ   ‚îú‚îÄ‚îÄ üìÑ showmoresession_error.js
‚îÇ   ‚îî‚îÄ‚îÄ üìÑ updateprogress.js
‚îú‚îÄ‚îÄ üìÑ allcode.py
‚îú‚îÄ‚îÄ üìÅ background/
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ styles/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÑ updateId.css
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÑ userinfo.css
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ üìÑ usertimezones.css
‚îÇ   ‚îú‚îÄ‚îÄ üìÑ updateId.js
‚îÇ   ‚îî‚îÄ‚îÄ üìÑ userinfo.js
‚îú‚îÄ‚îÄ üìÑ background.js
‚îú‚îÄ‚îÄ üìÅ content/
‚îÇ   ‚îú‚îÄ‚îÄ üìÑ scrolltotop.js
‚îÇ   ‚îú‚îÄ‚îÄ üìÑ showcurrent.js
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ styles/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ üìÑ showcurrent.css
‚îÇ   ‚îú‚îÄ‚îÄ üìÑ sync_manual_clicks.js
‚îÇ   ‚îî‚îÄ‚îÄ üìÑ usertimezone.js
‚îú‚îÄ‚îÄ üìÅ data/
‚îÇ   ‚îî‚îÄ‚îÄ üìÑ timezones.json
‚îú‚îÄ‚îÄ üìÑ how_to_use.css
‚îú‚îÄ‚îÄ üìÑ how_to_use.html
‚îú‚îÄ‚îÄ üìÑ how_to_use.js
‚îú‚îÄ‚îÄ üìÅ icons/
‚îÇ   ‚îú‚îÄ‚îÄ üìÑ icon128.png
‚îÇ   ‚îú‚îÄ‚îÄ üìÑ icon16.png
‚îÇ   ‚îî‚îÄ‚îÄ üìÑ icon48.png
‚îú‚îÄ‚îÄ üìÑ manifest.json
‚îú‚îÄ‚îÄ üìÑ modal_error.js
‚îú‚îÄ‚îÄ üìÑ path.py
‚îú‚îÄ‚îÄ üìÑ popup.html
‚îú‚îÄ‚îÄ üìÑ popup.js
‚îú‚îÄ‚îÄ üìÑ progress.css
‚îú‚îÄ‚îÄ üìÑ progress.js
‚îú‚îÄ‚îÄ üìÑ progress_error.css
‚îú‚îÄ‚îÄ üìÑ progress_error.js
‚îú‚îÄ‚îÄ üìÑ project_content.txt
‚îî‚îÄ‚îÄ üìÑ styles.css
